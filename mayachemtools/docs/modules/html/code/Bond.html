<html>
<head>
<title>MayaChemTools:Code:Bond.pm</title>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<link rel="stylesheet" type="text/css" href="../../../css/MayaChemToolsCode.css">
</head>
<body leftmargin="20" rightmargin="20" topmargin="10" bottommargin="10">
<br/>
<center>
<a href="http://www.mayachemtools.org" title="MayaChemTools Home"><img src="../../../images/MayaChemToolsLogo.gif" border="0" alt="MayaChemTools"></a>
</center>
<br/>
<pre>
<a name="package-Bond-"></a>   1 <span class="k">package </span><span class="i">Bond</span><span class="sc">;</span>
   2 <span class="c">#</span>
   3 <span class="c"># $RCSfile: Bond.pm,v $</span>
   4 <span class="c"># $Date: 2017/01/12 18:57:49 $</span>
   5 <span class="c"># $Revision: 1.42 $</span>
   6 <span class="c">#</span>
   7 <span class="c"># Author: Manish Sud &lt;msud@san.rr.com&gt;</span>
   8 <span class="c">#</span>
   9 <span class="c"># Copyright (C) 2017 Manish Sud. All rights reserved.</span>
  10 <span class="c">#</span>
  11 <span class="c"># This file is part of MayaChemTools.</span>
  12 <span class="c">#</span>
  13 <span class="c"># MayaChemTools is free software; you can redistribute it and/or modify it under</span>
  14 <span class="c"># the terms of the GNU Lesser General Public License as published by the Free</span>
  15 <span class="c"># Software Foundation; either version 3 of the License, or (at your option) any</span>
  16 <span class="c"># later version.</span>
  17 <span class="c">#</span>
  18 <span class="c"># MayaChemTools is distributed in the hope that it will be useful, but without</span>
  19 <span class="c"># any warranty; without even the implied warranty of merchantability of fitness</span>
  20 <span class="c"># for a particular purpose.  See the GNU Lesser General Public License for more</span>
  21 <span class="c"># details.</span>
  22 <span class="c">#</span>
  23 <span class="c"># You should have received a copy of the GNU Lesser General Public License</span>
  24 <span class="c"># along with MayaChemTools; if not, see &lt;http://www.gnu.org/licenses/&gt; or</span>
  25 <span class="c"># write to the Free Software Foundation Inc., 59 Temple Place, Suite 330,</span>
  26 <span class="c"># Boston, MA, 02111-1307, USA.</span>
  27 <span class="c">#</span>
  28 
  29 <span class="k">use</span> <span class="w">strict</span><span class="sc">;</span>
  30 <span class="k">use</span> <span class="w">Carp</span><span class="sc">;</span>
  31 <span class="k">use</span> <span class="w">Exporter</span><span class="sc">;</span>
  32 <span class="k">use</span> <span class="w">Storable</span> <span class="s">(</span><span class="s">)</span><span class="sc">;</span>
  33 <span class="k">use</span> <span class="w">Scalar::Util</span> <span class="s">(</span><span class="s">)</span><span class="sc">;</span>
  34 <span class="k">use</span> <span class="w">ObjectProperty</span><span class="sc">;</span>
  35 
  36 <span class="k">use</span> <span class="w">vars</span> <span class="q">qw(@ISA @EXPORT @EXPORT_OK %EXPORT_TAGS)</span><span class="sc">;</span>
  37 
  38 <span class="i">@ISA</span> = <span class="q">qw(ObjectProperty Exporter)</span><span class="sc">;</span>
  39 <span class="i">@EXPORT</span> = <span class="q">qw()</span><span class="sc">;</span>
  40 <span class="i">@EXPORT_OK</span> = <span class="q">qw()</span><span class="sc">;</span>
  41 
  42 <span class="i">%EXPORT_TAGS</span> = <span class="s">(</span><span class="w">all</span>  <span class="cm">=&gt;</span> <span class="s">[</span><span class="i">@EXPORT</span><span class="cm">,</span> <span class="i">@EXPORT_OK</span><span class="s">]</span><span class="s">)</span><span class="sc">;</span>
  43 
  44 <span class="c"># Setup class variables...</span>
  45 <span class="k">my</span><span class="s">(</span><span class="i">$ClassName</span><span class="cm">,</span> <span class="i">$ObjectID</span><span class="s">)</span><span class="sc">;</span>
  46 <span class="i">_InitializeClass</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
  47 
  48 <span class="c"># Overload Perl functions...</span>
  49 <span class="k">use</span> <span class="w">overload</span> <span class="q">&#39;&quot;&quot;&#39;</span> <span class="cm">=&gt;</span> <span class="q">&#39;StringifyBond&#39;</span><span class="sc">;</span>
  50 
  51 <span class="c"># Class constructor...</span>
<a name="new-"></a>  52 <span class="k">sub </span><span class="m">new</span> <span class="s">{</span>
  53   <span class="k">my</span><span class="s">(</span><span class="i">$Class</span><span class="cm">,</span> <span class="i">%NamesAndValues</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
  54 
  55   <span class="c"># Initialize object...</span>
  56   <span class="k">my</span> <span class="i">$This</span> = <span class="s">{</span><span class="s">}</span><span class="sc">;</span>
  57   <span class="k">bless</span> <span class="i">$This</span><span class="cm">,</span> <span class="k">ref</span><span class="s">(</span><span class="i">$Class</span><span class="s">)</span> || <span class="i">$Class</span><span class="sc">;</span>
  58   <span class="i">$This</span><span class="i">-&gt;_InitializeBond</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
  59 
  60   <span class="i">$This</span><span class="i">-&gt;_InitializeBondProperties</span><span class="s">(</span><span class="i">%NamesAndValues</span><span class="s">)</span><span class="sc">;</span>
  61 
  62   <span class="k">return</span> <span class="i">$This</span><span class="sc">;</span>
  63 <span class="s">}</span>
  64 
  65 <span class="c"># Initialize object data...</span>
  66 <span class="c">#</span>
<a name="_InitializeBond-"></a>  67 <span class="k">sub </span><span class="m">_InitializeBond</span> <span class="s">{</span>
  68   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
  69   <span class="k">my</span><span class="s">(</span><span class="i">$ObjectID</span><span class="s">)</span> = <span class="i">_GetNewObjectID</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
  70 
  71   <span class="c"># All other property names and values along with all Set/Get&lt;PropertyName&gt; methods</span>
  72   <span class="c"># are implemented on-demand using ObjectProperty class.</span>
  73   <span class="i">$This</span>-&gt;{<span class="w">ID</span>} = <span class="i">$ObjectID</span><span class="sc">;</span>
  74 
  75   <span class="c"># Bond from and to atoms indicate begining and ending bond atoms...</span>
  76   <span class="i">$This</span>-&gt;{<span class="w">BondFromAtom</span>} = <span class="k">undef</span><span class="sc">;</span>
  77   <span class="i">$This</span>-&gt;{<span class="w">BondToAtom</span>} = <span class="k">undef</span><span class="sc">;</span>
  78 
  79   <span class="i">$This</span>-&gt;{<span class="w">BondOrder</span>} = <span class="q">&#39;&#39;</span><span class="sc">;</span>
  80   <span class="i">$This</span>-&gt;{<span class="w">BondType</span>} = <span class="q">&#39;&#39;</span><span class="sc">;</span>
  81   <span class="i">$This</span>-&gt;{<span class="w">BondStereochemistry</span>} = <span class="q">&#39;&#39;</span><span class="sc">;</span>
  82 <span class="s">}</span>
  83 
  84 <span class="c"># Initialize class ...</span>
<a name="_InitializeClass-"></a>  85 <span class="k">sub </span><span class="m">_InitializeClass</span> <span class="s">{</span>
  86   <span class="c">#Class name...</span>
  87   <span class="i">$ClassName</span> = <span class="w">__PACKAGE__</span><span class="sc">;</span>
  88 
  89   <span class="c"># ID to keep track of objects...</span>
  90   <span class="i">$ObjectID</span> = <span class="n">0</span><span class="sc">;</span>
  91 <span class="s">}</span>
  92 
  93 <span class="c"># Initialize bond properties...</span>
<a name="_InitializeBondProperties-"></a>  94 <span class="k">sub </span><span class="m">_InitializeBondProperties</span> <span class="s">{</span>
  95   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">%NamesAndValues</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
  96 
  97   <span class="k">my</span><span class="s">(</span><span class="i">$Name</span><span class="cm">,</span> <span class="i">$Value</span><span class="cm">,</span> <span class="i">$MethodName</span><span class="s">)</span><span class="sc">;</span>
  98   <span class="k">while</span> <span class="s">(</span><span class="s">(</span><span class="i">$Name</span><span class="cm">,</span> <span class="i">$Value</span><span class="s">)</span> = <span class="k">each</span>  <span class="i">%NamesAndValues</span><span class="s">)</span> <span class="s">{</span>
  99     <span class="i">$MethodName</span> = <span class="q">&quot;Set${Name}&quot;</span><span class="sc">;</span>
 100     <span class="i">$This</span><span class="i">-&gt;$MethodName</span><span class="s">(</span><span class="i">$Value</span><span class="s">)</span><span class="sc">;</span>
 101   <span class="s">}</span>
 102 
 103   <span class="k">if</span> <span class="s">(</span>!<span class="k">exists</span> <span class="i">$NamesAndValues</span>{<span class="q">&#39;Atoms&#39;</span>}<span class="s">)</span> <span class="s">{</span>
 104     <span class="w">carp</span> <span class="q">&quot;Warning: ${ClassName}-&gt;new: Bond object instantiated without specifying atoms list...&quot;</span><span class="sc">;</span>
 105   <span class="s">}</span>
 106   <span class="k">if</span> <span class="s">(</span>!<span class="k">exists</span> <span class="i">$NamesAndValues</span>{<span class="q">&#39;BondOrder&#39;</span>}<span class="s">)</span> <span class="s">{</span>
 107     <span class="w">carp</span> <span class="q">&quot;Warning: ${ClassName}-&gt;new: Bond object instantiated without setting bond order...&quot;</span><span class="sc">;</span>
 108   <span class="s">}</span>
 109   <span class="k">return</span> <span class="i">$This</span><span class="sc">;</span>
 110 <span class="s">}</span>
 111 
 112 <span class="c"># Setup an explicit SetID method to block setting of ID by AUTOLOAD function...</span>
<a name="SetID-"></a> 113 <span class="k">sub </span><span class="m">SetID</span> <span class="s">{</span>
 114   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$Value</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 115 
 116   <span class="w">carp</span> <span class="q">&quot;Warning: ${ClassName}-&gt;SetID: Object ID can&#39;t be changed: it&#39;s used for internal tracking...&quot;</span><span class="sc">;</span>
 117 
 118   <span class="k">return</span> <span class="i">$This</span><span class="sc">;</span>
 119 <span class="s">}</span>
 120 
 121 <span class="c"># Setup an explicit SetMolecule method to block setting of ID by AUTOLOAD function...</span>
<a name="SetMolecule-"></a> 122 <span class="k">sub </span><span class="m">SetMolecule</span> <span class="s">{</span>
 123   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$Value</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 124 
 125   <span class="w">carp</span> <span class="q">&quot;Warning: ${ClassName}-&gt;SetMolecule: Molecule property can&#39;t be changed: it&#39;s used for internal tracking...&quot;</span><span class="sc">;</span>
 126 
 127   <span class="k">return</span> <span class="i">$This</span><span class="sc">;</span>
 128 <span class="s">}</span>
 129 
 130 <span class="c"># Assign bond to  molecule...</span>
<a name="_SetMolecule-"></a> 131 <span class="k">sub </span><span class="m">_SetMolecule</span> <span class="s">{</span>
 132   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$Molecule</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 133 
 134   <span class="i">$This</span>-&gt;{<span class="w">Molecule</span>} = <span class="i">$Molecule</span><span class="sc">;</span>
 135 
 136   <span class="c"># Weaken the reference to disable increment of reference count; otherwise,</span>
 137   <span class="c"># it it becomes a circular reference and destruction of Molecule object doesn&#39;t</span>
 138   <span class="c"># get initiated which in turn disables destruction of bond object.</span>
 139   <span class="c">#</span>
 140   <span class="i">Scalar::Util::weaken</span><span class="s">(</span><span class="i">$This</span>-&gt;{<span class="w">Molecule</span>}<span class="s">)</span><span class="sc">;</span>
 141 
 142   <span class="k">return</span> <span class="i">$This</span><span class="sc">;</span>
 143 <span class="s">}</span>
 144 
 145 <span class="c"># Set bond atoms...</span>
<a name="SetAtoms-"></a> 146 <span class="k">sub </span><span class="m">SetAtoms</span> <span class="s">{</span>
 147   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">@Values</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 148 
 149   <span class="k">if</span> <span class="s">(</span>!<span class="i">@Values</span><span class="s">)</span> <span class="s">{</span>
 150     <span class="w">croak</span> <span class="q">&quot;Error: ${ClassName}-&gt;SetAtoms: No atoms specified...&quot;</span><span class="sc">;</span>
 151   <span class="s">}</span>
 152 
 153   <span class="k">my</span><span class="s">(</span><span class="i">$FirstValue</span><span class="cm">,</span> <span class="i">$TypeOfFirstValue</span><span class="cm">,</span> <span class="i">$Atom1</span><span class="cm">,</span> <span class="i">$Atom2</span><span class="cm">,</span> <span class="i">$AtomID1</span><span class="cm">,</span> <span class="i">$AtomID2</span><span class="s">)</span><span class="sc">;</span>
 154   <span class="i">$FirstValue</span> = <span class="i">$Values</span>[<span class="n">0</span>]<span class="sc">;</span>
 155   <span class="i">$TypeOfFirstValue</span> = <span class="k">ref</span> <span class="i">$FirstValue</span><span class="sc">;</span>
 156 
 157   <span class="k">if</span> <span class="s">(</span><span class="i">$TypeOfFirstValue</span> =~ <span class="q">/^ARRAY/</span><span class="s">)</span> <span class="s">{</span>
 158     <span class="c"># Initialize using array refernce...</span>
 159     <span class="k">if</span> <span class="s">(</span><span class="i">@</span>{<span class="i">$FirstValue</span>} != <span class="n">2</span><span class="s">)</span> <span class="s">{</span>
 160       <span class="w">croak</span> <span class="q">&quot;Warning: ${ClassName}-&gt;SetAtoms: Number of atoms specified in bond object is not equal to 2...&quot;</span><span class="sc">;</span>
 161     <span class="s">}</span>
 162     <span class="s">(</span><span class="i">$Atom1</span><span class="cm">,</span> <span class="i">$Atom2</span><span class="s">)</span> = <span class="i">@</span>{<span class="i">$FirstValue</span>}<span class="sc">;</span>
 163   <span class="s">}</span>
 164   <span class="k">else</span> <span class="s">{</span>
 165     <span class="c"># It&#39;s a list of values...</span>
 166     <span class="k">if</span> <span class="s">(</span><span class="i">@Values</span> != <span class="n">2</span><span class="s">)</span> <span class="s">{</span>
 167       <span class="w">croak</span> <span class="q">&quot;Warning: ${ClassName}-&gt;SetAtoms: Number of atoms specified in bond object is not equal to 2...&quot;</span><span class="sc">;</span>
 168     <span class="s">}</span>
 169     <span class="s">(</span><span class="i">$Atom1</span><span class="cm">,</span> <span class="i">$Atom2</span><span class="s">)</span> = <span class="i">@Values</span><span class="sc">;</span>
 170   <span class="s">}</span>
 171 
 172   <span class="i">$AtomID1</span> = <span class="i">$Atom1</span><span class="i">-&gt;GetID</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span> <span class="i">$AtomID2</span> = <span class="i">$Atom2</span><span class="i">-&gt;GetID</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 173   <span class="k">if</span> <span class="s">(</span><span class="i">$AtomID1</span> == <span class="i">$AtomID2</span><span class="s">)</span> <span class="s">{</span>
 174       <span class="w">croak</span> <span class="q">&quot;Warning: ${ClassName}-&gt;SetAtoms: Can&#39;t specify same atoms to create a bond...&quot;</span><span class="sc">;</span>
 175   <span class="s">}</span>
 176 
 177   <span class="i">$This</span>-&gt;{<span class="w">BondFromAtom</span>} = <span class="i">$Atom1</span><span class="sc">;</span>
 178   <span class="i">$This</span>-&gt;{<span class="w">BondToAtom</span>} = <span class="i">$Atom2</span><span class="sc">;</span>
 179 
 180   <span class="k">return</span> <span class="i">$This</span><span class="sc">;</span>
 181 <span class="s">}</span>
 182 
 183 <span class="c"># Get bond atoms as array. In scalar context, return number of atoms involved in</span>
 184 <span class="c"># bond...</span>
 185 <span class="c">#</span>
<a name="GetAtoms-"></a> 186 <span class="k">sub </span><span class="m">GetAtoms</span> <span class="s">{</span>
 187   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 188 
 189   <span class="k">return</span> <span class="k">wantarray</span> ? <span class="s">(</span><span class="i">$This</span>-&gt;{<span class="w">BondFromAtom</span>}<span class="cm">,</span> <span class="i">$This</span>-&gt;{<span class="w">BondToAtom</span>}<span class="s">)</span> <span class="co">:</span> <span class="n">2</span><span class="sc">;</span>
 190 <span class="s">}</span>
 191 
 192 <span class="c"># Get atom bonded to specified atom...</span>
<a name="GetBondedAtom-"></a> 193 <span class="k">sub </span><span class="m">GetBondedAtom</span> <span class="s">{</span>
 194   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$Atom</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 195   <span class="k">my</span><span class="s">(</span><span class="i">$Atom1</span><span class="cm">,</span> <span class="i">$Atom2</span><span class="cm">,</span> <span class="i">$AtomID1</span><span class="cm">,</span> <span class="i">$AtomID2</span><span class="cm">,</span> <span class="i">$AtomID</span><span class="s">)</span><span class="sc">;</span>
 196 
 197   <span class="s">(</span><span class="i">$Atom1</span><span class="cm">,</span> <span class="i">$Atom2</span><span class="s">)</span> = <span class="i">$This</span><span class="i">-&gt;GetAtoms</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 198   <span class="i">$AtomID1</span> = <span class="i">$Atom1</span><span class="i">-&gt;GetID</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span> <span class="i">$AtomID2</span> = <span class="i">$Atom2</span><span class="i">-&gt;GetID</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span> <span class="i">$AtomID</span> = <span class="i">$Atom</span><span class="i">-&gt;GetID</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 199 
 200   <span class="k">return</span> <span class="s">(</span><span class="i">$AtomID1</span> == <span class="i">$AtomID</span><span class="s">)</span> ? <span class="i">$Atom2</span> <span class="co">:</span> <span class="s">(</span><span class="s">(</span><span class="i">$AtomID2</span> == <span class="i">$AtomID</span><span class="s">)</span> ? <span class="i">$Atom1</span> <span class="co">:</span> <span class="k">undef</span><span class="s">)</span> <span class="sc">;</span>
 201 <span class="s">}</span>
 202 
 203 <span class="c"># Get common atom between two bonds...</span>
<a name="GetCommonAtom-"></a> 204 <span class="k">sub </span><span class="m">GetCommonAtom</span> <span class="s">{</span>
 205   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$Other</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 206   <span class="k">my</span><span class="s">(</span><span class="i">$Atom1</span><span class="cm">,</span> <span class="i">$Atom2</span><span class="cm">,</span> <span class="i">$AtomID1</span><span class="cm">,</span> <span class="i">$AtomID2</span><span class="cm">,</span> <span class="i">$OtherAtom1</span><span class="cm">,</span> <span class="i">$OtherAtom2</span><span class="cm">,</span> <span class="i">$OtherAtomID1</span><span class="cm">,</span> <span class="i">$OtherAtomID2</span><span class="s">)</span><span class="sc">;</span>
 207 
 208   <span class="s">(</span><span class="i">$Atom1</span><span class="cm">,</span> <span class="i">$Atom2</span><span class="s">)</span> = <span class="i">$This</span><span class="i">-&gt;GetAtoms</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 209   <span class="i">$AtomID1</span> = <span class="i">$Atom1</span><span class="i">-&gt;GetID</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span> <span class="i">$AtomID2</span> = <span class="i">$Atom2</span><span class="i">-&gt;GetID</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 210 
 211   <span class="s">(</span><span class="i">$OtherAtom1</span><span class="cm">,</span> <span class="i">$OtherAtom2</span><span class="s">)</span> = <span class="i">$Other</span><span class="i">-&gt;GetAtoms</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 212   <span class="i">$OtherAtomID1</span> = <span class="i">$OtherAtom1</span><span class="i">-&gt;GetID</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span> <span class="i">$OtherAtomID2</span> = <span class="i">$OtherAtom2</span><span class="i">-&gt;GetID</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 213 
 214   <span class="k">return</span> <span class="s">(</span><span class="i">$AtomID1</span> == <span class="i">$OtherAtomID1</span> || <span class="i">$AtomID1</span> == <span class="i">$OtherAtomID2</span><span class="s">)</span> ? <span class="i">$Atom1</span> <span class="co">:</span> <span class="s">(</span><span class="s">(</span><span class="i">$AtomID2</span> == <span class="i">$OtherAtomID1</span> || <span class="i">$AtomID2</span> == <span class="i">$OtherAtomID2</span><span class="s">)</span> ? <span class="i">$Atom2</span> <span class="co">:</span> <span class="k">undef</span><span class="s">)</span> <span class="sc">;</span>
 215 <span class="s">}</span>
 216 
 217 <span class="c"># Get bond from atom indicating begining atom of a bond...</span>
<a name="GetBondFromAtom-"></a> 218 <span class="k">sub </span><span class="m">GetBondFromAtom</span> <span class="s">{</span>
 219   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 220 
 221   <span class="k">return</span> <span class="i">$This</span>-&gt;{<span class="w">BondFromAtom</span>}<span class="sc">;</span>
 222 <span class="s">}</span>
 223 
 224 <span class="c"># Get begin bond atom...</span>
<a name="GetBondBeginAtom-"></a> 225 <span class="k">sub </span><span class="m">GetBondBeginAtom</span> <span class="s">{</span>
 226   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 227 
 228   <span class="k">return</span> <span class="i">$This</span><span class="i">-&gt;GetBondFromAtom</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 229 <span class="s">}</span>
 230 
 231 <span class="c"># Get bond to atom indicating ending atom of a bond...</span>
<a name="GetBondToAtom-"></a> 232 <span class="k">sub </span><span class="m">GetBondToAtom</span> <span class="s">{</span>
 233   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 234 
 235   <span class="k">return</span> <span class="i">$This</span>-&gt;{<span class="w">BondToAtom</span>}<span class="sc">;</span>
 236 <span class="s">}</span>
 237 
 238 <span class="c"># Get begin bond atom...</span>
<a name="GetBondEndAtom-"></a> 239 <span class="k">sub </span><span class="m">GetBondEndAtom</span> <span class="s">{</span>
 240   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 241 
 242   <span class="k">return</span> <span class="i">$This</span><span class="i">-&gt;GetBondToAtom</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 243 <span class="s">}</span>
 244 
 245 <span class="c"># Switch bond from and to atoms...</span>
<a name="SwitchBondFromAndToAtoms-"></a> 246 <span class="k">sub </span><span class="m">SwitchBondFromAndToAtoms</span> <span class="s">{</span>
 247   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 248   <span class="k">my</span><span class="s">(</span><span class="i">$FromAtom</span><span class="cm">,</span> <span class="i">$ToAtom</span><span class="s">)</span><span class="sc">;</span>
 249 
 250   <span class="s">(</span><span class="i">$FromAtom</span><span class="cm">,</span> <span class="i">$ToAtom</span><span class="s">)</span> = <span class="i">$This</span><span class="i">-&gt;GetAtoms</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 251 
 252   <span class="i">$This</span>-&gt;{<span class="w">BondFromAtom</span>} = <span class="i">$ToAtom</span><span class="sc">;</span>
 253   <span class="i">$This</span>-&gt;{<span class="w">BondToAtom</span>} = <span class="i">$FromAtom</span><span class="sc">;</span>
 254 
 255   <span class="k">return</span> <span class="i">$This</span><span class="sc">;</span>
 256 <span class="s">}</span>
 257 
 258 <span class="c"># Set bond order...</span>
 259 <span class="c">#</span>
 260 <span class="c"># Possible BondOrder are: 0 = None, 1 = Single, 1.5 = Aromatic, 2 = Double, 3 = Triple, 4 = Quadruple,</span>
 261 <span class="c"># 5 = Quintuple, 6 = Sextuple, 7 = Septuple</span>
 262 <span class="c">#</span>
 263 <span class="c"># Possible BondType for different BondOrders are:</span>
 264 <span class="c">#</span>
 265 <span class="c"># 0 : None, Ionic, Unspecified</span>
 266 <span class="c"># 1 : Single, Dative, Coordinate, SingleOrDouble, SingleOrAromatic, Tautomeric</span>
 267 <span class="c"># 1.5 : Aromatic, Resonance, SingleOrAromatic, DoubleOrAromatic</span>
 268 <span class="c"># 2 : Double, Tautomeric, SingleOrDouble, DoubleOrAromatic</span>
 269 <span class="c"># 3 : Triple</span>
 270 <span class="c"># 4 : Quadruple</span>
 271 <span class="c"># 5 : Quintuple</span>
 272 <span class="c"># 6 : Sextuple</span>
 273 <span class="c"># 7 : Septuple</span>
 274 <span class="c">#</span>
 275 <span class="c"># Note: BondType Any is valid for all BondOrders.</span>
 276 <span class="c">#</span>
 277 <span class="c"># Possible BondStereochemistry values for different BondOrders are:</span>
 278 <span class="c">#</span>
 279 <span class="c"># 0 : None, Unspecified</span>
 280 <span class="c"># 1 : Wedge, Up, Hash, Down, Wavy, WedgeOrHash, UpOrDown, Upward, Downward, None, Unspecified</span>
 281 <span class="c"># 2 : Cis, Trans, Z, E, DoubleCross, CisOrTrans, None, Unspecified</span>
 282 <span class="c">#</span>
 283 <span class="c"># Notes:</span>
 284 <span class="c">#   . BondType property is automatically assigned using default BondType values for</span>
 285 <span class="c">#     specified BondOrder.</span>
 286 <span class="c">#   . BondType values can also be explicit set.</span>
 287 <span class="c">#   . To make bonds aromatic in a ring, explicitly set &quot;Aromatic&quot; property for bond/atoms and make sure</span>
 288 <span class="c">#     appropriate BondOrder values are assigned.</span>
 289 <span class="c">#   . Dative or coordinate bond types are treated as single bond types with explicit formal charge</span>
 290 <span class="c">#     of + and - on first and second bond atoms.</span>
 291 <span class="c">#</span>
<a name="SetBondOrder-"></a> 292 <span class="k">sub </span><span class="m">SetBondOrder</span> <span class="s">{</span>
 293   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$BondOrder</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 294 
 295   <span class="k">if</span> <span class="s">(</span><span class="i">$BondOrder</span> !~ <span class="q">/^(0|1|1.5|2|3|4|5|6|7)$/</span><span class="s">)</span> <span class="s">{</span>
 296     <span class="w">croak</span> <span class="q">&quot;Error: ${ClassName}-&gt;SetBondOrder: BondOrder value $BondOrder is not valid. Supported values: 0, 1, 1.5, 2, 3, 4, 5, 6, 7&quot;</span><span class="sc">;</span>
 297   <span class="s">}</span>
 298 
 299   <span class="c"># Set bond order and type...</span>
 300   <span class="k">my</span><span class="s">(</span><span class="i">$BondType</span><span class="s">)</span><span class="sc">;</span>
 301 
 302   <span class="j">BONDORDER:</span> <span class="s">{</span>
 303       <span class="k">if</span> <span class="s">(</span><span class="i">$BondOrder</span> == <span class="n">1</span><span class="s">)</span> <span class="s">{</span><span class="i">$BondType</span> = <span class="q">&#39;Single&#39;</span><span class="sc">;</span> <span class="k">last</span> <span class="j">BONDORDER</span><span class="sc">;</span> <span class="s">}</span>
 304       <span class="k">if</span> <span class="s">(</span><span class="i">$BondOrder</span> == <span class="n">1.5</span><span class="s">)</span> <span class="s">{</span><span class="i">$BondType</span> = <span class="q">&#39;Aromatic&#39;</span><span class="sc">;</span> <span class="k">last</span> <span class="j">BONDORDER</span><span class="sc">;</span> <span class="s">}</span>
 305       <span class="k">if</span> <span class="s">(</span><span class="i">$BondOrder</span> == <span class="n">2</span><span class="s">)</span> <span class="s">{</span><span class="i">$BondType</span> = <span class="q">&#39;Double&#39;</span><span class="sc">;</span> <span class="k">last</span> <span class="j">BONDORDER</span><span class="sc">;</span> <span class="s">}</span>
 306       <span class="k">if</span> <span class="s">(</span><span class="i">$BondOrder</span> == <span class="n">3</span><span class="s">)</span> <span class="s">{</span><span class="i">$BondType</span> = <span class="q">&#39;Triple&#39;</span><span class="sc">;</span> <span class="k">last</span> <span class="j">BONDORDER</span><span class="sc">;</span> <span class="s">}</span>
 307       <span class="k">if</span> <span class="s">(</span><span class="i">$BondOrder</span> == <span class="n">4</span><span class="s">)</span> <span class="s">{</span><span class="i">$BondType</span> = <span class="q">&#39;Quadruple&#39;</span><span class="sc">;</span> <span class="k">last</span> <span class="j">BONDORDER</span><span class="sc">;</span> <span class="s">}</span>
 308       <span class="k">if</span> <span class="s">(</span><span class="i">$BondOrder</span> == <span class="n">5</span><span class="s">)</span> <span class="s">{</span><span class="i">$BondType</span> = <span class="q">&#39;Quintuple&#39;</span><span class="sc">;</span> <span class="k">last</span> <span class="j">BONDORDER</span><span class="sc">;</span> <span class="s">}</span>
 309       <span class="k">if</span> <span class="s">(</span><span class="i">$BondOrder</span> == <span class="n">6</span><span class="s">)</span> <span class="s">{</span><span class="i">$BondType</span> = <span class="q">&#39;Sextuple&#39;</span><span class="sc">;</span> <span class="k">last</span> <span class="j">BONDORDER</span><span class="sc">;</span> <span class="s">}</span>
 310       <span class="k">if</span> <span class="s">(</span><span class="i">$BondOrder</span> == <span class="n">7</span><span class="s">)</span> <span class="s">{</span><span class="i">$BondType</span> = <span class="q">&#39;Septuple&#39;</span><span class="sc">;</span> <span class="k">last</span> <span class="j">BONDORDER</span><span class="sc">;</span> <span class="s">}</span>
 311       <span class="i">$BondType</span> = <span class="q">&#39;&#39;</span><span class="sc">;</span>
 312       <span class="i">$BondOrder</span> = <span class="n">0</span><span class="sc">;</span>
 313   <span class="s">}</span>
 314   <span class="i">$This</span>-&gt;{<span class="w">BondType</span>} = <span class="i">$BondType</span><span class="sc">;</span>
 315   <span class="i">$This</span>-&gt;{<span class="w">BondOrder</span>} = <span class="i">$BondOrder</span><span class="sc">;</span>
 316 
 317   <span class="k">return</span> <span class="i">$This</span><span class="sc">;</span>
 318 
 319 <span class="s">}</span>
 320 
 321 <span class="c"># Set bond type for a specific bond...</span>
 322 <span class="c">#</span>
<a name="SetBondType-"></a> 323 <span class="k">sub </span><span class="m">SetBondType</span> <span class="s">{</span>
 324   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$BondType</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 325 
 326   <span class="k">if</span> <span class="s">(</span><span class="i">$BondType</span> !~ <span class="q">/^(None|Ionic|Unspecified|Single|Dative|Coordinate|SingleOrDouble|SingleOrAromatic|Aromatic|Tautomeric|Resonance|DoubleOrAromatic|Double|Triple|Quadruple|Any)$/i</span><span class="s">)</span> <span class="s">{</span>
 327     <span class="w">croak</span> <span class="q">&quot;Error: ${ClassName}-&gt;SetBondType: BondType value $BondType is not valid. Supported values: None, Ionic, Unspecified, Single, Dative, Coordinate, SingleOrDouble, SingleOrAromatic, Aromatic, Tautomeric, Resonance, DoubleOrAromatic, Double, Triple, Quadruple, Any...&quot;</span><span class="sc">;</span>
 328   <span class="s">}</span>
 329 
 330   <span class="c"># Make sure its a valid BondType value for BondOrder...</span>
 331   <span class="k">my</span><span class="s">(</span><span class="i">$BondOrder</span><span class="cm">,</span> <span class="i">$ValidBondType</span><span class="s">)</span><span class="sc">;</span>
 332 
 333   <span class="i">$ValidBondType</span> = <span class="n">0</span><span class="sc">;</span>
 334   <span class="i">$BondOrder</span> = <span class="i">$This</span>-&gt;{<span class="w">BondOrder</span>}<span class="sc">;</span>
 335 
 336   <span class="j">BONDORDER:</span> <span class="s">{</span>
 337       <span class="k">if</span> <span class="s">(</span><span class="i">$BondOrder</span> == <span class="n">0</span> &amp;&amp; <span class="i">$BondType</span> =~ <span class="q">/^(None|Ionic|Unspecified|Any)$/i</span><span class="s">)</span> <span class="s">{</span><span class="i">$ValidBondType</span> = <span class="n">1</span><span class="sc">;</span> <span class="k">last</span> <span class="j">BONDORDER</span><span class="sc">;</span> <span class="s">}</span>
 338       <span class="k">if</span> <span class="s">(</span><span class="i">$BondOrder</span> == <span class="n">1</span> &amp;&amp; <span class="i">$BondType</span> =~ <span class="q">/^(Single|Dative|Coordinate|SingleOrDouble|SingleOrAromatic|Tautomeric|Any)$/i</span><span class="s">)</span> <span class="s">{</span><span class="i">$ValidBondType</span> = <span class="n">1</span><span class="sc">;</span> <span class="k">last</span> <span class="j">BONDORDER</span><span class="sc">;</span> <span class="s">}</span>
 339       <span class="k">if</span> <span class="s">(</span><span class="i">$BondOrder</span> == <span class="n">1.5</span> &amp;&amp; <span class="i">$BondType</span> =~ <span class="q">/^(Aromatic|Resonance|SingleOrAromatic|DoubleOrAromatic|Any)$/i</span><span class="s">)</span> <span class="s">{</span><span class="i">$ValidBondType</span> = <span class="n">1</span><span class="sc">;</span> <span class="k">last</span> <span class="j">BONDORDER</span><span class="sc">;</span> <span class="s">}</span>
 340       <span class="k">if</span> <span class="s">(</span><span class="i">$BondOrder</span> == <span class="n">2</span> &amp;&amp; <span class="i">$BondType</span> =~ <span class="q">/^(Double|SingleOrDouble|DoubleOrAromatic|Tautomeric|Any)$/i</span> <span class="s">)</span> <span class="s">{</span><span class="i">$ValidBondType</span> = <span class="n">1</span><span class="sc">;</span> <span class="k">last</span> <span class="j">BONDORDER</span><span class="sc">;</span> <span class="s">}</span>
 341       <span class="k">if</span> <span class="s">(</span><span class="i">$BondOrder</span> == <span class="n">3</span> &amp;&amp; <span class="i">$BondType</span> =~ <span class="q">/^(Triple|Any)$/i</span><span class="s">)</span> <span class="s">{</span><span class="i">$ValidBondType</span> = <span class="n">1</span><span class="sc">;</span> <span class="k">last</span> <span class="j">BONDORDER</span><span class="sc">;</span> <span class="s">}</span>
 342       <span class="k">if</span> <span class="s">(</span><span class="i">$BondOrder</span> == <span class="n">4</span> &amp;&amp; <span class="i">$BondType</span> =~ <span class="q">/^(Quadruple|Any)$/i</span><span class="s">)</span> <span class="s">{</span><span class="i">$ValidBondType</span> = <span class="n">1</span><span class="sc">;</span> <span class="k">last</span> <span class="j">BONDORDER</span><span class="sc">;</span> <span class="s">}</span>
 343       <span class="k">if</span> <span class="s">(</span><span class="i">$BondOrder</span> == <span class="n">5</span> &amp;&amp; <span class="i">$BondType</span> =~ <span class="q">/^(Quintuple|Any)$/i</span><span class="s">)</span> <span class="s">{</span><span class="i">$ValidBondType</span> = <span class="n">1</span><span class="sc">;</span> <span class="k">last</span> <span class="j">BONDORDER</span><span class="sc">;</span> <span class="s">}</span>
 344       <span class="k">if</span> <span class="s">(</span><span class="i">$BondOrder</span> == <span class="n">6</span> &amp;&amp; <span class="i">$BondType</span> =~ <span class="q">/^(Sextuple|Any)$/i</span><span class="s">)</span> <span class="s">{</span><span class="i">$ValidBondType</span> = <span class="n">1</span><span class="sc">;</span> <span class="k">last</span> <span class="j">BONDORDER</span><span class="sc">;</span> <span class="s">}</span>
 345       <span class="k">if</span> <span class="s">(</span><span class="i">$BondOrder</span> == <span class="n">7</span> &amp;&amp; <span class="i">$BondType</span> =~ <span class="q">/^(Septuple|Any)$/i</span><span class="s">)</span> <span class="s">{</span><span class="i">$ValidBondType</span> = <span class="n">1</span><span class="sc">;</span> <span class="k">last</span> <span class="j">BONDORDER</span><span class="sc">;</span> <span class="s">}</span>
 346       <span class="i">$ValidBondType</span> = <span class="n">0</span><span class="sc">;</span>
 347   <span class="s">}</span>
 348 
 349   <span class="k">if</span> <span class="s">(</span>!<span class="i">$ValidBondType</span><span class="s">)</span> <span class="s">{</span>
 350     <span class="w">carp</span> <span class="q">&quot;Warning: ${ClassName}-&gt;SetBondType: Assigning invalid BondType value, $BondType, for BondOrder $BondOrder...&quot;</span><span class="sc">;</span>
 351   <span class="s">}</span>
 352 
 353   <span class="i">$This</span>-&gt;{<span class="w">BondType</span>} = <span class="i">$BondType</span><span class="sc">;</span>
 354 
 355   <span class="c"># Set explicit formal charge for atoms involved in Dative or coordinate bonds...</span>
 356   <span class="k">if</span> <span class="s">(</span><span class="i">$BondType</span> =~ <span class="q">/^(Dative|Coordinate)$/i</span><span class="s">)</span> <span class="s">{</span>
 357     <span class="k">my</span><span class="s">(</span><span class="i">$Atom1</span><span class="cm">,</span> <span class="i">$Atom2</span><span class="s">)</span> = <span class="i">$This</span><span class="i">-&gt;GetAtoms</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 358     <span class="i">$Atom1</span><span class="i">-&gt;SetFormalCharge</span><span class="s">(</span><span class="q">&#39;1&#39;</span><span class="s">)</span><span class="sc">;</span>
 359     <span class="i">$Atom2</span><span class="i">-&gt;SetFormalCharge</span><span class="s">(</span><span class="q">&#39;-1&#39;</span><span class="s">)</span><span class="sc">;</span>
 360   <span class="s">}</span>
 361 
 362   <span class="k">return</span> <span class="i">$This</span><span class="sc">;</span>
 363 <span class="s">}</span>
 364 
 365 <span class="c"># Set bond stereochemistry...</span>
 366 <span class="c">#</span>
 367 <span class="c"># Single bond stereochemistry:</span>
 368 <span class="c">#</span>
 369 <span class="c"># None, Unspecified: Not a stereo bond or unspecified</span>
 370 <span class="c">#</span>
 371 <span class="c"># Wedge, Up : Wedge end pointing up</span>
 372 <span class="c"># Hash, Down: Wedge end pointing down</span>
 373 <span class="c"># Wavy, WedgeOrHash, UpOrDown: Wedge end up or down</span>
 374 <span class="c">#</span>
 375 <span class="c"># Note: Wedge starts at begin atom of bond making wedge pointed end always at this</span>
 376 <span class="c">#       atom.</span>
 377 <span class="c">#</span>
 378 <span class="c"># Upward: Single bond around cis/trans double bonds pointing upward</span>
 379 <span class="c"># Downward: Single bond around cis/trans double bonds pointing upward</span>
 380 <span class="c">#</span>
 381 <span class="c"># Note: Upward/downward bonds start at atoms involved in cis/trans double bond.</span>
 382 <span class="c">#</span>
 383 <span class="c"># Double bond stereochemistry:</span>
 384 <span class="c">#</span>
 385 <span class="c"># None, Unspecified: Not a stereo bond or unspecified</span>
 386 <span class="c">#</span>
 387 <span class="c"># Z, cis: Similar groups on same side of double bond</span>
 388 <span class="c"># E, trans: Similar groups on different side of double bond</span>
 389 <span class="c">#</span>
 390 <span class="c"># CisOrTrans, DoubleCross: cis or trans</span>
 391 <span class="c">#</span>
<a name="SetBondStereochemistry-"></a> 392 <span class="k">sub </span><span class="m">SetBondStereochemistry</span> <span class="s">{</span>
 393   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$BondStereochemistry</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 394 
 395   <span class="k">if</span> <span class="s">(</span><span class="i">$BondStereochemistry</span> !~ <span class="q">/^(None|Unspecified|Wedge|Hash|Up|Down|Wavy|WedgeOrHash|UpOrDown|Upward|Downward|Cis|Trans|Z|E|DoubleCross|CisOrTrans)$/i</span><span class="s">)</span> <span class="s">{</span>
 396     <span class="w">croak</span> <span class="q">&quot;Error: ${ClassName}-&gt;SetBondStereochemistry: BondStereochemistry value $BondStereochemistry is not valid. Supported values: None, Unspecified, Wedge, Hash, Up, Down, Wavy, WedgeOrHash, UpOrDown, Upward, Downward, Cis, Trans, Z, E, DoubleCross, CisOrTrans...&quot;</span><span class="sc">;</span>
 397   <span class="s">}</span>
 398 
 399   <span class="c"># Make sure its a valid BondStereochemistry value for BondOrder...</span>
 400   <span class="k">my</span><span class="s">(</span><span class="i">$BondOrder</span><span class="cm">,</span> <span class="i">$ValidBondType</span><span class="s">)</span><span class="sc">;</span>
 401 
 402   <span class="i">$ValidBondType</span> = <span class="n">0</span><span class="sc">;</span>
 403   <span class="i">$BondOrder</span> = <span class="i">$This</span>-&gt;{<span class="w">BondOrder</span>}<span class="sc">;</span>
 404 
 405   <span class="j">BONDORDER:</span> <span class="s">{</span>
 406       <span class="k">if</span> <span class="s">(</span><span class="i">$BondOrder</span> == <span class="n">0</span> &amp;&amp; <span class="i">$BondStereochemistry</span> =~ <span class="q">/^(None|Unspecified)$/i</span><span class="s">)</span> <span class="s">{</span><span class="i">$ValidBondType</span> = <span class="n">1</span><span class="sc">;</span> <span class="k">last</span> <span class="j">BONDORDER</span><span class="sc">;</span> <span class="s">}</span>
 407       <span class="k">if</span> <span class="s">(</span><span class="i">$BondOrder</span> == <span class="n">1</span> &amp;&amp; <span class="i">$BondStereochemistry</span> =~ <span class="q">/^(Wedge|Hash|Up|Down|Wavy|WedgeOrHash|UpOrDown|Upward|Downward|None|Unspecified)$/i</span><span class="s">)</span> <span class="s">{</span><span class="i">$ValidBondType</span> = <span class="n">1</span><span class="sc">;</span> <span class="k">last</span> <span class="j">BONDORDER</span><span class="sc">;</span> <span class="s">}</span>
 408       <span class="k">if</span> <span class="s">(</span><span class="i">$BondOrder</span> == <span class="n">2</span> &amp;&amp; <span class="i">$BondStereochemistry</span> =~ <span class="q">/^(Cis|Trans|Z|E|DoubleCross|CisOrTrans|None|Unspecified)$/i</span> <span class="s">)</span> <span class="s">{</span><span class="i">$ValidBondType</span> = <span class="n">1</span><span class="sc">;</span> <span class="k">last</span> <span class="j">BONDORDER</span><span class="sc">;</span> <span class="s">}</span>
 409       <span class="i">$ValidBondType</span> = <span class="n">0</span><span class="sc">;</span>
 410   <span class="s">}</span>
 411 
 412   <span class="k">if</span> <span class="s">(</span>!<span class="i">$ValidBondType</span><span class="s">)</span> <span class="s">{</span>
 413     <span class="w">carp</span> <span class="q">&quot;Warning: ${ClassName}-&gt;SetBondStereochemistry: Assigning invalid BondStereochemistry value, $BondStereochemistry, for BondOrder $BondOrder...&quot;</span><span class="sc">;</span>
 414   <span class="s">}</span>
 415 
 416   <span class="i">$This</span>-&gt;{<span class="w">BondStereochemistry</span>} = <span class="i">$BondStereochemistry</span><span class="sc">;</span>
 417 
 418   <span class="k">return</span> <span class="i">$This</span><span class="sc">;</span>
 419 <span class="s">}</span>
 420 
 421 <span class="c"># Is it a single bond?</span>
<a name="IsSingle-"></a> 422 <span class="k">sub </span><span class="m">IsSingle</span> <span class="s">{</span>
 423   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 424 
 425   <span class="k">return</span> <span class="s">(</span><span class="i">$This</span>-&gt;{<span class="w">BondOrder</span>} == <span class="n">1</span><span class="s">)</span> ? <span class="n">1</span> <span class="co">:</span> <span class="n">0</span><span class="sc">;</span>
 426 <span class="s">}</span>
 427 
 428 <span class="c"># Is it a double bond?</span>
<a name="IsDouble-"></a> 429 <span class="k">sub </span><span class="m">IsDouble</span> <span class="s">{</span>
 430   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 431 
 432   <span class="k">return</span> <span class="s">(</span><span class="i">$This</span>-&gt;{<span class="w">BondOrder</span>} == <span class="n">2</span><span class="s">)</span> ? <span class="n">1</span> <span class="co">:</span> <span class="n">0</span><span class="sc">;</span>
 433 <span class="s">}</span>
 434 
 435 <span class="c"># Is it a triple bond?</span>
<a name="IsTriple-"></a> 436 <span class="k">sub </span><span class="m">IsTriple</span> <span class="s">{</span>
 437   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 438 
 439   <span class="k">return</span> <span class="s">(</span><span class="i">$This</span>-&gt;{<span class="w">BondOrder</span>} == <span class="n">3</span><span class="s">)</span> ? <span class="n">1</span> <span class="co">:</span> <span class="n">0</span><span class="sc">;</span>
 440 <span class="s">}</span>
 441 
 442 <span class="c"># Is it a quadruple bond?</span>
<a name="IsQuadruple-"></a> 443 <span class="k">sub </span><span class="m">IsQuadruple</span> <span class="s">{</span>
 444   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 445 
 446   <span class="k">return</span> <span class="s">(</span><span class="i">$This</span>-&gt;{<span class="w">BondOrder</span>} == <span class="n">4</span><span class="s">)</span> ? <span class="n">1</span> <span class="co">:</span> <span class="n">0</span><span class="sc">;</span>
 447 <span class="s">}</span>
 448 
 449 <span class="c"># Is aromatic property set for the bond?</span>
<a name="IsAromatic-"></a> 450 <span class="k">sub </span><span class="m">IsAromatic</span> <span class="s">{</span>
 451   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 452   <span class="k">my</span><span class="s">(</span><span class="i">$Aromatic</span><span class="s">)</span><span class="sc">;</span>
 453 
 454   <span class="i">$Aromatic</span> = <span class="i">$This</span><span class="i">-&gt;GetAromatic</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 455 
 456   <span class="k">return</span> <span class="s">(</span><span class="s">(</span><span class="k">defined</span><span class="s">(</span><span class="i">$Aromatic</span><span class="s">)</span> &amp;&amp; <span class="i">$Aromatic</span><span class="s">)</span> || <span class="i">$This</span>-&gt;{<span class="w">BondOrder</span>} == <span class="n">1.5</span><span class="s">)</span> ? <span class="n">1</span> <span class="co">:</span> <span class="n">0</span><span class="sc">;</span>
 457 <span class="s">}</span>
 458 
 459 <span class="c"># Is it a quintuple bond?</span>
<a name="IsQuintuple-"></a> 460 <span class="k">sub </span><span class="m">IsQuintuple</span> <span class="s">{</span>
 461   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 462 
 463   <span class="k">return</span> <span class="s">(</span><span class="i">$This</span>-&gt;{<span class="w">BondOrder</span>} == <span class="n">5</span><span class="s">)</span> ? <span class="n">1</span> <span class="co">:</span> <span class="n">0</span><span class="sc">;</span>
 464 <span class="s">}</span>
 465 
 466 <span class="c"># Is it a sextuple bond?</span>
<a name="IsSextuple-"></a> 467 <span class="k">sub </span><span class="m">IsSextuple</span> <span class="s">{</span>
 468   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 469 
 470   <span class="k">return</span> <span class="s">(</span><span class="i">$This</span>-&gt;{<span class="w">BondOrder</span>} == <span class="n">6</span><span class="s">)</span> ? <span class="n">1</span> <span class="co">:</span> <span class="n">0</span><span class="sc">;</span>
 471 <span class="s">}</span>
 472 
 473 <span class="c"># Is bond type specified?</span>
<a name="IsBondTypeSpecified-"></a> 474 <span class="k">sub </span><span class="m">IsBondTypeSpecified</span> <span class="s">{</span>
 475   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 476 
 477   <span class="k">return</span> <span class="s">(</span><span class="i">$This</span>-&gt;{<span class="w">BondType</span>} &amp;&amp; <span class="i">$This</span>-&gt;{<span class="w">BondType</span>} !~ <span class="q">/^(None|Unspecified)$/i</span><span class="s">)</span> ? <span class="n">1</span> <span class="co">:</span> <span class="n">0</span><span class="sc">;</span>
 478 <span class="s">}</span>
 479 
 480 <span class="c"># Is it a dative or coordinate bond?</span>
<a name="IsDative-"></a> 481 <span class="k">sub </span><span class="m">IsDative</span> <span class="s">{</span>
 482   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 483 
 484   <span class="k">return</span> <span class="s">(</span><span class="i">$This</span>-&gt;{<span class="w">BondType</span>} =~ <span class="q">/^(Dative|Coordinate)$/i</span><span class="s">)</span> ? <span class="n">1</span> <span class="co">:</span> <span class="n">0</span><span class="sc">;</span>
 485 <span class="s">}</span>
 486 
 487 <span class="c"># Is it a dative or coordinate bond?</span>
<a name="IsCoordinate-"></a> 488 <span class="k">sub </span><span class="m">IsCoordinate</span> <span class="s">{</span>
 489   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 490 
 491   <span class="k">return</span> <span class="i">$This</span><span class="i">-&gt;IsDative</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 492 <span class="s">}</span>
 493 
 494 <span class="c"># Is it a ionic bond?</span>
<a name="IsIonic-"></a> 495 <span class="k">sub </span><span class="m">IsIonic</span> <span class="s">{</span>
 496   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 497 
 498   <span class="k">return</span> <span class="s">(</span><span class="i">$This</span>-&gt;{<span class="w">BondType</span>} =~ <span class="q">/^Ionic$/i</span><span class="s">)</span> ? <span class="n">1</span> <span class="co">:</span> <span class="n">0</span><span class="sc">;</span>
 499 <span class="s">}</span>
 500 
 501 <span class="c"># Is it a tautomeric bond?</span>
<a name="IsTautomeric-"></a> 502 <span class="k">sub </span><span class="m">IsTautomeric</span> <span class="s">{</span>
 503   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 504 
 505   <span class="k">return</span> <span class="s">(</span><span class="i">$This</span>-&gt;{<span class="w">BondType</span>} =~ <span class="q">/^Tautomeric$/i</span><span class="s">)</span> ? <span class="n">1</span> <span class="co">:</span> <span class="n">0</span><span class="sc">;</span>
 506 <span class="s">}</span>
 507 
 508 <span class="c"># Is bond stereochemistry specified?</span>
<a name="IsBondStereochemistrySpecified-"></a> 509 <span class="k">sub </span><span class="m">IsBondStereochemistrySpecified</span> <span class="s">{</span>
 510   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 511 
 512   <span class="k">return</span> <span class="s">(</span><span class="i">$This</span>-&gt;{<span class="w">BondStereochemistry</span>} &amp;&amp; <span class="i">$This</span>-&gt;{<span class="w">BondStereochemistry</span>} !~ <span class="q">/^(None|Unspecified)$/i</span><span class="s">)</span> ? <span class="n">1</span> <span class="co">:</span> <span class="n">0</span><span class="sc">;</span>
 513 <span class="s">}</span>
 514 
 515 <span class="c"># Is it a Wedge or Up single bond?</span>
<a name="IsWedge-"></a> 516 <span class="k">sub </span><span class="m">IsWedge</span> <span class="s">{</span>
 517   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 518 
 519   <span class="k">return</span> <span class="i">$This</span><span class="i">-&gt;IsUp</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 520 <span class="s">}</span>
 521 
 522 <span class="c"># Is it a Wedge or Up single bond?</span>
<a name="IsUp-"></a> 523 <span class="k">sub </span><span class="m">IsUp</span> <span class="s">{</span>
 524   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 525 
 526   <span class="k">return</span> <span class="s">(</span><span class="i">$This</span>-&gt;{<span class="w">BondStereochemistry</span>} =~ <span class="q">/^(Wedge|Up)$/i</span><span class="s">)</span> ? <span class="n">1</span> <span class="co">:</span> <span class="n">0</span><span class="sc">;</span>
 527 <span class="s">}</span>
 528 
 529 <span class="c"># Is it a Hash or Down single bond?</span>
<a name="IsHash-"></a> 530 <span class="k">sub </span><span class="m">IsHash</span> <span class="s">{</span>
 531   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 532 
 533   <span class="k">return</span> <span class="i">$This</span><span class="i">-&gt;IsDown</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 534 <span class="s">}</span>
 535 
 536 <span class="c"># Is it a Hash or Down single bond?</span>
<a name="IsDown-"></a> 537 <span class="k">sub </span><span class="m">IsDown</span> <span class="s">{</span>
 538   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 539 
 540   <span class="k">return</span> <span class="s">(</span><span class="i">$This</span>-&gt;{<span class="w">BondStereochemistry</span>} =~ <span class="q">/^(Hash|Down)$/i</span><span class="s">)</span> ? <span class="n">1</span> <span class="co">:</span> <span class="n">0</span><span class="sc">;</span>
 541 <span class="s">}</span>
 542 
 543 <span class="c"># Is it a Wavy, WedgeOrHash or UpOrDown single bond?</span>
<a name="IsWedgeOrHash-"></a> 544 <span class="k">sub </span><span class="m">IsWedgeOrHash</span> <span class="s">{</span>
 545   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 546 
 547   <span class="k">return</span> <span class="i">$This</span><span class="i">-&gt;IsUpOrDown</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 548 <span class="s">}</span>
 549 
 550 <span class="c"># Is it a Wavy, WedgeOrHash or UpOrDown single bond?</span>
<a name="IsUpOrDown-"></a> 551 <span class="k">sub </span><span class="m">IsUpOrDown</span> <span class="s">{</span>
 552   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 553 
 554   <span class="k">return</span> <span class="s">(</span><span class="i">$This</span>-&gt;{<span class="w">BondStereochemistry</span>} =~ <span class="q">/^(Wavy|WedgeOrHash|UpOrDown)$/i</span><span class="s">)</span> ? <span class="n">1</span> <span class="co">:</span> <span class="n">0</span><span class="sc">;</span>
 555 <span class="s">}</span>
 556 
 557 <span class="c"># Is it a upward single bond?</span>
<a name="IsUpward-"></a> 558 <span class="k">sub </span><span class="m">IsUpward</span> <span class="s">{</span>
 559   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 560 
 561   <span class="k">return</span> <span class="s">(</span><span class="i">$This</span>-&gt;{<span class="w">BondStereochemistry</span>} =~ <span class="q">/^Upward$/i</span><span class="s">)</span> ? <span class="n">1</span> <span class="co">:</span> <span class="n">0</span><span class="sc">;</span>
 562 <span class="s">}</span>
 563 
 564 <span class="c"># Is it a Downward single bond?</span>
<a name="IsDownward-"></a> 565 <span class="k">sub </span><span class="m">IsDownward</span> <span class="s">{</span>
 566   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 567 
 568   <span class="k">return</span> <span class="s">(</span><span class="i">$This</span>-&gt;{<span class="w">BondStereochemistry</span>} =~ <span class="q">/^Downward$/i</span><span class="s">)</span> ? <span class="n">1</span> <span class="co">:</span> <span class="n">0</span><span class="sc">;</span>
 569 <span class="s">}</span>
 570 <span class="c"># Is it a cis or Z double bond?</span>
<a name="IsCis-"></a> 571 <span class="k">sub </span><span class="m">IsCis</span> <span class="s">{</span>
 572   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 573 
 574   <span class="k">return</span> <span class="s">(</span><span class="i">$This</span>-&gt;{<span class="w">BondStereochemistry</span>} =~ <span class="q">/^(Cis|Z)$/i</span><span class="s">)</span> ? <span class="n">1</span> <span class="co">:</span> <span class="n">0</span><span class="sc">;</span>
 575 <span class="s">}</span>
 576 
 577 <span class="c"># Is it a trans or E double bond?</span>
<a name="IsTrans-"></a> 578 <span class="k">sub </span><span class="m">IsTrans</span> <span class="s">{</span>
 579   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 580 
 581   <span class="k">return</span> <span class="s">(</span><span class="i">$This</span>-&gt;{<span class="w">BondStereochemistry</span>} =~ <span class="q">/^(Trans|E)$/i</span><span class="s">)</span> ? <span class="n">1</span> <span class="co">:</span> <span class="n">0</span><span class="sc">;</span>
 582 <span class="s">}</span>
 583 
 584 <span class="c"># Is it a cis or trans double bond?</span>
<a name="IsCisOrTrans-"></a> 585 <span class="k">sub </span><span class="m">IsCisOrTrans</span> <span class="s">{</span>
 586   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 587 
 588   <span class="k">return</span> <span class="s">(</span><span class="i">$This</span>-&gt;{<span class="w">BondStereochemistry</span>} =~ <span class="q">/^(CisOrTrans|DoubleCross)$/i</span><span class="s">)</span> ? <span class="n">1</span> <span class="co">:</span> <span class="n">0</span><span class="sc">;</span>
 589 <span class="s">}</span>
 590 
 591 <span class="c"># Delete bond...</span>
<a name="DeleteBond-"></a> 592 <span class="k">sub </span><span class="m">DeleteBond</span> <span class="s">{</span>
 593   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 594 
 595   <span class="c"># Is this atom in a molecule?</span>
 596   <span class="k">if</span> <span class="s">(</span>!<span class="i">$This</span><span class="i">-&gt;HasProperty</span><span class="s">(</span><span class="q">&#39;Molecule&#39;</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
 597     <span class="c"># Nothing to do...</span>
 598     <span class="k">return</span> <span class="i">$This</span><span class="sc">;</span>
 599   <span class="s">}</span>
 600   <span class="k">my</span><span class="s">(</span><span class="i">$Molecule</span><span class="s">)</span><span class="sc">;</span>
 601   <span class="i">$Molecule</span> = <span class="i">$This</span><span class="i">-&gt;GetProperty</span><span class="s">(</span><span class="q">&#39;Molecule&#39;</span><span class="s">)</span><span class="sc">;</span>
 602   <span class="i">$Molecule</span><span class="i">-&gt;DeleteBond</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span><span class="sc">;</span>
 603 
 604   <span class="k">return</span> <span class="i">$This</span><span class="sc">;</span>
 605 <span class="s">}</span>
 606 
 607 <span class="c"># Copy bond and all its associated data...</span>
<a name="Copy-"></a> 608 <span class="k">sub </span><span class="m">Copy</span> <span class="s">{</span>
 609   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 610   <span class="k">my</span><span class="s">(</span><span class="i">$Bond</span><span class="s">)</span><span class="sc">;</span>
 611 
 612   <span class="i">$Bond</span> = <span class="i">Storable::dclone</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span><span class="sc">;</span>
 613 
 614   <span class="k">return</span> <span class="i">$Bond</span><span class="sc">;</span>
 615 <span class="s">}</span>
 616 
 617 <span class="c"># Is bond in a ring?</span>
 618 <span class="c">#</span>
<a name="IsInRing-"></a> 619 <span class="k">sub </span><span class="m">IsInRing</span> <span class="s">{</span>
 620   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 621 
 622   <span class="c"># Is this bond in a molecule?</span>
 623   <span class="k">if</span> <span class="s">(</span>!<span class="i">$This</span><span class="i">-&gt;HasProperty</span><span class="s">(</span><span class="q">&#39;Molecule&#39;</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
 624     <span class="k">return</span> <span class="k">undef</span><span class="sc">;</span>
 625   <span class="s">}</span>
 626   <span class="k">my</span><span class="s">(</span><span class="i">$Molecule</span><span class="s">)</span><span class="sc">;</span>
 627   <span class="i">$Molecule</span> = <span class="i">$This</span><span class="i">-&gt;GetProperty</span><span class="s">(</span><span class="q">&#39;Molecule&#39;</span><span class="s">)</span><span class="sc">;</span>
 628 
 629   <span class="k">return</span> <span class="i">$Molecule</span><span class="i">-&gt;_IsBondInRing</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span><span class="sc">;</span>
 630 <span class="s">}</span>
 631 
 632 <span class="c"># Is bond not in a ring?</span>
 633 <span class="c">#</span>
<a name="IsNotInRing-"></a> 634 <span class="k">sub </span><span class="m">IsNotInRing</span> <span class="s">{</span>
 635   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 636 
 637   <span class="c"># Is this bond in a molecule?</span>
 638   <span class="k">if</span> <span class="s">(</span>!<span class="i">$This</span><span class="i">-&gt;HasProperty</span><span class="s">(</span><span class="q">&#39;Molecule&#39;</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
 639     <span class="k">return</span> <span class="k">undef</span><span class="sc">;</span>
 640   <span class="s">}</span>
 641   <span class="k">my</span><span class="s">(</span><span class="i">$Molecule</span><span class="s">)</span><span class="sc">;</span>
 642   <span class="i">$Molecule</span> = <span class="i">$This</span><span class="i">-&gt;GetProperty</span><span class="s">(</span><span class="q">&#39;Molecule&#39;</span><span class="s">)</span><span class="sc">;</span>
 643 
 644   <span class="k">return</span> <span class="i">$Molecule</span><span class="i">-&gt;_IsBondNotInRing</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span><span class="sc">;</span>
 645 <span class="s">}</span>
 646 
 647 <span class="c"># Is bond only in one ring?</span>
 648 <span class="c">#</span>
<a name="IsOnlyInOneRing-"></a> 649 <span class="k">sub </span><span class="m">IsOnlyInOneRing</span> <span class="s">{</span>
 650   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 651 
 652   <span class="c"># Is this bond in a molecule?</span>
 653   <span class="k">if</span> <span class="s">(</span>!<span class="i">$This</span><span class="i">-&gt;HasProperty</span><span class="s">(</span><span class="q">&#39;Molecule&#39;</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
 654     <span class="k">return</span> <span class="k">undef</span><span class="sc">;</span>
 655   <span class="s">}</span>
 656   <span class="k">my</span><span class="s">(</span><span class="i">$Molecule</span><span class="s">)</span><span class="sc">;</span>
 657   <span class="i">$Molecule</span> = <span class="i">$This</span><span class="i">-&gt;GetProperty</span><span class="s">(</span><span class="q">&#39;Molecule&#39;</span><span class="s">)</span><span class="sc">;</span>
 658 
 659   <span class="k">return</span> <span class="i">$Molecule</span><span class="i">-&gt;_IsBondInOnlyOneRing</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span><span class="sc">;</span>
 660 <span class="s">}</span>
 661 
 662 <span class="c"># Is bond in a ring of specific size?</span>
 663 <span class="c">#</span>
<a name="IsInRingOfSize-"></a> 664 <span class="k">sub </span><span class="m">IsInRingOfSize</span> <span class="s">{</span>
 665   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$RingSize</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 666 
 667   <span class="c"># Is this bond in a molecule?</span>
 668   <span class="k">if</span> <span class="s">(</span>!<span class="i">$This</span><span class="i">-&gt;HasProperty</span><span class="s">(</span><span class="q">&#39;Molecule&#39;</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
 669     <span class="k">return</span> <span class="k">undef</span><span class="sc">;</span>
 670   <span class="s">}</span>
 671   <span class="k">my</span><span class="s">(</span><span class="i">$Molecule</span><span class="s">)</span><span class="sc">;</span>
 672   <span class="i">$Molecule</span> = <span class="i">$This</span><span class="i">-&gt;GetProperty</span><span class="s">(</span><span class="q">&#39;Molecule&#39;</span><span class="s">)</span><span class="sc">;</span>
 673 
 674   <span class="k">return</span> <span class="i">$Molecule</span><span class="i">-&gt;_IsBondInRingOfSize</span><span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$RingSize</span><span class="s">)</span><span class="sc">;</span>
 675 <span class="s">}</span>
 676 
 677 <span class="c"># Get size of smallest ring containing the bond...</span>
 678 <span class="c">#</span>
<a name="GetSizeOfSmallestRing-"></a> 679 <span class="k">sub </span><span class="m">GetSizeOfSmallestRing</span> <span class="s">{</span>
 680   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 681 
 682   <span class="c"># Is this bond in a molecule?</span>
 683   <span class="k">if</span> <span class="s">(</span>!<span class="i">$This</span><span class="i">-&gt;HasProperty</span><span class="s">(</span><span class="q">&#39;Molecule&#39;</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
 684     <span class="k">return</span> <span class="k">undef</span><span class="sc">;</span>
 685   <span class="s">}</span>
 686   <span class="k">my</span><span class="s">(</span><span class="i">$Molecule</span><span class="s">)</span><span class="sc">;</span>
 687   <span class="i">$Molecule</span> = <span class="i">$This</span><span class="i">-&gt;GetProperty</span><span class="s">(</span><span class="q">&#39;Molecule&#39;</span><span class="s">)</span><span class="sc">;</span>
 688 
 689   <span class="k">return</span> <span class="i">$Molecule</span><span class="i">-&gt;_GetSizeOfSmallestBondRing</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span><span class="sc">;</span>
 690 <span class="s">}</span>
 691 
 692 <span class="c"># Get size of largest ring containing the bond...</span>
 693 <span class="c">#</span>
<a name="GetSizeOfLargestRing-"></a> 694 <span class="k">sub </span><span class="m">GetSizeOfLargestRing</span> <span class="s">{</span>
 695   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 696 
 697   <span class="c"># Is this bond in a molecule?</span>
 698   <span class="k">if</span> <span class="s">(</span>!<span class="i">$This</span><span class="i">-&gt;HasProperty</span><span class="s">(</span><span class="q">&#39;Molecule&#39;</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
 699     <span class="k">return</span> <span class="k">undef</span><span class="sc">;</span>
 700   <span class="s">}</span>
 701   <span class="k">my</span><span class="s">(</span><span class="i">$Molecule</span><span class="s">)</span><span class="sc">;</span>
 702   <span class="i">$Molecule</span> = <span class="i">$This</span><span class="i">-&gt;GetProperty</span><span class="s">(</span><span class="q">&#39;Molecule&#39;</span><span class="s">)</span><span class="sc">;</span>
 703 
 704   <span class="k">return</span> <span class="i">$Molecule</span><span class="i">-&gt;_GetSizeOfLargestBondRing</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span><span class="sc">;</span>
 705 <span class="s">}</span>
 706 
 707 <span class="c"># Get number of  rings containing the bond...</span>
 708 <span class="c">#</span>
<a name="GetNumOfRings-"></a> 709 <span class="k">sub </span><span class="m">GetNumOfRings</span> <span class="s">{</span>
 710   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 711 
 712   <span class="c"># Is this bond in a molecule?</span>
 713   <span class="k">if</span> <span class="s">(</span>!<span class="i">$This</span><span class="i">-&gt;HasProperty</span><span class="s">(</span><span class="q">&#39;Molecule&#39;</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
 714     <span class="k">return</span> <span class="k">undef</span><span class="sc">;</span>
 715   <span class="s">}</span>
 716   <span class="k">my</span><span class="s">(</span><span class="i">$Molecule</span><span class="s">)</span><span class="sc">;</span>
 717   <span class="i">$Molecule</span> = <span class="i">$This</span><span class="i">-&gt;GetProperty</span><span class="s">(</span><span class="q">&#39;Molecule&#39;</span><span class="s">)</span><span class="sc">;</span>
 718 
 719   <span class="k">return</span> <span class="i">$Molecule</span><span class="i">-&gt;_GetNumOfBondRings</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span><span class="sc">;</span>
 720 <span class="s">}</span>
 721 
 722 <span class="c"># Get number of  rings with odd size containing the bond...</span>
 723 <span class="c">#</span>
<a name="GetNumOfRingsWithOddSize-"></a> 724 <span class="k">sub </span><span class="m">GetNumOfRingsWithOddSize</span> <span class="s">{</span>
 725   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 726 
 727   <span class="c"># Is this bond in a molecule?</span>
 728   <span class="k">if</span> <span class="s">(</span>!<span class="i">$This</span><span class="i">-&gt;HasProperty</span><span class="s">(</span><span class="q">&#39;Molecule&#39;</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
 729     <span class="k">return</span> <span class="k">undef</span><span class="sc">;</span>
 730   <span class="s">}</span>
 731   <span class="k">my</span><span class="s">(</span><span class="i">$Molecule</span><span class="s">)</span><span class="sc">;</span>
 732   <span class="i">$Molecule</span> = <span class="i">$This</span><span class="i">-&gt;GetProperty</span><span class="s">(</span><span class="q">&#39;Molecule&#39;</span><span class="s">)</span><span class="sc">;</span>
 733 
 734   <span class="k">return</span> <span class="i">$Molecule</span><span class="i">-&gt;_GetNumOfBondRingsWithOddSize</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span><span class="sc">;</span>
 735 <span class="s">}</span>
 736 
 737 <span class="c"># Get number of  rings with even size containing the bond...</span>
 738 <span class="c">#</span>
<a name="GetNumOfRingsWithEvenSize-"></a> 739 <span class="k">sub </span><span class="m">GetNumOfRingsWithEvenSize</span> <span class="s">{</span>
 740   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 741 
 742   <span class="c"># Is this bond in a molecule?</span>
 743   <span class="k">if</span> <span class="s">(</span>!<span class="i">$This</span><span class="i">-&gt;HasProperty</span><span class="s">(</span><span class="q">&#39;Molecule&#39;</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
 744     <span class="k">return</span> <span class="k">undef</span><span class="sc">;</span>
 745   <span class="s">}</span>
 746   <span class="k">my</span><span class="s">(</span><span class="i">$Molecule</span><span class="s">)</span><span class="sc">;</span>
 747   <span class="i">$Molecule</span> = <span class="i">$This</span><span class="i">-&gt;GetProperty</span><span class="s">(</span><span class="q">&#39;Molecule&#39;</span><span class="s">)</span><span class="sc">;</span>
 748 
 749   <span class="k">return</span> <span class="i">$Molecule</span><span class="i">-&gt;_GetNumOfBondRingsWithEvenSize</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span><span class="sc">;</span>
 750 <span class="s">}</span>
 751 
 752 <span class="c"># Get number of  rings with specified size containing the bond...</span>
 753 <span class="c">#</span>
<a name="GetNumOfRingsWithSize-"></a> 754 <span class="k">sub </span><span class="m">GetNumOfRingsWithSize</span> <span class="s">{</span>
 755   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$RingSize</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 756 
 757   <span class="c"># Is this bond in a molecule?</span>
 758   <span class="k">if</span> <span class="s">(</span>!<span class="i">$This</span><span class="i">-&gt;HasProperty</span><span class="s">(</span><span class="q">&#39;Molecule&#39;</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
 759     <span class="k">return</span> <span class="k">undef</span><span class="sc">;</span>
 760   <span class="s">}</span>
 761   <span class="k">my</span><span class="s">(</span><span class="i">$Molecule</span><span class="s">)</span><span class="sc">;</span>
 762   <span class="i">$Molecule</span> = <span class="i">$This</span><span class="i">-&gt;GetProperty</span><span class="s">(</span><span class="q">&#39;Molecule&#39;</span><span class="s">)</span><span class="sc">;</span>
 763 
 764   <span class="k">return</span> <span class="i">$Molecule</span><span class="i">-&gt;_GetNumOfBondRingsWithSize</span><span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$RingSize</span><span class="s">)</span><span class="sc">;</span>
 765 <span class="s">}</span>
 766 
 767 <span class="c"># Get number of  rings with size less than specified containing the bond...</span>
 768 <span class="c">#</span>
<a name="GetNumOfRingsWithSizeLessThan-"></a> 769 <span class="k">sub </span><span class="m">GetNumOfRingsWithSizeLessThan</span> <span class="s">{</span>
 770   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$RingSize</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 771 
 772   <span class="c"># Is this bond in a molecule?</span>
 773   <span class="k">if</span> <span class="s">(</span>!<span class="i">$This</span><span class="i">-&gt;HasProperty</span><span class="s">(</span><span class="q">&#39;Molecule&#39;</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
 774     <span class="k">return</span> <span class="k">undef</span><span class="sc">;</span>
 775   <span class="s">}</span>
 776   <span class="k">my</span><span class="s">(</span><span class="i">$Molecule</span><span class="s">)</span><span class="sc">;</span>
 777   <span class="i">$Molecule</span> = <span class="i">$This</span><span class="i">-&gt;GetProperty</span><span class="s">(</span><span class="q">&#39;Molecule&#39;</span><span class="s">)</span><span class="sc">;</span>
 778 
 779   <span class="k">return</span> <span class="i">$Molecule</span><span class="i">-&gt;_GetNumOfBondRingsWithSizeLessThan</span><span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$RingSize</span><span class="s">)</span><span class="sc">;</span>
 780 <span class="s">}</span>
 781 
 782 <span class="c"># Get number of  rings with size greater than specified size containing the bond...</span>
 783 <span class="c">#</span>
<a name="GetNumOfRingsWithSizeGreaterThan-"></a> 784 <span class="k">sub </span><span class="m">GetNumOfRingsWithSizeGreaterThan</span> <span class="s">{</span>
 785   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$RingSize</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 786 
 787   <span class="c"># Is this bond in a molecule?</span>
 788   <span class="k">if</span> <span class="s">(</span>!<span class="i">$This</span><span class="i">-&gt;HasProperty</span><span class="s">(</span><span class="q">&#39;Molecule&#39;</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
 789     <span class="k">return</span> <span class="k">undef</span><span class="sc">;</span>
 790   <span class="s">}</span>
 791   <span class="k">my</span><span class="s">(</span><span class="i">$Molecule</span><span class="s">)</span><span class="sc">;</span>
 792   <span class="i">$Molecule</span> = <span class="i">$This</span><span class="i">-&gt;GetProperty</span><span class="s">(</span><span class="q">&#39;Molecule&#39;</span><span class="s">)</span><span class="sc">;</span>
 793 
 794   <span class="k">return</span> <span class="i">$Molecule</span><span class="i">-&gt;_GetNumOfBondRingsWithSizeGreaterThan</span><span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$RingSize</span><span class="s">)</span><span class="sc">;</span>
 795 <span class="s">}</span>
 796 
 797 <span class="c"># Get all rings as an array of references to arrays containing ring atoms...</span>
 798 <span class="c">#</span>
<a name="GetRings-"></a> 799 <span class="k">sub </span><span class="m">GetRings</span> <span class="s">{</span>
 800   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 801 
 802   <span class="c"># Is this bond in a molecule?</span>
 803   <span class="k">if</span> <span class="s">(</span>!<span class="i">$This</span><span class="i">-&gt;HasProperty</span><span class="s">(</span><span class="q">&#39;Molecule&#39;</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
 804     <span class="k">return</span> <span class="k">undef</span><span class="sc">;</span>
 805   <span class="s">}</span>
 806   <span class="k">my</span><span class="s">(</span><span class="i">$Molecule</span><span class="s">)</span><span class="sc">;</span>
 807   <span class="i">$Molecule</span> = <span class="i">$This</span><span class="i">-&gt;GetProperty</span><span class="s">(</span><span class="q">&#39;Molecule&#39;</span><span class="s">)</span><span class="sc">;</span>
 808 
 809   <span class="k">return</span> <span class="i">$Molecule</span><span class="i">-&gt;_GetBondRings</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span><span class="sc">;</span>
 810 <span class="s">}</span>
 811 
 812 <span class="c"># Get smallest ring as an array containing ring atoms...</span>
 813 <span class="c">#</span>
<a name="GetSmallestRing-"></a> 814 <span class="k">sub </span><span class="m">GetSmallestRing</span> <span class="s">{</span>
 815   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 816 
 817   <span class="c"># Is this bond in a molecule?</span>
 818   <span class="k">if</span> <span class="s">(</span>!<span class="i">$This</span><span class="i">-&gt;HasProperty</span><span class="s">(</span><span class="q">&#39;Molecule&#39;</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
 819     <span class="k">return</span> <span class="k">undef</span><span class="sc">;</span>
 820   <span class="s">}</span>
 821   <span class="k">my</span><span class="s">(</span><span class="i">$Molecule</span><span class="s">)</span><span class="sc">;</span>
 822   <span class="i">$Molecule</span> = <span class="i">$This</span><span class="i">-&gt;GetProperty</span><span class="s">(</span><span class="q">&#39;Molecule&#39;</span><span class="s">)</span><span class="sc">;</span>
 823 
 824   <span class="k">return</span> <span class="i">$Molecule</span><span class="i">-&gt;_GetSmallestBondRing</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span><span class="sc">;</span>
 825 <span class="s">}</span>
 826 
 827 <span class="c"># Get largest ring as an array containing ring atoms...</span>
 828 <span class="c">#</span>
<a name="GetLargestRing-"></a> 829 <span class="k">sub </span><span class="m">GetLargestRing</span> <span class="s">{</span>
 830   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 831 
 832   <span class="c"># Is this bond in a molecule?</span>
 833   <span class="k">if</span> <span class="s">(</span>!<span class="i">$This</span><span class="i">-&gt;HasProperty</span><span class="s">(</span><span class="q">&#39;Molecule&#39;</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
 834     <span class="k">return</span> <span class="k">undef</span><span class="sc">;</span>
 835   <span class="s">}</span>
 836   <span class="k">my</span><span class="s">(</span><span class="i">$Molecule</span><span class="s">)</span><span class="sc">;</span>
 837   <span class="i">$Molecule</span> = <span class="i">$This</span><span class="i">-&gt;GetProperty</span><span class="s">(</span><span class="q">&#39;Molecule&#39;</span><span class="s">)</span><span class="sc">;</span>
 838 
 839   <span class="k">return</span> <span class="i">$Molecule</span><span class="i">-&gt;_GetLargestBondRing</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span><span class="sc">;</span>
 840 <span class="s">}</span>
 841 
 842 <span class="c"># Get odd size rings an array of references to arrays containing ring atoms...</span>
 843 <span class="c">#</span>
<a name="GetRingsWithOddSize-"></a> 844 <span class="k">sub </span><span class="m">GetRingsWithOddSize</span> <span class="s">{</span>
 845   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 846 
 847   <span class="c"># Is this bond in a molecule?</span>
 848   <span class="k">if</span> <span class="s">(</span>!<span class="i">$This</span><span class="i">-&gt;HasProperty</span><span class="s">(</span><span class="q">&#39;Molecule&#39;</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
 849     <span class="k">return</span> <span class="k">undef</span><span class="sc">;</span>
 850   <span class="s">}</span>
 851   <span class="k">my</span><span class="s">(</span><span class="i">$Molecule</span><span class="s">)</span><span class="sc">;</span>
 852   <span class="i">$Molecule</span> = <span class="i">$This</span><span class="i">-&gt;GetProperty</span><span class="s">(</span><span class="q">&#39;Molecule&#39;</span><span class="s">)</span><span class="sc">;</span>
 853 
 854   <span class="k">return</span> <span class="i">$Molecule</span><span class="i">-&gt;_GetBondRingsWithOddSize</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span><span class="sc">;</span>
 855 <span class="s">}</span>
 856 
 857 <span class="c"># Get even size rings an array of references to arrays containing ring atoms...</span>
 858 <span class="c">#</span>
<a name="GetRingsWithEvenSize-"></a> 859 <span class="k">sub </span><span class="m">GetRingsWithEvenSize</span> <span class="s">{</span>
 860   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 861 
 862   <span class="c"># Is this bond in a molecule?</span>
 863   <span class="k">if</span> <span class="s">(</span>!<span class="i">$This</span><span class="i">-&gt;HasProperty</span><span class="s">(</span><span class="q">&#39;Molecule&#39;</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
 864     <span class="k">return</span> <span class="k">undef</span><span class="sc">;</span>
 865   <span class="s">}</span>
 866   <span class="k">my</span><span class="s">(</span><span class="i">$Molecule</span><span class="s">)</span><span class="sc">;</span>
 867   <span class="i">$Molecule</span> = <span class="i">$This</span><span class="i">-&gt;GetProperty</span><span class="s">(</span><span class="q">&#39;Molecule&#39;</span><span class="s">)</span><span class="sc">;</span>
 868 
 869   <span class="k">return</span> <span class="i">$Molecule</span><span class="i">-&gt;_GetBondRingsWithEvenSize</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span><span class="sc">;</span>
 870 <span class="s">}</span>
 871 
 872 <span class="c"># Get rings with specified size  an array of references to arrays containing ring atoms...</span>
 873 <span class="c">#</span>
<a name="GetRingsWithSize-"></a> 874 <span class="k">sub </span><span class="m">GetRingsWithSize</span> <span class="s">{</span>
 875   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$RingSize</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 876 
 877   <span class="c"># Is this bond in a molecule?</span>
 878   <span class="k">if</span> <span class="s">(</span>!<span class="i">$This</span><span class="i">-&gt;HasProperty</span><span class="s">(</span><span class="q">&#39;Molecule&#39;</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
 879     <span class="k">return</span> <span class="k">undef</span><span class="sc">;</span>
 880   <span class="s">}</span>
 881   <span class="k">my</span><span class="s">(</span><span class="i">$Molecule</span><span class="s">)</span><span class="sc">;</span>
 882   <span class="i">$Molecule</span> = <span class="i">$This</span><span class="i">-&gt;GetProperty</span><span class="s">(</span><span class="q">&#39;Molecule&#39;</span><span class="s">)</span><span class="sc">;</span>
 883 
 884   <span class="k">return</span> <span class="i">$Molecule</span><span class="i">-&gt;_GetBondRingsWithSize</span><span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$RingSize</span><span class="s">)</span><span class="sc">;</span>
 885 <span class="s">}</span>
 886 
 887 <span class="c"># Get rings with size less than specfied size as an array of references to arrays containing ring atoms...</span>
 888 <span class="c">#</span>
<a name="GetRingsWithSizeLessThan-"></a> 889 <span class="k">sub </span><span class="m">GetRingsWithSizeLessThan</span> <span class="s">{</span>
 890   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$RingSize</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 891 
 892   <span class="c"># Is this bond in a molecule?</span>
 893   <span class="k">if</span> <span class="s">(</span>!<span class="i">$This</span><span class="i">-&gt;HasProperty</span><span class="s">(</span><span class="q">&#39;Molecule&#39;</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
 894     <span class="k">return</span> <span class="k">undef</span><span class="sc">;</span>
 895   <span class="s">}</span>
 896   <span class="k">my</span><span class="s">(</span><span class="i">$Molecule</span><span class="s">)</span><span class="sc">;</span>
 897   <span class="i">$Molecule</span> = <span class="i">$This</span><span class="i">-&gt;GetProperty</span><span class="s">(</span><span class="q">&#39;Molecule&#39;</span><span class="s">)</span><span class="sc">;</span>
 898 
 899   <span class="k">return</span> <span class="i">$Molecule</span><span class="i">-&gt;_GetBondRingsWithSizeLessThan</span><span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$RingSize</span><span class="s">)</span><span class="sc">;</span>
 900 <span class="s">}</span>
 901 
 902 <span class="c"># Get rings with size greater than specfied size as an array of references to arrays containing ring atoms...</span>
 903 <span class="c">#</span>
<a name="GetRingsWithSizeGreaterThan-"></a> 904 <span class="k">sub </span><span class="m">GetRingsWithSizeGreaterThan</span> <span class="s">{</span>
 905   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$RingSize</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 906 
 907   <span class="c"># Is this bond in a molecule?</span>
 908   <span class="k">if</span> <span class="s">(</span>!<span class="i">$This</span><span class="i">-&gt;HasProperty</span><span class="s">(</span><span class="q">&#39;Molecule&#39;</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
 909     <span class="k">return</span> <span class="k">undef</span><span class="sc">;</span>
 910   <span class="s">}</span>
 911   <span class="k">my</span><span class="s">(</span><span class="i">$Molecule</span><span class="s">)</span><span class="sc">;</span>
 912   <span class="i">$Molecule</span> = <span class="i">$This</span><span class="i">-&gt;GetProperty</span><span class="s">(</span><span class="q">&#39;Molecule&#39;</span><span class="s">)</span><span class="sc">;</span>
 913 
 914   <span class="k">return</span> <span class="i">$Molecule</span><span class="i">-&gt;_GetBondRingsWithSizeGreaterThan</span><span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$RingSize</span><span class="s">)</span><span class="sc">;</span>
 915 <span class="s">}</span>
 916 
 917 <span class="c"># Get next object ID...</span>
<a name="_GetNewObjectID-"></a> 918 <span class="k">sub </span><span class="m">_GetNewObjectID</span> <span class="s">{</span>
 919   <span class="i">$ObjectID</span>++<span class="sc">;</span>
 920   <span class="k">return</span> <span class="i">$ObjectID</span><span class="sc">;</span>
 921 <span class="s">}</span>
 922 
 923 <span class="c"># Return a string containing bond and other properties...</span>
<a name="StringifyBond-"></a> 924 <span class="k">sub </span><span class="m">StringifyBond</span> <span class="s">{</span>
 925   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 926   <span class="k">my</span><span class="s">(</span><span class="i">$BondString</span><span class="cm">,</span> <span class="i">$ID</span><span class="cm">,</span> <span class="i">$BondOrder</span><span class="cm">,</span> <span class="i">$BondType</span><span class="cm">,</span> <span class="i">$Stereochemistry</span><span class="cm">,</span> <span class="i">$AtomsString</span><span class="cm">,</span> <span class="i">$RingBond</span><span class="cm">,</span> <span class="i">$AromaticBond</span><span class="cm">,</span> <span class="i">$NumOfRings</span><span class="cm">,</span> <span class="i">$Atom1</span><span class="cm">,</span> <span class="i">$Atom2</span><span class="s">)</span><span class="sc">;</span>
 927 
 928   <span class="i">$ID</span> = <span class="i">$This</span><span class="i">-&gt;GetID</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 929   <span class="i">$BondOrder</span> = <span class="i">$This</span><span class="i">-&gt;GetBondOrder</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 930   <span class="k">if</span> <span class="s">(</span>!<span class="k">defined</span> <span class="i">$BondOrder</span><span class="s">)</span> <span class="s">{</span>
 931     <span class="i">$BondOrder</span> = <span class="q">&quot;undefined&quot;</span><span class="sc">;</span>
 932   <span class="s">}</span>
 933   <span class="i">$BondType</span> = <span class="i">$This</span><span class="i">-&gt;GetBondType</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 934   <span class="k">if</span> <span class="s">(</span>!<span class="k">defined</span> <span class="i">$BondOrder</span><span class="s">)</span> <span class="s">{</span>
 935     <span class="i">$BondType</span> = <span class="q">&quot;undefined&quot;</span><span class="sc">;</span>
 936   <span class="s">}</span>
 937   <span class="k">if</span> <span class="s">(</span><span class="k">defined</span><span class="s">(</span><span class="i">$BondOrder</span><span class="s">)</span> &amp;&amp; <span class="i">$BondOrder</span> == <span class="n">2</span><span class="s">)</span> <span class="s">{</span>
 938     <span class="i">$Stereochemistry</span> = <span class="i">$This</span><span class="i">-&gt;GetStereochemistry</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 939     <span class="k">if</span> <span class="s">(</span>!<span class="k">defined</span> <span class="i">$Stereochemistry</span><span class="s">)</span> <span class="s">{</span>
 940       <span class="i">$Stereochemistry</span> = <span class="q">&quot;undefined&quot;</span><span class="sc">;</span>
 941     <span class="s">}</span>
 942   <span class="s">}</span>
 943   <span class="i">$RingBond</span> = <span class="i">$This</span><span class="i">-&gt;IsInRing</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 944   <span class="k">if</span> <span class="s">(</span><span class="k">defined</span> <span class="i">$RingBond</span><span class="s">)</span> <span class="s">{</span>
 945     <span class="i">$RingBond</span> = <span class="i">$RingBond</span>  ? <span class="q">&#39;Yes&#39;</span> <span class="co">:</span> <span class="q">&#39;No&#39;</span><span class="sc">;</span>
 946     <span class="i">$NumOfRings</span> = <span class="i">$This</span><span class="i">-&gt;GetNumOfRings</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 947   <span class="s">}</span>
 948   <span class="k">else</span> <span class="s">{</span>
 949     <span class="i">$RingBond</span> = <span class="q">&#39;undefined&#39;</span><span class="sc">;</span>
 950     <span class="i">$NumOfRings</span> = <span class="q">&#39;undefined&#39;</span><span class="sc">;</span>
 951   <span class="s">}</span>
 952 
 953   <span class="i">$AromaticBond</span> = <span class="i">$This</span><span class="i">-&gt;GetAromatic</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 954   <span class="k">if</span> <span class="s">(</span><span class="k">defined</span> <span class="i">$AromaticBond</span><span class="s">)</span> <span class="s">{</span>
 955     <span class="i">$AromaticBond</span> = <span class="i">$AromaticBond</span>  ? <span class="q">&#39;Yes&#39;</span> <span class="co">:</span> <span class="q">&#39;No&#39;</span><span class="sc">;</span>
 956   <span class="s">}</span>
 957   <span class="k">else</span> <span class="s">{</span>
 958     <span class="i">$AromaticBond</span> = <span class="q">&#39;undefined&#39;</span><span class="sc">;</span>
 959   <span class="s">}</span>
 960 
 961   <span class="s">(</span><span class="i">$Atom1</span><span class="cm">,</span> <span class="i">$Atom2</span><span class="s">)</span> = <span class="i">$This</span><span class="i">-&gt;GetAtoms</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 962   <span class="i">$AtomsString</span> = <span class="q">&quot;Atoms: undefined&quot;</span><span class="sc">;</span>
 963   <span class="k">if</span> <span class="s">(</span><span class="k">defined</span><span class="s">(</span><span class="i">$Atom1</span><span class="s">)</span> &amp;&amp; <span class="k">defined</span><span class="s">(</span><span class="i">$Atom2</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
 964     <span class="k">my</span><span class="s">(</span><span class="i">$Atom</span><span class="cm">,</span> <span class="i">$AtomID</span><span class="cm">,</span> <span class="i">$AtomCount</span><span class="cm">,</span> <span class="i">$AtomName</span><span class="cm">,</span> <span class="i">$AtomSymbol</span><span class="cm">,</span> <span class="i">$AtomicNumber</span><span class="cm">,</span> <span class="i">@BondAtoms</span><span class="s">)</span><span class="sc">;</span>
 965     <span class="i">@BondAtoms</span> = <span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 966     <span class="k">push</span> <span class="i">@BondAtoms</span><span class="cm">,</span> <span class="s">(</span><span class="i">$Atom1</span><span class="cm">,</span> <span class="i">$Atom2</span><span class="s">)</span><span class="sc">;</span>
 967     <span class="i">$AtomCount</span> = <span class="n">0</span><span class="sc">;</span>
 968     <span class="i">$AtomsString</span> = <span class="q">&quot;&quot;</span><span class="sc">;</span>
 969     <span class="k">for</span> <span class="i">$Atom</span> <span class="s">(</span><span class="i">@BondAtoms</span><span class="s">)</span> <span class="s">{</span>
 970       <span class="i">$AtomCount</span>++<span class="sc">;</span>
 971       <span class="i">$AtomID</span> = <span class="i">$Atom</span><span class="i">-&gt;GetID</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 972       <span class="i">$AtomName</span> = <span class="i">$Atom</span><span class="i">-&gt;GetName</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 973       <span class="i">$AtomSymbol</span> = <span class="i">$Atom</span><span class="i">-&gt;GetAtomSymbol</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 974       <span class="i">$AtomicNumber</span> = <span class="i">$Atom</span><span class="i">-&gt;GetAtomicNumber</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 975       <span class="k">if</span> <span class="s">(</span><span class="i">$AtomCount</span> == <span class="n">1</span><span class="s">)</span> <span class="s">{</span>
 976         <span class="i">$AtomsString</span> .= <span class="q">&quot;FirstAtom:&quot;</span><span class="sc">;</span>
 977       <span class="s">}</span>
 978       <span class="k">else</span> <span class="s">{</span>
 979         <span class="i">$AtomsString</span> .= <span class="q">&quot;; SecondAtom:&quot;</span><span class="sc">;</span>
 980       <span class="s">}</span>
 981       <span class="i">$AtomsString</span> .= <span class="q">&quot; [ ID: $AtomID; Name: \&quot;$AtomName\&quot;; AtomSymbol: \&quot;$AtomSymbol\&quot;; AtomicNumber: $AtomicNumber ]&quot;</span><span class="sc">;</span>
 982     <span class="s">}</span>
 983   <span class="s">}</span>
 984   <span class="i">$BondString</span> = <span class="q">&quot;Bond: ID: $ID; BondOrder: $BondOrder; BondType: $BondType; RingBond: $RingBond; NumOfBondRings: $NumOfRings; AromaticBond: $AromaticBond;&quot;</span><span class="sc">;</span>
 985   <span class="k">if</span> <span class="s">(</span><span class="k">defined</span><span class="s">(</span><span class="i">$BondOrder</span><span class="s">)</span> &amp;&amp; <span class="i">$BondOrder</span> == <span class="n">2</span><span class="s">)</span> <span class="s">{</span>
 986   <span class="i">$BondString</span> .= <span class="q">&quot; Stereochemistry: $Stereochemistry;&quot;</span><span class="sc">;</span>
 987   <span class="s">}</span>
 988   <span class="i">$BondString</span> .= <span class="q">&quot; $AtomsString&quot;</span><span class="sc">;</span>
 989 
 990   <span class="k">return</span> <span class="i">$BondString</span><span class="sc">;</span>
 991 <span class="s">}</span>
 992 
<a name="EOF-"></a></pre>
<p>&nbsp;</p>
<br />
<center>
<img src="../../../images/h2o2.png">
</center>
</body>
</html>
