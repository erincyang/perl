<html>
<head>
<title>MayaChemTools:Code:FileUtil.pm</title>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<link rel="stylesheet" type="text/css" href="../../../css/MayaChemToolsCode.css">
</head>
<body leftmargin="20" rightmargin="20" topmargin="10" bottommargin="10">
<br/>
<center>
<a href="http://www.mayachemtools.org" title="MayaChemTools Home"><img src="../../../images/MayaChemToolsLogo.gif" border="0" alt="MayaChemTools"></a>
</center>
<br/>
<pre>
<a name="package-FileUtil-"></a>   1 <span class="k">package </span><span class="i">FileUtil</span><span class="sc">;</span>
   2 <span class="c">#</span>
   3 <span class="c"># $RCSfile: FileUtil.pm,v $</span>
   4 <span class="c"># $Date: 2017/01/12 18:57:49 $</span>
   5 <span class="c"># $Revision: 1.42 $</span>
   6 <span class="c">#</span>
   7 <span class="c"># Author: Manish Sud &lt;msud@san.rr.com&gt;</span>
   8 <span class="c">#</span>
   9 <span class="c"># Copyright (C) 2017 Manish Sud. All rights reserved.</span>
  10 <span class="c">#</span>
  11 <span class="c"># This file is part of MayaChemTools.</span>
  12 <span class="c">#</span>
  13 <span class="c"># MayaChemTools is free software; you can redistribute it and/or modify it under</span>
  14 <span class="c"># the terms of the GNU Lesser General Public License as published by the Free</span>
  15 <span class="c"># Software Foundation; either version 3 of the License, or (at your option) any</span>
  16 <span class="c"># later version.</span>
  17 <span class="c">#</span>
  18 <span class="c"># MayaChemTools is distributed in the hope that it will be useful, but without</span>
  19 <span class="c"># any warranty; without even the implied warranty of merchantability of fitness</span>
  20 <span class="c"># for a particular purpose.  See the GNU Lesser General Public License for more</span>
  21 <span class="c"># details.</span>
  22 <span class="c">#</span>
  23 <span class="c"># You should have received a copy of the GNU Lesser General Public License</span>
  24 <span class="c"># along with MayaChemTools; if not, see &lt;http://www.gnu.org/licenses/&gt; or</span>
  25 <span class="c"># write to the Free Software Foundation Inc., 59 Temple Place, Suite 330,</span>
  26 <span class="c"># Boston, MA, 02111-1307, USA.</span>
  27 <span class="c">#</span>
  28 
  29 <span class="k">use</span> <span class="w">strict</span><span class="sc">;</span>
  30 <span class="k">use</span> <span class="w">Exporter</span><span class="sc">;</span>
  31 <span class="k">use</span> <span class="w">Carp</span><span class="sc">;</span>
  32 <span class="k">use</span> <span class="w">File::stat</span><span class="sc">;</span>
  33 <span class="k">use</span> <span class="w">Time::localtime</span> <span class="s">(</span><span class="s">)</span><span class="sc">;</span>
  34 <span class="k">use</span> <span class="w">TextUtil</span> <span class="s">(</span><span class="s">)</span><span class="sc">;</span>
  35 
  36 <span class="k">use</span> <span class="w">vars</span> <span class="q">qw(@ISA @EXPORT @EXPORT_OK %EXPORT_TAGS)</span><span class="sc">;</span>
  37 
  38 <span class="i">@ISA</span> = <span class="q">qw(Exporter)</span><span class="sc">;</span>
  39 <span class="i">@EXPORT</span> = <span class="q">qw(CheckFileType ConvertCygwinPath ExpandFileNames FileModificationTimeAndDate FormattedFileModificationTimeAndDate FileSize FormatFileSize GetMayaChemToolsLibDirName GetUsageFromPod ParseFileName)</span><span class="sc">;</span>
  40 <span class="i">@EXPORT_OK</span> = <span class="q">qw()</span><span class="sc">;</span>
  41 <span class="i">%EXPORT_TAGS</span> = <span class="s">(</span><span class="w">all</span>  <span class="cm">=&gt;</span> <span class="s">[</span><span class="i">@EXPORT</span><span class="cm">,</span> <span class="i">@EXPORT_OK</span><span class="s">]</span><span class="s">)</span><span class="sc">;</span>
  42 
  43 <span class="c"># Setup package variables...</span>
  44 <span class="k">my</span><span class="s">(</span><span class="i">$MayaChemToolsLibDir</span><span class="s">)</span><span class="sc">;</span>
  45 
  46 <span class="c"># Check to see path contains cygdrive and convert it into windows path...</span>
<a name="ConvertCygwinPath-"></a>  47 <span class="k">sub </span><span class="m">ConvertCygwinPath</span> <span class="s">{</span>
  48   <span class="k">my</span><span class="s">(</span><span class="i">$Path</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
  49   <span class="k">my</span><span class="s">(</span><span class="i">$NewPath</span><span class="cm">,</span> <span class="i">$OSName</span><span class="s">)</span><span class="sc">;</span>
  50 
  51   <span class="i">$NewPath</span> = <span class="i">$Path</span><span class="sc">;</span> <span class="i">$OSName</span> = <span class="i">$^O</span><span class="sc">;</span>
  52   <span class="k">if</span> <span class="s">(</span><span class="i">$OSName</span> =~ <span class="q">/cygwin/i</span> &amp;&amp; <span class="i">$Path</span> =~ <span class="q">/cygdrive/i</span> <span class="s">)</span> <span class="s">{</span>
  53     <span class="k">my</span><span class="s">(</span><span class="i">@PathParts</span><span class="s">)</span> = <span class="k">split</span> <span class="q">&quot;\/&quot;</span><span class="cm">,</span> <span class="i">$Path</span><span class="sc">;</span>
  54     <span class="k">my</span><span class="s">(</span><span class="i">$Drive</span><span class="s">)</span> = <span class="i">$PathParts</span>[<span class="n">2</span>]<span class="sc">;</span>
  55     <span class="k">shift</span> <span class="i">@PathParts</span><span class="sc">;</span> <span class="k">shift</span> <span class="i">@PathParts</span><span class="sc">;</span> <span class="k">shift</span> <span class="i">@PathParts</span><span class="sc">;</span>
  56     <span class="i">$NewPath</span> = <span class="k">join</span> <span class="q">&quot;\/&quot;</span><span class="cm">,</span> <span class="i">@PathParts</span><span class="sc">;</span>
  57     <span class="i">$NewPath</span> = <span class="i">$Drive</span>. <span class="q">&quot;:\/&quot;</span> . <span class="i">$NewPath</span><span class="sc">;</span>
  58   <span class="s">}</span>
  59   <span class="k">return</span> <span class="i">$NewPath</span><span class="sc">;</span>
  60 <span class="s">}</span>
  61 
  62 <span class="c"># Based on the file name extension, figure out its type.</span>
<a name="CheckFileType-"></a>  63 <span class="k">sub </span><span class="m">CheckFileType</span> <span class="s">{</span>
  64   <span class="k">my</span><span class="s">(</span><span class="i">$FileName</span><span class="cm">,</span> <span class="i">$FileExts</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
  65   <span class="k">my</span><span class="s">(</span><span class="i">$Status</span><span class="cm">,</span> <span class="i">@FileExtsList</span><span class="cm">,</span> <span class="i">$Index</span><span class="cm">,</span> <span class="i">$Ext</span><span class="s">)</span><span class="sc">;</span>
  66 
  67   <span class="i">$Status</span> = <span class="n">0</span><span class="sc">;</span>
  68   <span class="i">@FileExtsList</span> = <span class="k">split</span> <span class="q">&quot; &quot;</span><span class="cm">,</span> <span class="i">$FileExts</span><span class="sc">;</span>
  69   <span class="k">for</span> <span class="i">$Index</span> <span class="s">(</span><span class="n">0</span> .. <span class="i">$#FileExtsList</span><span class="s">)</span> <span class="s">{</span>
  70     <span class="i">$Ext</span> = <span class="i">$FileExtsList</span>[<span class="i">$Index</span>]<span class="sc">;</span>
  71     <span class="k">if</span> <span class="s">(</span><span class="i">$FileName</span> =~ <span class="q">/(\.$Ext)$/i</span><span class="s">)</span> <span class="s">{</span>
  72       <span class="i">$Status</span> = <span class="n">1</span><span class="sc">;</span>
  73     <span class="s">}</span>
  74   <span class="s">}</span>
  75   <span class="k">return</span> <span class="s">(</span><span class="i">$Status</span><span class="s">)</span><span class="sc">;</span>
  76 <span class="s">}</span>
  77 
  78 <span class="c"># Expand file names using specified directory and/or file names along with any</span>
  79 <span class="c"># file extensions containing one or more wild cards. And return the expanded</span>
  80 <span class="c"># list.</span>
  81 <span class="c">#</span>
  82 <span class="c"># IncludeDirName controls whether directory prefixes are included in expanded</span>
  83 <span class="c"># file names. Default is to always append directory name before expanded file</span>
  84 <span class="c"># name.</span>
  85 <span class="c">#</span>
  86 <span class="c"># Notes:</span>
  87 <span class="c">#   . Multiple file extensions are delimited by spaces.</span>
  88 <span class="c">#   . Wild card, *, is supported in directory and file names along with file</span>
  89 <span class="c">#     extensions.</span>
  90 <span class="c">#   . For a specified directory name in the files list, all the files in the</span>
  91 <span class="c">#     directory are retrieved using Perl opendir function and files filtered using file</span>
  92 <span class="c">#     extensions. The file names &quot;.&quot; and &quot;..&quot; returned by opendir are ignored.</span>
  93 <span class="c">#   . For file names containing wild cards with and without any explicit file</span>
  94 <span class="c">#     extension specification in the file name, all the files in the directory are retrieved</span>
  95 <span class="c">#     using Perl opendir function and files filtered using file name along with any</span>
  96 <span class="c">#     file extension. The file names &quot;.&quot; and &quot;..&quot; returned by opendir are ignored.</span>
  97 <span class="c">#</span>
<a name="ExpandFileNames-"></a>  98 <span class="k">sub </span><span class="m">ExpandFileNames</span> <span class="s">{</span>
  99   <span class="k">my</span><span class="s">(</span><span class="i">$Files</span><span class="cm">,</span> <span class="i">$FileExts</span><span class="cm">,</span> <span class="i">$IncludeDirName</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 100   <span class="k">my</span><span class="s">(</span><span class="i">$FileName</span><span class="cm">,</span> <span class="i">$Index</span><span class="cm">,</span> <span class="i">$Delimiter</span><span class="cm">,</span> <span class="i">$FileExtsPattern</span><span class="cm">,</span> <span class="i">@FilesList</span><span class="cm">,</span> <span class="i">@DirFileNames</span><span class="s">)</span><span class="sc">;</span>
 101 
 102   <span class="c"># Check whether to include directory name in expanded file names...</span>
 103   <span class="i">$IncludeDirName</span> = <span class="k">defined</span> <span class="i">$IncludeDirName</span> ? <span class="i">$IncludeDirName</span> <span class="co">:</span> <span class="n">1</span><span class="sc">;</span>
 104 
 105   <span class="c"># Setup file externsions...</span>
 106   <span class="i">$FileExtsPattern</span> = <span class="q">&quot;&quot;</span><span class="sc">;</span>
 107   <span class="k">if</span> <span class="s">(</span><span class="i">$FileExts</span><span class="s">)</span> <span class="s">{</span>
 108     <span class="i">$FileExtsPattern</span> = <span class="k">join</span> <span class="q">&quot;|&quot;</span><span class="cm">,</span> <span class="k">split</span> <span class="q">&quot; &quot;</span><span class="cm">,</span> <span class="i">$FileExts</span><span class="sc">;</span>
 109     <span class="k">if</span> <span class="s">(</span><span class="i">$FileExtsPattern</span> =~ <span class="q">/\*/</span><span class="s">)</span> <span class="s">{</span>
 110       <span class="c"># Replace * by .*? for greedy match...</span>
 111       <span class="i">$FileExtsPattern</span> =~ <span class="q">s/\*/\.\*\?/g</span><span class="sc">;</span>
 112     <span class="s">}</span>
 113   <span class="s">}</span>
 114 
 115   <span class="i">@FilesList</span> = <span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 116 
 117   <span class="j">FILEINDEX:</span> <span class="k">for</span> <span class="s">(</span><span class="i">$Index</span> = <span class="n">0</span><span class="sc">;</span> <span class="i">$Index</span> &lt; <span class="i">@$Files</span><span class="sc">;</span> <span class="i">$Index</span>++<span class="s">)</span> <span class="s">{</span>
 118     <span class="i">$FileName</span> = <span class="i">@$Files</span>[<span class="i">$Index</span>]<span class="sc">;</span>
 119     <span class="i">$Delimiter</span> = <span class="q">&quot;\/&quot;</span><span class="sc">;</span>
 120     <span class="k">if</span> <span class="s">(</span><span class="i">$FileName</span> =~ <span class="q">/\\/</span> <span class="s">)</span> <span class="s">{</span>
 121       <span class="i">$Delimiter</span> = <span class="q">&quot;\\&quot;</span><span class="sc">;</span>
 122     <span class="s">}</span>
 123 
 124     <span class="k">if</span> <span class="s">(</span><span class="k">-d</span> <span class="i">$FileName</span><span class="s">)</span> <span class="s">{</span>
 125       <span class="k">my</span><span class="s">(</span><span class="i">$DirName</span><span class="cm">,</span> <span class="i">$DirNamePrefix</span><span class="s">)</span><span class="sc">;</span>
 126 
 127       <span class="i">$DirName</span> = <span class="i">$FileName</span><span class="sc">;</span>
 128       <span class="i">$DirNamePrefix</span> = <span class="i">$IncludeDirName</span> ? <span class="q">&quot;$DirName$Delimiter&quot;</span> <span class="co">:</span> <span class="q">&quot;&quot;</span><span class="sc">;</span>
 129 
 130       <span class="c"># glob doesn&#39;t appear to work during command line invocation from Windows.</span>
 131       <span class="c"># So, use opendir to make it work...</span>
 132       <span class="c">#</span>
 133       <span class="c"># push @FilesList,  map {glob(&quot;$DirName/*.$_&quot;)} split &quot; &quot;, $FileExts;</span>
 134       <span class="c">#</span>
 135       <span class="i">@DirFileNames</span> = <span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 136       <span class="k">if</span> <span class="s">(</span>!<span class="k">opendir</span> <span class="w">DIRNAME</span><span class="cm">,</span> <span class="i">$DirName</span><span class="s">)</span> <span class="s">{</span>
 137         <span class="w">carp</span> <span class="q">&quot;Warning: Ignoring directory $DirName: Couldn&#39;t open it: $! ...&quot;</span><span class="sc">;</span>
 138         <span class="k">next</span> <span class="j">FILEINDEX</span><span class="sc">;</span>
 139       <span class="s">}</span>
 140 
 141       <span class="c"># Collect file names without &#39;.&#39; and &#39;..&#39; as readdir function places them on the list...</span>
 142       <span class="c">#</span>
 143       <span class="i">@DirFileNames</span> = <span class="k">map</span> <span class="s">{</span> <span class="q">&quot;$DirNamePrefix$_&quot;</span>  <span class="s">}</span> <span class="k">grep</span> <span class="s">{</span> !<span class="q">/^(\.|\.\.)$/</span> <span class="s">}</span> <span class="k">readdir</span> <span class="w">DIRNAME</span><span class="sc">;</span>
 144       <span class="k">closedir</span> <span class="w">DIRNAME</span><span class="sc">;</span>
 145 
 146       <span class="c"># Collect files with any specified file extensions...</span>
 147       <span class="k">if</span> <span class="s">(</span><span class="i">$FileExtsPattern</span><span class="s">)</span> <span class="s">{</span>
 148         <span class="i">@DirFileNames</span> = <span class="k">grep</span> <span class="s">{</span> <span class="q">/\.$FileExtsPattern$/</span> <span class="s">}</span> <span class="i">@DirFileNames</span><span class="sc">;</span>
 149       <span class="s">}</span>
 150 
 151       <span class="k">push</span> <span class="i">@FilesList</span><span class="cm">,</span> <span class="i">@DirFileNames</span><span class="sc">;</span>
 152     <span class="s">}</span>
 153     <span class="k">elsif</span> <span class="s">(</span><span class="i">$FileName</span> =~ <span class="q">/\*/</span><span class="s">)</span> <span class="s">{</span>
 154       <span class="k">my</span><span class="s">(</span><span class="i">$FileDir</span><span class="cm">,</span> <span class="i">$Name</span><span class="cm">,</span> <span class="i">$FileExt</span><span class="cm">,</span> <span class="i">$DirNamePrefix</span><span class="s">)</span><span class="sc">;</span>
 155 
 156       <span class="c"># Filenames are not expanded during command line invocation from Windows...</span>
 157       <span class="s">(</span><span class="i">$FileDir</span><span class="cm">,</span> <span class="i">$Name</span><span class="cm">,</span> <span class="i">$FileExt</span><span class="s">)</span> = <span class="i">ParseFileName</span><span class="s">(</span><span class="i">$FileName</span><span class="s">)</span><span class="sc">;</span>
 158 
 159       <span class="i">$DirNamePrefix</span> = <span class="i">$IncludeDirName</span> ? <span class="q">&quot;$FileDir$Delimiter&quot;</span> <span class="co">:</span> <span class="q">&quot;&quot;</span><span class="sc">;</span>
 160 
 161       <span class="i">@DirFileNames</span> = <span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 162       <span class="k">if</span> <span class="s">(</span>!<span class="k">opendir</span> <span class="w">FILEDIR</span><span class="cm">,</span> <span class="i">$FileDir</span><span class="s">)</span> <span class="s">{</span>
 163         <span class="w">carp</span> <span class="q">&quot;Warning: Ignoring files $FileName: Couldn&#39;t open directory $FileDir: $! ...&quot;</span><span class="sc">;</span>
 164         <span class="k">next</span> <span class="j">FILEINDEX</span><span class="sc">;</span>
 165       <span class="s">}</span>
 166 
 167       <span class="c"># Collect file names without &#39;.&#39; and &#39;..&#39; as readdir function places them on the list...</span>
 168       <span class="c">#</span>
 169       <span class="i">@DirFileNames</span> = <span class="k">map</span> <span class="s">{</span> <span class="q">&quot;$DirNamePrefix$_&quot;</span>  <span class="s">}</span> <span class="k">grep</span> <span class="s">{</span> !<span class="q">/^(\.|\.\.)$/</span> <span class="s">}</span> <span class="k">readdir</span> <span class="w">FILEDIR</span><span class="sc">;</span>
 170       <span class="k">closedir</span> <span class="w">FILEDIR</span><span class="sc">;</span>
 171 
 172       <span class="k">if</span> <span class="s">(</span><span class="k">length</span><span class="s">(</span><span class="i">$Name</span><span class="s">)</span> &gt; <span class="n">1</span><span class="s">)</span> <span class="s">{</span>
 173         <span class="c"># Replace * by .*? for greedy match...</span>
 174         <span class="i">$Name</span> =~ <span class="q">s/\*/\.\*\?/g</span><span class="sc">;</span>
 175         <span class="i">@DirFileNames</span> =  <span class="k">grep</span> <span class="s">{</span> <span class="q">/$Name/</span> <span class="s">}</span> <span class="i">@DirFileNames</span><span class="sc">;</span>
 176       <span class="s">}</span>
 177 
 178       <span class="k">if</span> <span class="s">(</span><span class="i">$FileExt</span><span class="s">)</span> <span class="s">{</span>
 179         <span class="i">$FileExt</span> =~ <span class="q">s/\*/\.\*\?/g</span><span class="sc">;</span>
 180         <span class="i">@DirFileNames</span> =  <span class="k">grep</span> <span class="s">{</span> <span class="q">/\.$FileExt$/</span> <span class="s">}</span> <span class="i">@DirFileNames</span><span class="sc">;</span>
 181       <span class="s">}</span>
 182       <span class="k">elsif</span> <span class="s">(</span><span class="i">$FileExtsPattern</span><span class="s">)</span> <span class="s">{</span>
 183         <span class="i">@DirFileNames</span> = <span class="k">grep</span> <span class="s">{</span> <span class="q">/\.$FileExtsPattern$/</span> <span class="s">}</span> <span class="i">@DirFileNames</span><span class="sc">;</span>
 184       <span class="s">}</span>
 185 
 186       <span class="k">push</span> <span class="i">@FilesList</span><span class="cm">,</span> <span class="i">@DirFileNames</span><span class="sc">;</span>
 187     <span class="s">}</span>
 188     <span class="k">else</span> <span class="s">{</span>
 189       <span class="k">push</span> <span class="i">@FilesList</span><span class="cm">,</span> <span class="i">$FileName</span><span class="sc">;</span>
 190     <span class="s">}</span>
 191   <span class="s">}</span>
 192   <span class="k">return</span> <span class="i">@FilesList</span><span class="sc">;</span>
 193 <span class="s">}</span>
 194 
 195 <span class="c"># Formatted file modification time...</span>
<a name="FormattedFileModificationTimeAndDate-"></a> 196 <span class="k">sub </span><span class="m">FormattedFileModificationTimeAndDate</span> <span class="s">{</span>
 197   <span class="k">my</span><span class="s">(</span><span class="i">$FileName</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 198   <span class="k">my</span><span class="s">(</span><span class="i">$TimeString</span><span class="cm">,</span> <span class="i">$DateString</span><span class="s">)</span> = <span class="s">(</span><span class="q">&#39;&#39;</span><span class="s">)</span> x <span class="n">2</span><span class="sc">;</span>
 199 
 200   <span class="k">if</span> <span class="s">(</span>! <span class="k">-e</span> <span class="i">$FileName</span><span class="s">)</span> <span class="s">{</span>
 201     <span class="k">return</span> <span class="s">(</span><span class="i">$TimeString</span><span class="cm">,</span> <span class="i">$DateString</span><span class="s">)</span><span class="sc">;</span>
 202   <span class="s">}</span>
 203   <span class="k">my</span><span class="s">(</span><span class="i">$Hours</span><span class="cm">,</span> <span class="i">$Mins</span><span class="cm">,</span> <span class="i">$Secs</span><span class="cm">,</span> <span class="i">$DayName</span><span class="cm">,</span> <span class="i">$MonthName</span><span class="cm">,</span> <span class="i">$Month</span><span class="cm">,</span> <span class="i">$Year</span><span class="s">)</span> = <span class="i">FileModificationTimeAndDate</span><span class="s">(</span><span class="i">$FileName</span><span class="s">)</span><span class="sc">;</span>
 204 
 205   <span class="c"># Setup time suffix...</span>
 206   <span class="k">my</span><span class="s">(</span><span class="i">$TimeSuffix</span><span class="s">)</span> = <span class="q">&#39;&#39;</span><span class="sc">;</span>
 207   <span class="k">if</span> <span class="s">(</span><span class="i">$Hours</span> &lt; <span class="n">12</span><span class="s">)</span> <span class="s">{</span>
 208     <span class="i">$TimeSuffix</span> = <span class="q">&#39;AM&#39;</span><span class="sc">;</span>
 209   <span class="s">}</span>
 210   <span class="k">elsif</span> <span class="s">(</span><span class="i">$Hours</span> &gt; <span class="n">12</span><span class="s">)</span> <span class="s">{</span>
 211     <span class="i">$TimeSuffix</span> = <span class="q">&#39;PM&#39;</span><span class="sc">;</span>
 212     <span class="i">$Hours</span> = <span class="i">$Hours</span> - <span class="n">12</span><span class="sc">;</span>
 213   <span class="s">}</span>
 214   <span class="k">elsif</span> <span class="s">(</span><span class="i">$Hours</span> == <span class="n">12</span> &amp;&amp; <span class="s">(</span><span class="i">$Mins</span> &gt; <span class="n">0</span> || <span class="i">$Secs</span> &gt; <span class="n">0</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
 215     <span class="i">$TimeSuffix</span> = <span class="q">&#39;PM&#39;</span><span class="sc">;</span>
 216   <span class="s">}</span>
 217   <span class="k">elsif</span> <span class="s">(</span><span class="i">$Hours</span> == <span class="n">12</span> &amp;&amp; <span class="i">$Mins</span> == <span class="n">0</span> &amp;&amp; <span class="i">$Secs</span> == <span class="n">0</span><span class="s">)</span> <span class="s">{</span>
 218     <span class="i">$TimeSuffix</span> = <span class="q">&#39;Noon&#39;</span><span class="sc">;</span>
 219   <span class="s">}</span>
 220 
 221   <span class="i">$Month</span> = <span class="i">TextUtil::AddNumberSuffix</span><span class="s">(</span><span class="i">$Month</span><span class="s">)</span><span class="sc">;</span>
 222 
 223   <span class="i">$TimeString</span> = <span class="q">&quot;${DayName} ${Hours}:${Mins}:${Secs} ${TimeSuffix}&quot;</span><span class="sc">;</span>
 224   <span class="i">$DateString</span> = <span class="q">&quot;${MonthName} ${Month}, ${Year}&quot;</span><span class="sc">;</span>
 225 
 226   <span class="k">return</span> <span class="s">(</span><span class="i">$TimeString</span><span class="cm">,</span> <span class="i">$DateString</span><span class="s">)</span><span class="sc">;</span>
 227 <span class="s">}</span>
 228 
 229 <span class="c"># File modifcation time and date...</span>
<a name="FileModificationTimeAndDate-"></a> 230 <span class="k">sub </span><span class="m">FileModificationTimeAndDate</span> <span class="s">{</span>
 231   <span class="k">my</span><span class="s">(</span><span class="i">$FileName</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 232   <span class="k">my</span><span class="s">(</span><span class="i">$Hours</span><span class="cm">,</span> <span class="i">$Mins</span><span class="cm">,</span> <span class="i">$Secs</span><span class="cm">,</span> <span class="i">$DayName</span><span class="cm">,</span> <span class="i">$MonthName</span><span class="cm">,</span> <span class="i">$Month</span><span class="cm">,</span> <span class="i">$Year</span><span class="s">)</span> = <span class="s">(</span><span class="q">&#39;&#39;</span><span class="s">)</span> x <span class="n">7</span><span class="sc">;</span>
 233 
 234   <span class="k">if</span> <span class="s">(</span>! <span class="k">-e</span> <span class="i">$FileName</span><span class="s">)</span> <span class="s">{</span>
 235     <span class="k">return</span> <span class="s">(</span><span class="i">$Hours</span><span class="cm">,</span> <span class="i">$Mins</span><span class="cm">,</span> <span class="i">$Secs</span><span class="cm">,</span> <span class="i">$DayName</span><span class="cm">,</span> <span class="i">$MonthName</span><span class="cm">,</span> <span class="i">$Month</span><span class="cm">,</span> <span class="i">$Year</span><span class="s">)</span><span class="sc">;</span>
 236   <span class="s">}</span>
 237 
 238   <span class="k">my</span><span class="s">(</span><span class="i">$CTimeString</span><span class="cm">,</span> <span class="i">$FileStatRef</span><span class="cm">,</span> <span class="i">$TimeStamp</span><span class="s">)</span><span class="sc">;</span>
 239   <span class="i">$FileStatRef</span> = <span class="k">stat</span><span class="s">(</span><span class="i">$FileName</span><span class="s">)</span><span class="sc">;</span>
 240 
 241   <span class="i">$CTimeString</span> = <span class="i">Time::localtime::ctime</span><span class="s">(</span><span class="i">$FileStatRef</span><span class="i">-&gt;mtime</span><span class="s">)</span><span class="sc">;</span>
 242 
 243   <span class="c"># ctime returns: Thu Aug 3 10:13:53 2006</span>
 244   <span class="s">(</span><span class="i">$DayName</span><span class="cm">,</span> <span class="i">$MonthName</span><span class="cm">,</span> <span class="i">$Month</span><span class="cm">,</span> <span class="i">$TimeStamp</span><span class="cm">,</span> <span class="i">$Year</span><span class="s">)</span> = <span class="k">split</span> <span class="q">/[ ]+/</span><span class="cm">,</span> <span class="i">$CTimeString</span><span class="sc">;</span>
 245   <span class="s">(</span><span class="i">$Hours</span><span class="cm">,</span> <span class="i">$Mins</span><span class="cm">,</span> <span class="i">$Secs</span><span class="s">)</span> = <span class="k">split</span> <span class="q">/\:/</span><span class="cm">,</span> <span class="i">$TimeStamp</span><span class="sc">;</span>
 246 
 247   <span class="k">return</span> <span class="s">(</span><span class="i">$Hours</span><span class="cm">,</span> <span class="i">$Mins</span><span class="cm">,</span> <span class="i">$Secs</span><span class="cm">,</span> <span class="i">$DayName</span><span class="cm">,</span> <span class="i">$MonthName</span><span class="cm">,</span> <span class="i">$Month</span><span class="cm">,</span> <span class="i">$Year</span><span class="s">)</span><span class="sc">;</span>
 248 <span class="s">}</span>
 249 
 250 <span class="c"># Format file size...</span>
<a name="FormatFileSize-"></a> 251 <span class="k">sub </span><span class="m">FormatFileSize</span> <span class="s">{</span>
 252   <span class="k">my</span><span class="s">(</span><span class="i">$Precision</span><span class="cm">,</span> <span class="i">$Size</span><span class="s">)</span><span class="sc">;</span>
 253 
 254   <span class="i">$Precision</span> = <span class="n">1</span><span class="sc">;</span>
 255   <span class="k">if</span> <span class="s">(</span><span class="i">@_</span> == <span class="n">2</span><span class="s">)</span> <span class="s">{</span>
 256     <span class="s">(</span><span class="i">$Size</span><span class="cm">,</span> <span class="i">$Precision</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 257   <span class="s">}</span>
 258   <span class="k">else</span> <span class="s">{</span>
 259     <span class="s">(</span><span class="i">$Size</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 260   <span class="s">}</span>
 261   <span class="k">my</span><span class="s">(</span><span class="i">$SizeDenominator</span><span class="cm">,</span> <span class="i">$SizeSuffix</span><span class="s">)</span><span class="sc">;</span>
 262   <span class="j">FORMAT:</span> <span class="s">{</span>
 263       <span class="k">if</span> <span class="s">(</span><span class="i">$Size</span> &lt; <span class="n">1024</span><span class="s">)</span> <span class="s">{</span> <span class="i">$SizeDenominator</span> = <span class="n">1</span><span class="sc">;</span> <span class="i">$SizeSuffix</span> = <span class="q">&#39;bytes&#39;</span><span class="sc">;</span> <span class="k">last</span> <span class="j">FORMAT</span><span class="sc">;</span><span class="s">}</span>
 264       <span class="k">if</span> <span class="s">(</span><span class="i">$Size</span> &lt; <span class="s">(</span><span class="n">1024</span>*<span class="n">1024</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span> <span class="i">$SizeDenominator</span> = <span class="n">1024</span><span class="sc">;</span> <span class="i">$SizeSuffix</span> = <span class="q">&#39;KB&#39;</span><span class="sc">;</span> <span class="k">last</span> <span class="j">FORMAT</span><span class="sc">;</span><span class="s">}</span>
 265       <span class="k">if</span> <span class="s">(</span><span class="i">$Size</span> &lt; <span class="s">(</span><span class="n">1024</span>*<span class="n">1024</span>*<span class="n">1024</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span> <span class="i">$SizeDenominator</span> = <span class="n">1024</span>*<span class="n">1024</span><span class="sc">;</span> <span class="i">$SizeSuffix</span> = <span class="q">&#39;MB&#39;</span><span class="sc">;</span> <span class="k">last</span> <span class="j">FORMAT</span><span class="sc">;</span><span class="s">}</span>
 266       <span class="k">if</span> <span class="s">(</span><span class="i">$Size</span> &lt; <span class="s">(</span><span class="n">1024</span>*<span class="n">1024</span>*<span class="n">1024</span>*<span class="n">1024</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span> <span class="i">$SizeDenominator</span> = <span class="n">1024</span>*<span class="n">1024</span>*<span class="n">1024</span><span class="sc">;</span> <span class="i">$SizeSuffix</span> = <span class="q">&#39;GB&#39;</span><span class="sc">;</span> <span class="k">last</span> <span class="j">FORMAT</span><span class="sc">;</span><span class="s">}</span>
 267       <span class="i">$SizeDenominator</span> = <span class="n">1</span><span class="sc">;</span> <span class="i">$SizeSuffix</span> = <span class="q">&#39;bytes&#39;</span><span class="sc">;</span>
 268     <span class="s">}</span>
 269   <span class="i">$Size</span> /= <span class="i">$SizeDenominator</span><span class="sc">;</span>
 270   <span class="i">$Size</span> = <span class="k">sprintf</span><span class="s">(</span><span class="q">&quot;%.${Precision}f&quot;</span><span class="cm">,</span> <span class="i">$Size</span><span class="s">)</span> + <span class="n">0</span><span class="sc">;</span>
 271   <span class="i">$Size</span> = <span class="q">&quot;$Size $SizeSuffix&quot;</span><span class="sc">;</span>
 272 
 273   <span class="k">return</span> <span class="i">$Size</span><span class="sc">;</span>
 274 <span class="s">}</span>
 275 
 276 <span class="c"># Get file size in bytes...</span>
<a name="FileSize-"></a> 277 <span class="k">sub </span><span class="m">FileSize</span> <span class="s">{</span>
 278   <span class="k">my</span><span class="s">(</span><span class="i">$File</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 279 
 280   <span class="k">if</span> <span class="s">(</span>! <span class="k">-e</span> <span class="i">$File</span><span class="s">)</span> <span class="s">{</span>
 281     <span class="k">return</span> <span class="k">undef</span><span class="sc">;</span>
 282   <span class="s">}</span>
 283   <span class="k">return</span> <span class="s">(</span><span class="k">-s</span> <span class="i">$File</span><span class="s">)</span>
 284 <span class="s">}</span>
 285 
 286 <span class="c"># Get MayaChemTool&#39;s lib directory name using @INC to extract</span>
 287 <span class="c"># &lt;MAYACHEMTOOLS&gt;/lib directory location: first entry in @INC path should contain</span>
 288 <span class="c"># MayaChemTools modules location</span>
 289 <span class="c">#</span>
<a name="GetMayaChemToolsLibDirName-"></a> 290 <span class="k">sub </span><span class="m">GetMayaChemToolsLibDirName</span> <span class="s">{</span>
 291 
 292   <span class="k">if</span> <span class="s">(</span><span class="k">defined</span> <span class="i">$MayaChemToolsLibDir</span><span class="s">)</span> <span class="s">{</span>
 293     <span class="k">return</span> <span class="i">$MayaChemToolsLibDir</span><span class="sc">;</span>
 294   <span class="s">}</span>
 295 
 296   <span class="i">$MayaChemToolsLibDir</span> = <span class="q">&quot;&quot;</span><span class="sc">;</span>
 297   <span class="k">if</span> <span class="s">(</span><span class="i">$INC</span>[<span class="n">0</span>] =~ <span class="q">/MayaChemTools/i</span><span class="s">)</span> <span class="s">{</span>
 298     <span class="i">$MayaChemToolsLibDir</span> = <span class="i">$INC</span>[<span class="n">0</span>]<span class="sc">;</span>
 299   <span class="s">}</span>
 300   <span class="k">else</span> <span class="s">{</span>
 301     <span class="c"># Go through rest of the entries...</span>
 302     <span class="k">my</span><span class="s">(</span><span class="i">$Index</span><span class="s">)</span><span class="sc">;</span>
 303     <span class="j">INDEX:</span> <span class="k">for</span> <span class="i">$Index</span> <span class="s">(</span><span class="n">1</span> .. <span class="i">$#INC</span><span class="s">)</span> <span class="s">{</span>
 304       <span class="k">if</span> <span class="s">(</span><span class="i">$INC</span>[<span class="i">$Index</span>] =~ <span class="q">/MayaChemTools/i</span><span class="s">)</span> <span class="s">{</span>
 305         <span class="i">$MayaChemToolsLibDir</span> = <span class="i">$INC</span>[<span class="i">$Index</span>]<span class="sc">;</span>
 306         <span class="k">last</span> <span class="j">INDEX</span><span class="sc">;</span>
 307       <span class="s">}</span>
 308     <span class="s">}</span>
 309     <span class="k">if</span> <span class="s">(</span>!<span class="i">$MayaChemToolsLibDir</span><span class="s">)</span> <span class="s">{</span>
 310       <span class="w">carp</span> <span class="q">&quot;Warning: MayaChemTools lib directory location doesn&#39;t appear to exist in library search path specified by \@INC ...&quot;</span><span class="sc">;</span>
 311     <span class="s">}</span>
 312   <span class="s">}</span>
 313   <span class="k">return</span> <span class="i">$MayaChemToolsLibDir</span><span class="sc">;</span>
 314 <span class="s">}</span>
 315 
 316 <span class="c"># Get Usage from Pod...</span>
<a name="GetUsageFromPod-"></a> 317 <span class="k">sub </span><span class="m">GetUsageFromPod</span> <span class="s">{</span>
 318   <span class="k">my</span><span class="s">(</span><span class="i">$Usage</span><span class="cm">,</span> <span class="i">$ScriptPath</span><span class="s">)</span><span class="sc">;</span>
 319 
 320   <span class="s">(</span><span class="i">$ScriptPath</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 321   <span class="i">$Usage</span> = <span class="q">&quot;Script usage not available: pod2text or pod2text.bat doesn&#39;t exist in your Perl installation and direct invocation of Pod::Text also failed\n&quot;</span><span class="sc">;</span>
 322 
 323   <span class="c"># Get pod documentation: try pod2text first followed by perdoc.bat in case it fails to</span>
 324   <span class="c"># to handle ActiveState Perl...</span>
 325   <span class="k">my</span><span class="s">(</span><span class="i">$PodStatus</span><span class="s">)</span><span class="sc">;</span>
 326   <span class="i">$PodStatus</span> = <span class="s">(</span><span class="k">open</span> <span class="w">CMD</span><span class="cm">,</span> <span class="q">&quot;pod2text $ScriptPath|&quot;</span><span class="s">)</span> ? <span class="n">1</span> <span class="co">:</span> <span class="s">(</span><span class="s">(</span><span class="k">open</span> <span class="w">CMD</span><span class="cm">,</span> <span class="q">&quot;pod2text.bat $ScriptPath|&quot;</span><span class="s">)</span> ? <span class="n">1</span> <span class="co">:</span> <span class="n">0</span><span class="s">)</span><span class="sc">;</span>
 327   <span class="k">if</span> <span class="s">(</span>!<span class="i">$PodStatus</span><span class="s">)</span> <span class="s">{</span>
 328     <span class="c"># Try direct invocation of Pod::Text before giving up...</span>
 329     <span class="k">my</span><span class="s">(</span><span class="i">$PodTextCmd</span><span class="s">)</span><span class="sc">;</span>
 330     <span class="i">$PodTextCmd</span> = <span class="q">&quot;perl -e \&#39;use Pod::Text (); \$TextFormatter = Pod::Text-&gt;new(); \$TextFormatter-&gt;parse_from_file(\&quot;$ScriptPath\&quot;);\&#39;&quot;</span><span class="sc">;</span>
 331     <span class="i">$PodStatus</span> = <span class="s">(</span><span class="k">open</span> <span class="w">CMD</span><span class="cm">,</span> <span class="q">&quot;$PodTextCmd|&quot;</span><span class="s">)</span> ? <span class="n">1</span> <span class="co">:</span> <span class="n">0</span><span class="sc">;</span>
 332     <span class="k">if</span> <span class="s">(</span>!<span class="i">$PodStatus</span><span class="s">)</span> <span class="s">{</span>
 333       <span class="k">return</span> <span class="i">$Usage</span><span class="sc">;</span>
 334     <span class="s">}</span>
 335   <span class="s">}</span>
 336   <span class="k">my</span><span class="s">(</span><span class="i">$ProcessingSection</span><span class="cm">,</span> <span class="i">$InParametersSection</span><span class="cm">,</span> <span class="i">$InOptionsSection</span><span class="cm">,</span> <span class="i">@LineWords</span><span class="s">)</span><span class="sc">;</span>
 337   <span class="i">$ProcessingSection</span> = <span class="n">0</span><span class="sc">;</span> <span class="i">$InParametersSection</span> = <span class="n">0</span><span class="sc">;</span> <span class="i">$InOptionsSection</span> = <span class="n">0</span><span class="sc">;</span>
 338   <span class="j">PODLINE:</span> <span class="k">while</span> <span class="s">(</span><span class="q">&lt;CMD&gt;</span><span class="s">)</span> <span class="s">{</span>
 339     <span class="k">if</span> <span class="s">(</span><span class="q">/^SYNOPSIS/</span><span class="s">)</span> <span class="s">{</span>
 340       <span class="i">$_</span> = <span class="q">&lt;CMD&gt;</span><span class="sc">;</span> <span class="k">chomp</span><span class="sc">;</span> <span class="q">s/^ +//g</span><span class="sc">;</span>
 341       <span class="s">(</span><span class="i">@LineWords</span><span class="s">)</span> = <span class="k">split</span> <span class="q">/ /</span><span class="sc">;</span>
 342       <span class="i">$Usage</span> = <span class="q">qq(Usage: $LineWords[0] [-options]... )</span><span class="sc">;</span>
 343       <span class="k">shift</span> <span class="i">@LineWords</span><span class="sc">;</span>
 344       <span class="i">$Usage</span> .= <span class="k">join</span><span class="s">(</span><span class="q">&quot; &quot;</span><span class="cm">,</span> <span class="i">@LineWords</span><span class="s">)</span> . <span class="q">&quot;\n&quot;</span><span class="sc">;</span>
 345     <span class="s">}</span>
 346     <span class="k">elsif</span> <span class="s">(</span><span class="q">/^(DESCRIPTION|PARAMETERS|OPTIONS|EXAMPLES|AUTHOR|SEE ALSO|COPYRIGHT)/i</span><span class="s">)</span> <span class="s">{</span>
 347       <span class="c"># Various sections...</span>
 348       <span class="k">chomp</span><span class="sc">;</span>
 349       <span class="i">$Usage</span> .= <span class="k">ucfirst</span><span class="s">(</span><span class="k">lc</span><span class="s">(</span><span class="i">$_</span><span class="s">)</span><span class="s">)</span> . <span class="q">&quot;:\n&quot;</span><span class="sc">;</span>
 350       <span class="i">$ProcessingSection</span> = <span class="n">1</span><span class="sc">;</span>
 351       <span class="i">$InOptionsSection</span> = <span class="q">/^OPTIONS/</span> ? <span class="n">1</span> <span class="co">:</span> <span class="n">0</span><span class="sc">;</span>
 352       <span class="i">$InParametersSection</span> = <span class="q">/^PARAMETERS/</span> ? <span class="n">1</span> <span class="co">:</span> <span class="n">0</span><span class="sc">;</span>
 353     <span class="s">}</span>
 354     <span class="k">elsif</span> <span class="s">(</span><span class="i">$InParametersSection</span>|<span class="i">$InOptionsSection</span><span class="s">)</span> <span class="s">{</span>
 355       <span class="k">if</span> <span class="s">(</span><span class="q">/^[ ]+\-/</span> || <span class="q">/^[ ]{4,4}/</span><span class="s">)</span> <span class="s">{</span>
 356         <span class="c"># Start of option line: any number of spaces followed by - sign.</span>
 357         <span class="c"># Put back in &lt;&gt; which pod2text replaced to **</span>
 358         <span class="k">my</span><span class="s">(</span><span class="i">$OptionLine</span><span class="s">)</span> = <span class="q">qq($_)</span><span class="sc">;</span>
 359            <span class="j">OPTIONLINE:</span> <span class="k">while</span> <span class="s">(</span><span class="q">&lt;CMD&gt;</span><span class="s">)</span> <span class="s">{</span>
 360           <span class="k">if</span> <span class="s">(</span><span class="q">/^(    )/</span><span class="s">)</span> <span class="s">{</span>
 361             <span class="i">$OptionLine</span> .= <span class="q">qq($_)</span><span class="sc">;</span>
 362           <span class="s">}</span>
 363           <span class="k">else</span> <span class="s">{</span>
 364             <span class="i">$OptionLine</span> =~ <span class="q">s/\*(([a-zA-Z0-9])|(\[)|(\#)|(\&quot;))/&quot;\&lt;&quot; . substr($&amp;, -1, 1)/e</span><span class="sc">;</span>
 365             <span class="i">$OptionLine</span> =~ <span class="q">s/(([a-zA-Z0-9])|(\])|(\#)|(\&quot;))\*/substr($&amp;, 0, 1) . &quot;\&gt;&quot;/e</span><span class="sc">;</span>
 366             <span class="i">$Usage</span> .= <span class="q">qq($OptionLine$_)</span><span class="sc">;</span>
 367             <span class="k">last</span> <span class="j">OPTIONLINE</span><span class="sc">;</span>
 368           <span class="s">}</span>
 369         <span class="s">}</span>
 370       <span class="s">}</span>
 371     <span class="s">}</span>
 372     <span class="k">else</span> <span class="s">{</span>
 373       <span class="k">if</span> <span class="s">(</span><span class="i">$ProcessingSection</span><span class="s">)</span> <span class="s">{</span> <span class="i">$Usage</span> .= <span class="q">qq($_)</span><span class="sc">;</span> <span class="s">}</span>
 374     <span class="s">}</span>
 375   <span class="s">}</span>
 376   <span class="k">close</span> <span class="w">CMD</span><span class="sc">;</span>
 377 
 378   <span class="c"># Take out **which pod2text puts in for &lt;&gt;</span>
 379   <span class="i">$Usage</span> =~ <span class="q">s/\*(([a-zA-Z0-9;#-])|(\&quot;)|(\()|(\[)|(\.))/substr($&amp;, -1, 1)/eg</span><span class="sc">;</span>
 380   <span class="i">$Usage</span> =~ <span class="q">s/(([a-zA-Z0-9;#-])|(\&quot;)|(\))|(\])|(\.))\*/substr($&amp;, 0, 1)/eg</span><span class="sc">;</span>
 381 
 382   <span class="k">return</span> <span class="i">$Usage</span><span class="sc">;</span>
 383 <span class="s">}</span>
 384 
 385 <span class="c"># Split full file name into directory path, file name, and the extension.</span>
<a name="ParseFileName-"></a> 386 <span class="k">sub </span><span class="m">ParseFileName</span> <span class="s">{</span>
 387   <span class="k">my</span><span class="s">(</span><span class="i">$FullName</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 388   <span class="k">my</span><span class="s">(</span><span class="i">$FileDir</span><span class="cm">,</span> <span class="i">$FileName</span><span class="cm">,</span> <span class="i">$FileExt</span><span class="cm">,</span> <span class="i">@FullFileNameParts</span><span class="cm">,</span> <span class="i">@FileNameParts</span><span class="cm">,</span> <span class="i">$Delimiter</span><span class="s">)</span><span class="sc">;</span>
 389 
 390   <span class="i">$Delimiter</span> = <span class="q">&quot;\/&quot;</span><span class="sc">;</span>
 391   <span class="k">if</span> <span class="s">(</span><span class="i">$FullName</span> =~ <span class="q">/\\/</span> <span class="s">)</span> <span class="s">{</span>
 392     <span class="i">$Delimiter</span> = <span class="q">&quot;\\&quot;</span><span class="sc">;</span>
 393     <span class="i">$FullName</span> =~ <span class="q">s/\\/\//g</span><span class="sc">;</span>
 394   <span class="s">}</span>
 395   <span class="i">$FileDir</span> = <span class="q">&quot;&quot;</span><span class="sc">;</span> <span class="i">$FileName</span> = <span class="q">&quot;&quot;</span><span class="sc">;</span> <span class="i">$FileExt</span> = <span class="q">&quot;&quot;</span><span class="sc">;</span>
 396   <span class="i">@FullFileNameParts</span> = <span class="s">(</span><span class="s">)</span><span class="sc">;</span> <span class="i">@FileNameParts</span> = <span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 397 
 398   <span class="i">@FullFileNameParts</span> = <span class="k">split</span> <span class="q">&quot;\/&quot;</span><span class="cm">,</span> <span class="i">$FullName</span><span class="sc">;</span>
 399   <span class="i">@FileNameParts</span> = <span class="k">split</span> <span class="q">/\./</span><span class="cm">,</span> <span class="i">$FullFileNameParts</span>[<span class="i">$#FullFileNameParts</span>]<span class="sc">;</span>
 400 
 401   <span class="c"># Setup file dir...</span>
 402   <span class="k">if</span> <span class="s">(</span><span class="i">@FullFileNameParts</span> == <span class="n">1</span><span class="s">)</span> <span class="s">{</span>
 403     <span class="i">$FileDir</span> = <span class="q">&quot;\.&quot;</span><span class="sc">;</span>
 404   <span class="s">}</span>
 405   <span class="k">else</span> <span class="s">{</span>
 406     <span class="k">pop</span> <span class="i">@FullFileNameParts</span><span class="sc">;</span>
 407     <span class="i">$FileDir</span> = <span class="k">join</span> <span class="i">$Delimiter</span><span class="cm">,</span> <span class="i">@FullFileNameParts</span><span class="sc">;</span>
 408   <span class="s">}</span>
 409 
 410   <span class="c"># Setup file name and ext...</span>
 411   <span class="k">if</span> <span class="s">(</span><span class="i">@FileNameParts</span> == <span class="n">1</span><span class="s">)</span> <span class="s">{</span>
 412     <span class="i">$FileName</span> = <span class="i">$FileNameParts</span>[<span class="n">0</span>]<span class="sc">;</span>
 413     <span class="i">$FileExt</span> = <span class="q">&quot;&quot;</span><span class="sc">;</span>
 414   <span class="s">}</span>
 415   <span class="k">elsif</span> <span class="s">(</span><span class="i">@FileNameParts</span> == <span class="n">2</span><span class="s">)</span> <span class="s">{</span>
 416     <span class="i">$FileName</span> = <span class="i">$FileNameParts</span>[<span class="n">0</span>]<span class="sc">;</span>
 417     <span class="i">$FileExt</span> = <span class="i">$FileNameParts</span>[<span class="n">1</span>]<span class="sc">;</span>
 418   <span class="s">}</span>
 419   <span class="k">elsif</span> <span class="s">(</span><span class="i">@FileNameParts</span> &gt; <span class="n">2</span><span class="s">)</span> <span class="s">{</span>
 420     <span class="c"># Use the last entry as file extension and the rest for file name...</span>
 421     <span class="i">$FileExt</span> = <span class="i">$FileNameParts</span>[<span class="i">$#FileNameParts</span>]<span class="sc">;</span>
 422     <span class="k">pop</span> <span class="i">@FileNameParts</span><span class="sc">;</span>
 423     <span class="i">$FileName</span> = <span class="k">join</span> <span class="q">&#39;.&#39;</span><span class="cm">,</span> <span class="i">@FileNameParts</span><span class="sc">;</span>
 424   <span class="s">}</span>
 425   <span class="k">return</span> <span class="s">(</span><span class="i">$FileDir</span><span class="cm">,</span> <span class="i">$FileName</span><span class="cm">,</span> <span class="i">$FileExt</span><span class="s">)</span><span class="sc">;</span>
 426 <span class="s">}</span>
 427 
<a name="EOF-"></a></pre>
<p>&nbsp;</p>
<br />
<center>
<img src="../../../images/h2o2.png">
</center>
</body>
</html>
