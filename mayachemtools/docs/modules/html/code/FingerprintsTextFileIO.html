<html>
<head>
<title>MayaChemTools:Code:FileIO::FingerprintsTextFileIO.pm</title>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<link rel="stylesheet" type="text/css" href="../../../css/MayaChemToolsCode.css">
</head>
<body leftmargin="20" rightmargin="20" topmargin="10" bottommargin="10">
<br/>
<center>
<a href="http://www.mayachemtools.org" title="MayaChemTools Home"><img src="../../../images/MayaChemToolsLogo.gif" border="0" alt="MayaChemTools"></a>
</center>
<br/>
<pre>
<a name="package-FileIO::FingerprintsTextFileIO-"></a>   1 <span class="k">package </span><span class="i">FileIO::FingerprintsTextFileIO</span><span class="sc">;</span>
   2 <span class="c">#</span>
   3 <span class="c"># $RCSfile: FingerprintsTextFileIO.pm,v $</span>
   4 <span class="c"># $Date: 2017/01/12 18:59:14 $</span>
   5 <span class="c"># $Revision: 1.21 $</span>
   6 <span class="c">#</span>
   7 <span class="c"># Author: Manish Sud &lt;msud@san.rr.com&gt;</span>
   8 <span class="c">#</span>
   9 <span class="c"># Copyright (C) 2017 Manish Sud. All rights reserved.</span>
  10 <span class="c">#</span>
  11 <span class="c"># This file is part of MayaChemTools.</span>
  12 <span class="c">#</span>
  13 <span class="c"># MayaChemTools is free software; you can redistribute it and/or modify it under</span>
  14 <span class="c"># the terms of the GNU Lesser General Public License as published by the Free</span>
  15 <span class="c"># Software Foundation; either version 3 of the License, or (at your option) any</span>
  16 <span class="c"># later version.</span>
  17 <span class="c">#</span>
  18 <span class="c"># MayaChemTools is distributed in the hope that it will be useful, but without</span>
  19 <span class="c"># any warranty; without even the implied warranty of merchantability of fitness</span>
  20 <span class="c"># for a particular purpose.  See the GNU Lesser General Public License for more</span>
  21 <span class="c"># details.</span>
  22 <span class="c">#</span>
  23 <span class="c"># You should have received a copy of the GNU Lesser General Public License</span>
  24 <span class="c"># along with MayaChemTools; if not, see &lt;http://www.gnu.org/licenses/&gt; or</span>
  25 <span class="c"># write to the Free Software Foundation Inc., 59 Temple Place, Suite 330,</span>
  26 <span class="c"># Boston, MA, 02111-1307, USA.</span>
  27 <span class="c">#</span>
  28 
  29 <span class="k">use</span> <span class="w">strict</span><span class="sc">;</span>
  30 <span class="k">use</span> <span class="w">Carp</span><span class="sc">;</span>
  31 <span class="k">use</span> <span class="w">Exporter</span><span class="sc">;</span>
  32 <span class="k">use</span> <span class="w">Scalar::Util</span> <span class="s">(</span><span class="s">)</span><span class="sc">;</span>
  33 <span class="k">use</span> <span class="w">TextUtil</span> <span class="s">(</span><span class="s">)</span><span class="sc">;</span>
  34 <span class="k">use</span> <span class="w">FileUtil</span> <span class="s">(</span><span class="s">)</span><span class="sc">;</span>
  35 <span class="k">use</span> <span class="w">Fingerprints::FingerprintsStringUtil</span> <span class="s">(</span><span class="s">)</span><span class="sc">;</span>
  36 <span class="k">use</span> <span class="w">FileIO::FileIO</span><span class="sc">;</span>
  37 
  38 <span class="k">use</span> <span class="w">vars</span> <span class="q">qw(@ISA @EXPORT @EXPORT_OK %EXPORT_TAGS)</span><span class="sc">;</span>
  39 
  40 <span class="i">@ISA</span> = <span class="q">qw(FileIO::FileIO Exporter)</span><span class="sc">;</span>
  41 <span class="i">@EXPORT</span> = <span class="q">qw()</span><span class="sc">;</span>
  42 <span class="i">@EXPORT_OK</span> = <span class="q">qw(IsFingerprintsTextFile)</span><span class="sc">;</span>
  43 
  44 <span class="i">%EXPORT_TAGS</span> = <span class="s">(</span><span class="w">all</span>  <span class="cm">=&gt;</span> <span class="s">[</span><span class="i">@EXPORT</span><span class="cm">,</span> <span class="i">@EXPORT_OK</span><span class="s">]</span><span class="s">)</span><span class="sc">;</span>
  45 
  46 <span class="c"># Setup class variables...</span>
  47 <span class="k">my</span><span class="s">(</span><span class="i">$ClassName</span><span class="s">)</span><span class="sc">;</span>
  48 <span class="i">_InitializeClass</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
  49 
  50 <span class="c"># Class constructor...</span>
<a name="new-"></a>  51 <span class="k">sub </span><span class="m">new</span> <span class="s">{</span>
  52   <span class="k">my</span><span class="s">(</span><span class="i">$Class</span><span class="cm">,</span> <span class="i">%NamesAndValues</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
  53 
  54   <span class="c"># Initialize object...</span>
  55   <span class="k">my</span> <span class="i">$This</span> = <span class="i">$Class</span><span class="i">-&gt;SUPER::new</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
  56   <span class="k">bless</span> <span class="i">$This</span><span class="cm">,</span> <span class="k">ref</span><span class="s">(</span><span class="i">$Class</span><span class="s">)</span> || <span class="i">$Class</span><span class="sc">;</span>
  57   <span class="i">$This</span><span class="i">-&gt;_InitializeFingerprintsTextFileIO</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
  58 
  59   <span class="i">$This</span><span class="i">-&gt;_InitializeFingerprintsTextFileIOProperties</span><span class="s">(</span><span class="i">%NamesAndValues</span><span class="s">)</span><span class="sc">;</span>
  60 
  61   <span class="k">return</span> <span class="i">$This</span><span class="sc">;</span>
  62 <span class="s">}</span>
  63 
  64 <span class="c"># Initialize object data...</span>
  65 <span class="c">#</span>
<a name="_InitializeFingerprintsTextFileIO-"></a>  66 <span class="k">sub </span><span class="m">_InitializeFingerprintsTextFileIO</span> <span class="s">{</span>
  67   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
  68 
  69   <span class="c"># Fingerprints string data format during read/write...</span>
  70   <span class="c">#</span>
  71   <span class="c"># For file read:</span>
  72   <span class="c">#</span>
  73   <span class="c"># AutoDetect  - automatically detect format of fingerprints string</span>
  74   <span class="c"># FingerprintsBitVectorString - Bit vector fingerprints string format</span>
  75   <span class="c"># FingerprintsVectorString - Vector fingerprints string format</span>
  76   <span class="c">#</span>
  77   <span class="c"># Default value: AutoDetect</span>
  78   <span class="c">#</span>
  79   <span class="c"># For file write:</span>
  80   <span class="c">#</span>
  81   <span class="c"># FingerprintsBitVectorString - Bit vector fingerprints string format</span>
  82   <span class="c"># FingerprintsVectorString - Vector fingerprints string format</span>
  83   <span class="c">#</span>
  84   <span class="c"># Default value: undef</span>
  85   <span class="c">#</span>
  86   <span class="i">$This</span>-&gt;{<span class="w">FingerprintsStringMode</span>} = <span class="k">undef</span><span class="sc">;</span>
  87 
  88   <span class="c"># For file read:</span>
  89   <span class="c">#</span>
  90   <span class="c">#   o Fingerprints bit-vector and vector object for current fingerprints string</span>
  91   <span class="c">#</span>
  92   <span class="c"># For file write:</span>
  93   <span class="c">#</span>
  94   <span class="c">#   o Fingerprints bit-vector and vector object for current fingerprints string</span>
  95   <span class="c">#   o Any supported fingerprints object: PathLengthFingerprints, ExtendedConnectivity, and so on.</span>
  96   <span class="c">#</span>
  97   <span class="i">$This</span>-&gt;{<span class="w">FingerprintsObject</span>} = <span class="k">undef</span><span class="sc">;</span>
  98 
  99   <span class="c"># Fingepritns string for current line during read/write...</span>
 100   <span class="i">$This</span>-&gt;{<span class="w">FingerprintsString</span>} = <span class="k">undef</span><span class="sc">;</span>
 101 
 102   <span class="c"># First data line read/write...</span>
 103   <span class="i">$This</span>-&gt;{<span class="w">FirstDataLineIO</span>} = <span class="n">1</span><span class="sc">;</span>
 104 
 105   <span class="c"># Current fingerprints string data line number during read/write...</span>
 106   <span class="i">$This</span>-&gt;{<span class="w">LineNum</span>} = <span class="n">0</span><span class="sc">;</span>
 107 
 108   <span class="c"># Text line data during read/write...</span>
 109   <span class="i">$This</span>-&gt;{<span class="w">DataLine</span>} = <span class="k">undef</span><span class="sc">;</span>
 110   <span class="i">@</span>{<span class="i">$This</span>-&gt;{<span class="w">DataLineWords</span>}} = <span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 111 
 112   <span class="c"># Text file column data during read/write...</span>
 113   <span class="i">@</span>{<span class="i">$This</span>-&gt;{<span class="w">DataColLabels</span>}} = <span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 114 
 115   <span class="c"># Text file delimiter during read/write...</span>
 116   <span class="i">$This</span>-&gt;{<span class="w">Delim</span>} = <span class="q">&#39;&#39;</span><span class="sc">;</span>
 117 
 118   <span class="c"># Initialize parameters for read...</span>
 119   <span class="i">$This</span><span class="i">-&gt;_InitializeFingerprintsTextFileIORead</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 120 
 121   <span class="c"># Initialize parameters for write...</span>
 122   <span class="i">$This</span><span class="i">-&gt;_InitializeFingerprintsTextFileIOWrite</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 123 
 124   <span class="k">return</span> <span class="i">$This</span><span class="sc">;</span>
 125 <span class="s">}</span>
 126 
 127 <span class="c"># Initialize class ...</span>
<a name="_InitializeClass-"></a> 128 <span class="k">sub </span><span class="m">_InitializeClass</span> <span class="s">{</span>
 129   <span class="c">#Class name...</span>
 130   <span class="i">$ClassName</span> = <span class="w">__PACKAGE__</span><span class="sc">;</span>
 131 
 132 <span class="s">}</span>
 133 
 134 <span class="c"># Initialize object data for reading fingerprints text file...</span>
 135 <span class="c">#</span>
<a name="_InitializeFingerprintsTextFileIORead-"></a> 136 <span class="k">sub </span><span class="m">_InitializeFingerprintsTextFileIORead</span> <span class="s">{</span>
 137   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 138 
 139   <span class="c"># Column ID specification for identification of comound ID or fingerints string</span>
 140   <span class="c"># data column...</span>
 141   <span class="c">#</span>
 142   <span class="c"># ColNum - A valid column number</span>
 143   <span class="c"># ColLabel - A valid column name</span>
 144   <span class="c">#</span>
 145   <span class="i">$This</span>-&gt;{<span class="w">ColMode</span>} = <span class="q">&#39;ColNum&#39;</span><span class="sc">;</span>
 146 
 147   <span class="c"># Fingerprints column to use for retrieving fingerprints string data...</span>
 148   <span class="c">#</span>
 149   <span class="c"># Value of AutoDetect implies use first column containing the word  Fingerprints in its</span>
 150   <span class="c"># column label to retrieve fingerprints string data. Othwewise, a valid column number</span>
 151   <span class="c"># or column name must be specified based on the value of ColMode.</span>
 152   <span class="c">#</span>
 153   <span class="i">$This</span>-&gt;{<span class="w">FingerprintsCol</span>} = <span class="q">&#39;AutoDetect&#39;</span><span class="sc">;</span>
 154 
 155   <span class="c"># Compound ID column to use for retrieving compound IDs for fingerprints...</span>
 156   <span class="c">#</span>
 157   <span class="c"># Value of AutoDetect implies use first column containing the word CompoundID in its column</span>
 158   <span class="c"># label to retrieve compound IDs or assign seqyentially generated compound IDs. Othwewise,</span>
 159   <span class="c"># a valid column number or column name must be specified based on the value of ColMode.</span>
 160   <span class="c">#</span>
 161   <span class="i">$This</span>-&gt;{<span class="w">CompoundIDCol</span>} = <span class="q">&#39;AutoDetect&#39;</span><span class="sc">;</span>
 162 
 163   <span class="c"># A prefix string used for generating compound IDs like LabelPrefixString&lt;Number&gt; during</span>
 164   <span class="c"># sequential generation of compound IDs. Default value, Cmpd, generates compound IDs</span>
 165   <span class="c"># which look like like Cmpd&lt;Number&gt;.</span>
 166   <span class="c">#</span>
 167   <span class="i">$This</span>-&gt;{<span class="w">CompoundIDPrefix</span>} = <span class="q">&#39;Cmpd&#39;</span><span class="sc">;</span>
 168 
 169   <span class="c"># Input delimiter for fingerprints CSV text file. Possible values: comma, semicolon or tab. This</span>
 170   <span class="c"># option is ignored for TSV text file and tab is used as the delimiter.</span>
 171   <span class="c">#</span>
 172   <span class="i">$This</span>-&gt;{<span class="w">InDelim</span>} = <span class="q">&#39;comma&#39;</span><span class="sc">;</span>
 173 
 174   <span class="c"># By default, the fingerprints data corresponding to FingerprintsCol is assumed to</span>
 175   <span class="c"># be valid and no validation is performed before generating fingerprints objects...</span>
 176   <span class="c">#</span>
 177   <span class="i">$This</span>-&gt;{<span class="w">ValidateData</span>} = <span class="n">1</span><span class="sc">;</span>
 178 
 179   <span class="c"># Level of detail to print during validation of data for invalid or missing data...</span>
 180   <span class="i">$This</span>-&gt;{<span class="w">DetailLevel</span>} = <span class="n">1</span><span class="sc">;</span>
 181 
 182   <span class="c"># Number of missing and invalid fingerprints string data lines...</span>
 183   <span class="i">$This</span>-&gt;{<span class="w">NumOfLinesWithMissingData</span>} = <span class="n">0</span><span class="sc">;</span>
 184   <span class="i">$This</span>-&gt;{<span class="w">NumOfLinesWithInvalidData</span>} = <span class="n">0</span><span class="sc">;</span>
 185 
 186   <span class="c"># Compound ID for current fingerprints string...</span>
 187   <span class="i">$This</span>-&gt;{<span class="w">CompoundID</span>} = <span class="k">undef</span><span class="sc">;</span>
 188 
 189   <span class="c"># Status of data in fingerprints text file...</span>
 190   <span class="i">$This</span>-&gt;{<span class="w">ValidFileData</span>} = <span class="n">0</span><span class="sc">;</span>
 191 
 192   <span class="i">$This</span>-&gt;{<span class="w">ValidCompoundIDCol</span>} = <span class="n">0</span><span class="sc">;</span>
 193   <span class="i">$This</span>-&gt;{<span class="w">ValidFingerprintsCol</span>} = <span class="n">0</span><span class="sc">;</span>
 194 
 195   <span class="i">$This</span>-&gt;{<span class="w">ValidFingerprintsStringMode</span>} = <span class="n">0</span><span class="sc">;</span>
 196 
 197   <span class="k">return</span> <span class="i">$This</span><span class="sc">;</span>
 198 <span class="s">}</span>
 199 
 200 <span class="c"># Initialize object data for writing fingerprints text file...</span>
 201 <span class="c">#</span>
<a name="_InitializeFingerprintsTextFileIOWrite-"></a> 202 <span class="k">sub </span><span class="m">_InitializeFingerprintsTextFileIOWrite</span> <span class="s">{</span>
 203   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 204 
 205   <span class="c"># Fingerprints bit vector string format...</span>
 206   <span class="c">#</span>
 207   <span class="c"># Possible values: BinaryString or HexadecimalString [Default]</span>
 208   <span class="c">#</span>
 209   <span class="c"># Default BitStringFormat is set during first write using Fingerprints::FingerprintsStringUtil::GetDefaultBitStringFormat.</span>
 210   <span class="c">#</span>
 211   <span class="i">$This</span>-&gt;{<span class="w">BitStringFormat</span>} = <span class="k">undef</span><span class="sc">;</span>
 212 
 213   <span class="c"># Bits order in fingerprints bit vector string...</span>
 214   <span class="c">#</span>
 215   <span class="c"># Ascending - First bit in each byte as the lowest bit [Default]</span>
 216   <span class="c"># Descending - First bit in each byte as the highest bit</span>
 217   <span class="c">#</span>
 218   <span class="c"># Default BitsOrder is set during first write using Fingerprints::FingerprintsStringUtil::GetDefaultBitsOrder.</span>
 219   <span class="c">#</span>
 220   <span class="i">$This</span>-&gt;{<span class="w">BitsOrder</span>} = <span class="k">undef</span><span class="sc">;</span>
 221 
 222   <span class="c"># Fingerprints vector string format...</span>
 223   <span class="c">#</span>
 224   <span class="c"># Possible values: IDsAndValuesString, IDsAndValuesPairsString, ValuesAndIDsString, ValuesAndIDsPairsString, ValuesString</span>
 225   <span class="c">#</span>
 226   <span class="c"># Default VectorStringFormat is set during first write using Fingerprints::FingerprintsStringUtil::GetDefaultVectorStringFormat.</span>
 227   <span class="c"># For fingerprints vector object containing vector NumericalValues, it corresponds to IDsAndValuesString; othwerwise,</span>
 228   <span class="c"># it&#39;s set to ValuesString.</span>
 229   <span class="c">#</span>
 230   <span class="i">$This</span>-&gt;{<span class="w">VectorStringFormat</span>} = <span class="k">undef</span><span class="sc">;</span>
 231 
 232   <span class="c"># Delimiter for output fingerprints CSV/TSV file. Possible values: comma, tab, semicolon. This</span>
 233   <span class="c"># option is ignored for TSV text file and tab is used as the delimiter.</span>
 234   <span class="c">#</span>
 235   <span class="i">$This</span>-&gt;{<span class="w">OutDelim</span>} = <span class="q">&#39;comma&#39;</span><span class="sc">;</span>
 236 
 237   <span class="c"># Quotes around column values for output fingerprints CSV/TSV text file...</span>
 238   <span class="i">$This</span>-&gt;{<span class="w">OutQuote</span>} = <span class="n">1</span><span class="sc">;</span>
 239 
 240   <span class="c"># Overwriting existing file...</span>
 241   <span class="i">$This</span>-&gt;{<span class="w">Overwrite</span>} = <span class="n">0</span><span class="sc">;</span>
 242 
 243   <span class="k">return</span> <span class="i">$This</span><span class="sc">;</span>
 244 <span class="s">}</span>
 245 
 246 <span class="c"># Initialize object values...</span>
<a name="_InitializeFingerprintsTextFileIOProperties-"></a> 247 <span class="k">sub </span><span class="m">_InitializeFingerprintsTextFileIOProperties</span> <span class="s">{</span>
 248   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">%NamesAndValues</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 249 
 250   <span class="c"># All other property names and values along with all Set/Get&lt;PropertyName&gt; methods</span>
 251   <span class="c"># are implemented on-demand using ObjectProperty class.</span>
 252 
 253   <span class="k">my</span><span class="s">(</span><span class="i">$Name</span><span class="cm">,</span> <span class="i">$Value</span><span class="cm">,</span> <span class="i">$MethodName</span><span class="s">)</span><span class="sc">;</span>
 254   <span class="k">while</span> <span class="s">(</span><span class="s">(</span><span class="i">$Name</span><span class="cm">,</span> <span class="i">$Value</span><span class="s">)</span> = <span class="k">each</span>  <span class="i">%NamesAndValues</span><span class="s">)</span> <span class="s">{</span>
 255     <span class="i">$MethodName</span> = <span class="q">&quot;Set${Name}&quot;</span><span class="sc">;</span>
 256     <span class="i">$This</span><span class="i">-&gt;$MethodName</span><span class="s">(</span><span class="i">$Value</span><span class="s">)</span><span class="sc">;</span>
 257   <span class="s">}</span>
 258 
 259   <span class="k">if</span> <span class="s">(</span>!<span class="k">exists</span> <span class="i">$NamesAndValues</span>{<span class="w">Name</span>}<span class="s">)</span> <span class="s">{</span>
 260     <span class="w">croak</span> <span class="q">&quot;Error: ${ClassName}-&gt;New: Object can&#39;t be instantiated without specifying file name...&quot;</span><span class="sc">;</span>
 261   <span class="s">}</span>
 262 
 263   <span class="c"># Make sure it&#39;s a fingerprints file...</span>
 264   <span class="i">$Name</span> = <span class="i">$NamesAndValues</span>{<span class="w">Name</span>}<span class="sc">;</span>
 265   <span class="k">if</span> <span class="s">(</span>!<span class="i">$This</span><span class="i">-&gt;IsFingerprintsTextFile</span><span class="s">(</span><span class="i">$Name</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
 266     <span class="w">croak</span> <span class="q">&quot;Error: ${ClassName}-&gt;New: Object can&#39;t be instantiated: File, $Name, doesn&#39;t appear to be fingerprints format...&quot;</span><span class="sc">;</span>
 267   <span class="s">}</span>
 268 
 269   <span class="k">if</span> <span class="s">(</span><span class="i">$This</span><span class="i">-&gt;GetMode</span><span class="s">(</span><span class="s">)</span> =~ <span class="q">/^Read$/i</span><span class="s">)</span> <span class="s">{</span>
 270     <span class="i">$This</span><span class="i">-&gt;_InitializeFingerprintsTextFileIOReadProperties</span><span class="s">(</span><span class="i">%NamesAndValues</span><span class="s">)</span><span class="sc">;</span>
 271   <span class="s">}</span>
 272   <span class="k">elsif</span> <span class="s">(</span><span class="i">$This</span><span class="i">-&gt;GetMode</span><span class="s">(</span><span class="s">)</span> =~ <span class="q">/^(Write|Append)$/i</span><span class="s">)</span> <span class="s">{</span>
 273     <span class="i">$This</span><span class="i">-&gt;_InitializeFingerprintsTextFileIOWriteProperties</span><span class="s">(</span><span class="i">%NamesAndValues</span><span class="s">)</span><span class="sc">;</span>
 274   <span class="s">}</span>
 275 
 276   <span class="k">return</span> <span class="i">$This</span><span class="sc">;</span>
 277 <span class="s">}</span>
 278 
 279 <span class="c"># Initialize object properties for reading fingerprints text file...</span>
 280 <span class="c">#</span>
<a name="_InitializeFingerprintsTextFileIOReadProperties-"></a> 281 <span class="k">sub </span><span class="m">_InitializeFingerprintsTextFileIOReadProperties</span> <span class="s">{</span>
 282   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">%NamesAndValues</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 283 
 284   <span class="c"># Set default value for FingerprintsStringMode...</span>
 285   <span class="k">if</span> <span class="s">(</span>!<span class="i">$This</span>-&gt;{<span class="w">FingerprintsStringMode</span>}<span class="s">)</span> <span class="s">{</span>
 286     <span class="i">$This</span>-&gt;{<span class="w">FingerprintsStringMode</span>} = <span class="q">&#39;AutoDetect&#39;</span><span class="sc">;</span>
 287   <span class="s">}</span>
 288 
 289   <span class="i">$This</span><span class="i">-&gt;_PrepareForReadingFingerprintsTextFileData</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 290 
 291   <span class="k">return</span> <span class="i">$This</span><span class="sc">;</span>
 292 <span class="s">}</span>
 293 
 294 <span class="c"># Initialize object properties for writing fingerprints text file...</span>
 295 <span class="c">#</span>
<a name="_InitializeFingerprintsTextFileIOWriteProperties-"></a> 296 <span class="k">sub </span><span class="m">_InitializeFingerprintsTextFileIOWriteProperties</span> <span class="s">{</span>
 297   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">%NamesAndValues</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 298 
 299   <span class="c"># Check FingerprintsStringMode value...</span>
 300   <span class="k">if</span> <span class="s">(</span>!<span class="k">exists</span> <span class="i">$NamesAndValues</span>{<span class="w">FingerprintsStringMode</span>}<span class="s">)</span> <span class="s">{</span>
 301     <span class="w">croak</span> <span class="q">&quot;Error: ${ClassName}-&gt;New: Object can&#39;t be instantiated without specifying FingerprintsStringMode...&quot;</span><span class="sc">;</span>
 302   <span class="s">}</span>
 303 
 304   <span class="k">if</span> <span class="s">(</span><span class="i">$This</span>-&gt;{<span class="w">FingerprintsStringMode</span>} !~ <span class="q">/^(FingerprintsBitVectorString|FingerprintsVectorString)$/i</span><span class="s">)</span> <span class="s">{</span>
 305     <span class="w">croak</span> <span class="q">&quot;Error: ${ClassName}-&gt;: Object can&#39;t be instantiated: FingerprintsStringMode value, $This-&gt;{FingerprintsStringMode}, is not valid; Supported values for write/append: FingerprintsBitVectorString or FingerprintsVectorString...&quot;</span><span class="sc">;</span>
 306   <span class="s">}</span>
 307 
 308   <span class="k">if</span> <span class="s">(</span>!<span class="k">exists</span> <span class="i">$NamesAndValues</span>{<span class="w">DataColLabels</span>}<span class="s">)</span> <span class="s">{</span>
 309     <span class="w">croak</span> <span class="q">&quot;Error: ${ClassName}-&gt;New: Object can&#39;t be instantiated without specifying DataColLabels...&quot;</span><span class="sc">;</span>
 310   <span class="s">}</span>
 311 
 312   <span class="k">if</span> <span class="s">(</span><span class="i">$This</span>-&gt;{<span class="w">OutDelim</span>} =~ <span class="q">/semicolon/i</span> &amp;&amp; !<span class="i">$This</span>-&gt;{<span class="w">OutQuote</span>}<span class="s">)</span> <span class="s">{</span>
 313     <span class="w">croak</span> <span class="q">&quot;Error: ${ClassName}-&gt;: Object can&#39;t be instantiated: The value specified, $This-&gt;{OutQuote}, using \&quot;OutQuote\&quot; is not allowed with semicolon value of \&quot;OutDelim\&quot;: Fingerprints string use semicolon as delimiter for various data fields and must be quoted.\n&quot;</span><span class="sc">;</span>
 314   <span class="s">}</span>
 315 
 316   <span class="i">$This</span><span class="i">-&gt;_PrepareForWritingFingerprintsTextFileData</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 317 
 318   <span class="k">return</span> <span class="i">$This</span><span class="sc">;</span>
 319 <span class="s">}</span>
 320 
 321 <span class="c"># Set FingerprintsStringMode...</span>
 322 <span class="c">#</span>
<a name="SetFingerprintsStringMode-"></a> 323 <span class="k">sub </span><span class="m">SetFingerprintsStringMode</span> <span class="s">{</span>
 324   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$Value</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 325 
 326   <span class="c"># AutoDetect - automatically detect format of fingerprints string</span>
 327   <span class="c"># FingerprintsBitVectorString - Bit vector fingerprints string format</span>
 328   <span class="c"># FingerprintsVectorString - Vector fingerprints string format</span>
 329 
 330   <span class="k">if</span> <span class="s">(</span><span class="i">$Value</span> !~ <span class="q">/^(AutoDetect|FingerprintsBitVectorString|FingerprintsVectorString)$/i</span><span class="s">)</span> <span class="s">{</span>
 331     <span class="w">croak</span> <span class="q">&quot;Error: ${ClassName}-&gt;SetFingerprintsStringMode: FingerprintsStringMode value, $Value, is not valid; Supported values: AutoDetect, FingerprintsBitVectorString or FingerprintsVectorString...&quot;</span><span class="sc">;</span>
 332   <span class="s">}</span>
 333 
 334   <span class="i">$This</span>-&gt;{<span class="w">FingerprintsStringMode</span>} = <span class="i">$Value</span><span class="sc">;</span>
 335 
 336   <span class="k">return</span> <span class="i">$This</span><span class="sc">;</span>
 337 <span class="s">}</span>
 338 
 339 <span class="c"># Set ColMode...</span>
 340 <span class="c">#</span>
<a name="SetColMode-"></a> 341 <span class="k">sub </span><span class="m">SetColMode</span> <span class="s">{</span>
 342   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$Value</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 343 
 344   <span class="k">if</span> <span class="s">(</span><span class="i">$Value</span> !~ <span class="q">/^(ColNum|ColLabel)$/i</span><span class="s">)</span> <span class="s">{</span>
 345     <span class="w">croak</span> <span class="q">&quot;Error: ${ClassName}-&gt;SetColMode: ColMode value, $Value, is not valid; Supported values: ColNum or ColLabel...&quot;</span><span class="sc">;</span>
 346   <span class="s">}</span>
 347 
 348   <span class="i">$This</span>-&gt;{<span class="w">ColMode</span>} = <span class="i">$Value</span><span class="sc">;</span>
 349 
 350   <span class="k">return</span> <span class="i">$This</span><span class="sc">;</span>
 351 <span class="s">}</span>
 352 
 353 <span class="c"># Set InDelim...</span>
 354 <span class="c">#</span>
<a name="SetInDelim-"></a> 355 <span class="k">sub </span><span class="m">SetInDelim</span> <span class="s">{</span>
 356   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$Value</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 357 
 358   <span class="k">if</span> <span class="s">(</span><span class="i">$Value</span> !~ <span class="q">/^(comma|semicolon|tab)$/i</span><span class="s">)</span> <span class="s">{</span>
 359     <span class="w">croak</span> <span class="q">&quot;Error: ${ClassName}-&gt;SetInDelim: InDelim value, $Value, is not valid; Supported values: comma, semicolon, or tab...&quot;</span><span class="sc">;</span>
 360   <span class="s">}</span>
 361 
 362   <span class="i">$This</span>-&gt;{<span class="w">InDelim</span>} = <span class="i">$Value</span><span class="sc">;</span>
 363 
 364   <span class="k">return</span> <span class="i">$This</span><span class="sc">;</span>
 365 <span class="s">}</span>
 366 
 367 <span class="c"># Set DetailLevel...</span>
 368 <span class="c">#</span>
<a name="SetDetailLevel-"></a> 369 <span class="k">sub </span><span class="m">SetDetailLevel</span> <span class="s">{</span>
 370   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$Value</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 371 
 372   <span class="k">if</span> <span class="s">(</span>!<span class="i">TextUtil::IsPositiveInteger</span><span class="s">(</span><span class="i">$Value</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
 373     <span class="w">croak</span> <span class="q">&quot;Error: ${ClassName}-&gt;SetDetailLevel: DetailLevel value, $Value, is not valid; Supported values: &gt; 0...&quot;</span><span class="sc">;</span>
 374   <span class="s">}</span>
 375 
 376   <span class="i">$This</span>-&gt;{<span class="w">DetailLevel</span>} = <span class="i">$Value</span><span class="sc">;</span>
 377 
 378   <span class="k">return</span> <span class="i">$This</span><span class="sc">;</span>
 379 <span class="s">}</span>
 380 
 381 <span class="c"># Set BitStringFormat...</span>
 382 <span class="c">#</span>
<a name="SetBitStringFormat-"></a> 383 <span class="k">sub </span><span class="m">SetBitStringFormat</span> <span class="s">{</span>
 384   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$Value</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 385 
 386   <span class="k">if</span> <span class="s">(</span><span class="i">$Value</span> !~ <span class="q">/^(BinaryString|HexadecimalString)$/i</span><span class="s">)</span> <span class="s">{</span>
 387     <span class="w">croak</span> <span class="q">&quot;Error: ${ClassName}-&gt;SetBitStringFormat: BitStringFormat value, $Value, is not valid; Supported values: BinaryString or HexadecimalString...&quot;</span><span class="sc">;</span>
 388   <span class="s">}</span>
 389 
 390   <span class="i">$This</span>-&gt;{<span class="w">BitStringFormat</span>} = <span class="i">$Value</span><span class="sc">;</span>
 391 
 392   <span class="k">return</span> <span class="i">$This</span><span class="sc">;</span>
 393 <span class="s">}</span>
 394 
 395 <span class="c"># Set BitsOrder...</span>
 396 <span class="c">#</span>
<a name="SetBitsOrder-"></a> 397 <span class="k">sub </span><span class="m">SetBitsOrder</span> <span class="s">{</span>
 398   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$Value</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 399 
 400   <span class="c"># Ascending - First bit in each byte as the lowest bit</span>
 401   <span class="c"># Descending - First bit in each byte as the highest bit</span>
 402   <span class="c">#</span>
 403   <span class="k">if</span> <span class="s">(</span><span class="i">$Value</span> !~ <span class="q">/^(Ascending|Descending)$/i</span><span class="s">)</span> <span class="s">{</span>
 404     <span class="w">croak</span> <span class="q">&quot;Error: ${ClassName}-&gt;SetBitsOrder: FingerprintsStringMode value, $Value, is not valid; Supported values: Ascending or Descending...&quot;</span><span class="sc">;</span>
 405   <span class="s">}</span>
 406 
 407   <span class="i">$This</span>-&gt;{<span class="w">BitsOrder</span>} = <span class="i">$Value</span><span class="sc">;</span>
 408 
 409   <span class="k">return</span> <span class="i">$This</span><span class="sc">;</span>
 410 <span class="s">}</span>
 411 
 412 <span class="c"># Set VectorStringFormat...</span>
 413 <span class="c">#</span>
<a name="SetVectorStringFormat-"></a> 414 <span class="k">sub </span><span class="m">SetVectorStringFormat</span> <span class="s">{</span>
 415   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$Value</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 416 
 417   <span class="c"># Possible values: IDsAndValuesString, IDsAndValuesPairsString, ValuesAndIDsString, ValuesAndIDsPairsString, ValuesString</span>
 418 
 419   <span class="k">if</span> <span class="s">(</span><span class="i">$Value</span> !~ <span class="q">/^(IDsAndValuesString|IDsAndValuesPairsString|ValuesAndIDsString|ValuesAndIDsPairsString|ValuesString)$/i</span><span class="s">)</span> <span class="s">{</span>
 420     <span class="w">croak</span> <span class="q">&quot;Error: ${ClassName}-&gt;SetVectorStringFormat: FingerprintsStringMode value, $Value, is not valid; Supported values: IDsAndValuesString, IDsAndValuesPairsString, ValuesAndIDsString, ValuesAndIDsPairsString, or ValuesString...&quot;</span><span class="sc">;</span>
 421   <span class="s">}</span>
 422 
 423   <span class="i">$This</span>-&gt;{<span class="w">VectorStringFormat</span>} = <span class="i">$Value</span><span class="sc">;</span>
 424 
 425   <span class="k">return</span> <span class="i">$This</span><span class="sc">;</span>
 426 <span class="s">}</span>
 427 
 428 <span class="c"># Set FingerprintsStringMode...</span>
 429 <span class="c">#</span>
<a name="SetOutDelim-"></a> 430 <span class="k">sub </span><span class="m">SetOutDelim</span> <span class="s">{</span>
 431   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$Value</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 432 
 433   <span class="k">if</span> <span class="s">(</span><span class="i">$Value</span> !~ <span class="q">/^(comma|tab|semicolon)$/i</span><span class="s">)</span> <span class="s">{</span>
 434     <span class="w">croak</span> <span class="q">&quot;Error: ${ClassName}-&gt;SetOutDelim: OutDelim value, $Value, is not valid; Supported values: comma, tab or semicolon...&quot;</span><span class="sc">;</span>
 435   <span class="s">}</span>
 436 
 437   <span class="i">$This</span>-&gt;{<span class="w">OutDelim</span>} = <span class="i">$Value</span><span class="sc">;</span>
 438 
 439   <span class="k">return</span> <span class="i">$This</span><span class="sc">;</span>
 440 <span class="s">}</span>
 441 
 442 <span class="c"># Set DataColLabels...</span>
 443 <span class="c">#</span>
 444 <span class="c"># Set output data column labels using:</span>
 445 <span class="c">#    o List of column labels</span>
 446 <span class="c">#    o Reference to an list of column labels</span>
 447 <span class="c">#</span>
<a name="SetDataColLabels-"></a> 448 <span class="k">sub </span><span class="m">SetDataColLabels</span> <span class="s">{</span>
 449   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">@Values</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 450   <span class="k">my</span><span class="s">(</span><span class="i">$FirstValue</span><span class="cm">,</span> <span class="i">$TypeOfFirstValue</span><span class="s">)</span><span class="sc">;</span>
 451 
 452   <span class="k">if</span> <span class="s">(</span>!<span class="i">@Values</span><span class="s">)</span> <span class="s">{</span>
 453     <span class="w">carp</span> <span class="q">&quot;Warning: ${ClassName}-&gt;_SetDataColLabels: No data column labels specified...&quot;</span><span class="sc">;</span>
 454     <span class="k">return</span> <span class="i">$This</span><span class="sc">;</span>
 455   <span class="s">}</span>
 456 
 457   <span class="i">@</span>{<span class="i">$This</span>-&gt;{<span class="w">DataColLabels</span>}} = <span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 458 
 459   <span class="i">$FirstValue</span> = <span class="i">$Values</span>[<span class="n">0</span>]<span class="sc">;</span>
 460   <span class="i">$TypeOfFirstValue</span> = <span class="k">ref</span> <span class="i">$FirstValue</span><span class="sc">;</span>
 461 
 462   <span class="k">if</span> <span class="s">(</span><span class="i">$TypeOfFirstValue</span> =~ <span class="q">/^ARRAY/</span><span class="s">)</span> <span class="s">{</span>
 463     <span class="c"># Initialize using array refernce...</span>
 464     <span class="k">push</span> <span class="i">@</span>{<span class="i">$This</span>-&gt;{<span class="w">DataColLabels</span>}}<span class="cm">,</span> <span class="i">@</span>{<span class="i">$FirstValue</span>}<span class="sc">;</span>
 465   <span class="s">}</span>
 466   <span class="k">else</span> <span class="s">{</span>
 467     <span class="c"># It&#39;s a list of values...</span>
 468     <span class="k">push</span> <span class="i">@</span>{<span class="i">$This</span>-&gt;{<span class="w">DataColLabels</span>}}<span class="cm">,</span> <span class="i">@Values</span><span class="sc">;</span>
 469   <span class="s">}</span>
 470 
 471   <span class="k">return</span> <span class="i">$This</span><span class="sc">;</span>
 472 <span class="s">}</span>
 473 
 474 <span class="c"># Get column labels or number of column labels in first text line...</span>
 475 <span class="c">#</span>
<a name="GetDataColLabels-"></a> 476 <span class="k">sub </span><span class="m">GetDataColLabels</span> <span class="s">{</span>
 477   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 478 
 479   <span class="k">return</span> <span class="k">wantarray</span> ? <span class="i">@</span>{<span class="i">$This</span>-&gt;{<span class="w">DataColLabels</span>}} <span class="co">:</span> <span class="k">scalar</span> <span class="i">@</span>{<span class="i">$This</span>-&gt;{<span class="w">DataColLabels</span>}}<span class="sc">;</span>
 480 <span class="s">}</span>
 481 
 482 <span class="c"># Get words or number of words in current data line...</span>
 483 <span class="c">#</span>
<a name="GetDataLineWords-"></a> 484 <span class="k">sub </span><span class="m">GetDataLineWords</span> <span class="s">{</span>
 485   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 486 
 487   <span class="k">return</span> <span class="k">wantarray</span> ? <span class="i">@</span>{<span class="i">$This</span>-&gt;{<span class="w">DataLineWords</span>}} <span class="co">:</span> <span class="k">scalar</span> <span class="i">@</span>{<span class="i">$This</span>-&gt;{<span class="w">DataLineWords</span>}}<span class="sc">;</span>
 488 <span class="s">}</span>
 489 
 490 <span class="c"># Set DataLineWords...</span>
 491 <span class="c">#</span>
 492 <span class="c"># Set data line words using:</span>
 493 <span class="c">#    o List of line words</span>
 494 <span class="c">#    o Reference to an list of line words</span>
 495 <span class="c">#</span>
<a name="SetDataLineWords-"></a> 496 <span class="k">sub </span><span class="m">SetDataLineWords</span> <span class="s">{</span>
 497   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">@Values</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 498   <span class="k">my</span><span class="s">(</span><span class="i">$FirstValue</span><span class="cm">,</span> <span class="i">$TypeOfFirstValue</span><span class="s">)</span><span class="sc">;</span>
 499 
 500   <span class="k">if</span> <span class="s">(</span>!<span class="i">@Values</span><span class="s">)</span> <span class="s">{</span>
 501     <span class="w">carp</span> <span class="q">&quot;Warning: ${ClassName}-&gt;SetDataLineWords: No line words specified...&quot;</span><span class="sc">;</span>
 502     <span class="k">return</span> <span class="i">$This</span><span class="sc">;</span>
 503   <span class="s">}</span>
 504 
 505   <span class="i">@</span>{<span class="i">$This</span>-&gt;{<span class="w">DataLineWords</span>}} = <span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 506 
 507   <span class="i">$FirstValue</span> = <span class="i">$Values</span>[<span class="n">0</span>]<span class="sc">;</span>
 508   <span class="i">$TypeOfFirstValue</span> = <span class="k">ref</span> <span class="i">$FirstValue</span><span class="sc">;</span>
 509 
 510   <span class="k">if</span> <span class="s">(</span><span class="i">$TypeOfFirstValue</span> =~ <span class="q">/^ARRAY/</span><span class="s">)</span> <span class="s">{</span>
 511     <span class="c"># Initialize using array refernce...</span>
 512     <span class="k">push</span> <span class="i">@</span>{<span class="i">$This</span>-&gt;{<span class="w">DataLineWords</span>}}<span class="cm">,</span> <span class="i">@</span>{<span class="i">$FirstValue</span>}<span class="sc">;</span>
 513   <span class="s">}</span>
 514   <span class="k">else</span> <span class="s">{</span>
 515     <span class="c"># It&#39;s a list of values...</span>
 516     <span class="k">push</span> <span class="i">@</span>{<span class="i">$This</span>-&gt;{<span class="w">DataLineWords</span>}}<span class="cm">,</span> <span class="i">@Values</span><span class="sc">;</span>
 517   <span class="s">}</span>
 518 
 519   <span class="k">return</span> <span class="i">$This</span><span class="sc">;</span>
 520 <span class="s">}</span>
 521 
 522 <span class="c"># Get fingerprints object for current data line using fingerprints, fingerprints bit-vector</span>
 523 <span class="c"># fingerprints vector object. Fingerprints object correspond to any of supported fingerprints</span>
 524 <span class="c"># objects such as PathLengthFingerprints, ExtendedConnectivity, and so on.</span>
 525 <span class="c">#</span>
<a name="GetFingerprints-"></a> 526 <span class="k">sub </span><span class="m">GetFingerprints</span> <span class="s">{</span>
 527   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 528 
 529   <span class="k">return</span> <span class="i">$This</span>-&gt;{<span class="w">FingerprintsObject</span>}<span class="sc">;</span>
 530 <span class="s">}</span>
 531 
 532 <span class="c"># Set fingerprints object for current data line...</span>
 533 <span class="c">#</span>
<a name="SetFingerprints-"></a> 534 <span class="k">sub </span><span class="m">SetFingerprints</span> <span class="s">{</span>
 535   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$FingerprintsObject</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 536 
 537   <span class="i">$This</span>-&gt;{<span class="w">FingerprintsObject</span>} = <span class="i">$FingerprintsObject</span><span class="sc">;</span>
 538 
 539   <span class="k">return</span> <span class="i">$This</span><span class="sc">;</span>
 540 <span class="s">}</span>
 541 
 542 <span class="c"># Get fingerprints string  for current data line...</span>
 543 <span class="c">#</span>
<a name="GetFingerprintsString-"></a> 544 <span class="k">sub </span><span class="m">GetFingerprintsString</span> <span class="s">{</span>
 545   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 546 
 547   <span class="k">return</span> <span class="i">$This</span>-&gt;{<span class="w">FingerprintsString</span>} ? <span class="i">$This</span>-&gt;{<span class="w">FingerprintsString</span>} <span class="co">:</span> <span class="q">&#39;None&#39;</span><span class="sc">;</span>
 548 <span class="s">}</span>
 549 
 550 <span class="c"># Set fingerprints string for current data line...</span>
 551 <span class="c">#</span>
<a name="SetFingerprintsString-"></a> 552 <span class="k">sub </span><span class="m">SetFingerprintsString</span> <span class="s">{</span>
 553   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$FingerprintsString</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 554 
 555   <span class="i">$This</span>-&gt;{<span class="w">FingerprintsString</span>} = <span class="i">$FingerprintsString</span><span class="sc">;</span>
 556 
 557   <span class="k">return</span> <span class="i">$This</span><span class="sc">;</span>
 558 <span class="s">}</span>
 559 
 560 <span class="c"># Does fingerprints text file contain valid data?</span>
 561 <span class="c">#</span>
<a name="IsFingerprintsFileDataValid-"></a> 562 <span class="k">sub </span><span class="m">IsFingerprintsFileDataValid</span> <span class="s">{</span>
 563   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 564 
 565   <span class="k">return</span> <span class="i">$This</span>-&gt;{<span class="w">ValidFileData</span>} ? <span class="n">1</span> <span class="co">:</span> <span class="n">0</span><span class="sc">;</span>
 566 <span class="s">}</span>
 567 
 568 <span class="c"># Does current data line contains valid fingerprints object data?</span>
 569 <span class="c">#</span>
<a name="IsFingerprintsDataValid-"></a> 570 <span class="k">sub </span><span class="m">IsFingerprintsDataValid</span> <span class="s">{</span>
 571   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 572 
 573   <span class="k">return</span> <span class="k">defined</span> <span class="i">$This</span>-&gt;{<span class="w">FingerprintsObject</span>} ? <span class="n">1</span> <span class="co">:</span> <span class="n">0</span><span class="sc">;</span>
 574 <span class="s">}</span>
 575 
 576 <span class="c"># Read next available fingerprints line, process it and generate appropriate fingerprints</span>
 577 <span class="c"># objects...</span>
 578 <span class="c">#</span>
<a name="Read-"></a> 579 <span class="k">sub </span><span class="m">Read</span> <span class="s">{</span>
 580   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 581 
 582   <span class="c"># Read data line...</span>
 583   <span class="k">if</span> <span class="s">(</span>!<span class="i">$This</span><span class="i">-&gt;_ReadDataLine</span><span class="s">(</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
 584     <span class="k">return</span> <span class="k">undef</span><span class="sc">;</span>
 585   <span class="s">}</span>
 586 
 587   <span class="c"># No need to process invalid text file with invalid data...</span>
 588   <span class="k">if</span> <span class="s">(</span>!<span class="i">$This</span>-&gt;{<span class="w">ValidFileData</span>}<span class="s">)</span> <span class="s">{</span>
 589     <span class="k">if</span> <span class="s">(</span><span class="i">$This</span>-&gt;{<span class="w">ValidateData</span>}<span class="s">)</span> <span class="s">{</span>
 590       <span class="i">$This</span>-&gt;{<span class="w">NumOfLinesWithMissingData</span>} += <span class="n">1</span><span class="sc">;</span>
 591     <span class="s">}</span>
 592     <span class="k">return</span> <span class="i">$This</span><span class="sc">;</span>
 593   <span class="s">}</span>
 594 
 595   <span class="c"># Perform data validation...</span>
 596   <span class="k">if</span> <span class="s">(</span><span class="i">$This</span>-&gt;{<span class="w">ValidateData</span>}<span class="s">)</span> <span class="s">{</span>
 597     <span class="k">if</span> <span class="s">(</span>!<span class="i">$This</span><span class="i">-&gt;_ValidateReadDataLine</span><span class="s">(</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
 598       <span class="k">return</span> <span class="i">$This</span><span class="sc">;</span>
 599     <span class="s">}</span>
 600   <span class="s">}</span>
 601 
 602   <span class="c"># Setup fingerprints string after checking again to handle problematic data for</span>
 603   <span class="c"># non-validated data lines...</span>
 604   <span class="c">#</span>
 605   <span class="k">if</span> <span class="s">(</span><span class="i">$This</span>-&gt;{<span class="w">FingerprintsColNum</span>} &lt;= <span class="i">$#</span>{<span class="i">$This</span>-&gt;{<span class="w">DataLineWords</span>}}<span class="s">)</span> <span class="s">{</span>
 606     <span class="i">$This</span>-&gt;{<span class="w">FingerprintsString</span>} = <span class="i">$This</span>-&gt;{<span class="w">DataLineWords</span>}[<span class="i">$This</span>-&gt;{<span class="w">FingerprintsColNum</span>}]<span class="sc">;</span>
 607   <span class="s">}</span>
 608 
 609   <span class="c"># Generate fingeprints object...</span>
 610   <span class="i">$This</span><span class="i">-&gt;_GenerateFingerprintsObject</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 611 
 612   <span class="c"># Setup fingerprints compound ID for fingerprints string...</span>
 613   <span class="i">$This</span><span class="i">-&gt;_GenerateCompoundID</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 614 
 615   <span class="k">return</span> <span class="i">$This</span><span class="sc">;</span>
 616 <span class="s">}</span>
 617 
 618 <span class="c"># Read next available fingerprints line, process it and generate appropriate fingerprints</span>
 619 <span class="c"># objects...</span>
 620 <span class="c">#</span>
<a name="Next-"></a> 621 <span class="k">sub </span><span class="m">Next</span> <span class="s">{</span>
 622   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 623 
 624   <span class="k">return</span> <span class="i">$This</span><span class="i">-&gt;Read</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 625 <span class="s">}</span>
 626 
 627 <span class="c"># Read fingerprints data line line...</span>
 628 <span class="c">#</span>
<a name="_ReadDataLine-"></a> 629 <span class="k">sub </span><span class="m">_ReadDataLine</span> <span class="s">{</span>
 630   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 631 
 632   <span class="k">if</span> <span class="s">(</span><span class="i">$This</span>-&gt;{<span class="w">FirstDataLineIO</span>}<span class="s">)</span> <span class="s">{</span>
 633     <span class="i">$This</span><span class="i">-&gt;_ProcessFirstDataLineRead</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 634   <span class="s">}</span>
 635 
 636   <span class="c"># Initialize data for current line...</span>
 637   <span class="i">$This</span><span class="i">-&gt;_InitializeReadDataLine</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 638 
 639   <span class="c"># Get next data line...</span>
 640   <span class="i">$This</span>-&gt;{<span class="w">DataLine</span>} = <span class="i">TextUtil::GetTextLine</span><span class="s">(</span><span class="i">$This</span>-&gt;{<span class="w">FileHandle</span>}<span class="s">)</span><span class="sc">;</span>
 641   <span class="k">if</span> <span class="s">(</span>!<span class="i">$This</span>-&gt;{<span class="w">DataLine</span>}<span class="s">)</span> <span class="s">{</span>
 642     <span class="k">return</span> <span class="n">0</span><span class="sc">;</span>
 643   <span class="s">}</span>
 644 
 645   <span class="c"># Get line words...</span>
 646   <span class="i">$This</span>-&gt;{<span class="w">LineNum</span>} += <span class="n">1</span><span class="sc">;</span>
 647   <span class="i">@</span>{<span class="i">$This</span>-&gt;{<span class="w">DataLineWords</span>}} = <span class="i">TextUtil::SplitWords</span><span class="s">(</span><span class="i">$This</span>-&gt;{<span class="w">DataLine</span>}<span class="cm">,</span> <span class="i">$This</span>-&gt;{<span class="w">Delim</span>}<span class="s">)</span><span class="sc">;</span>
 648 
 649   <span class="k">return</span> <span class="n">1</span><span class="sc">;</span>
 650 <span class="s">}</span>
 651 
 652 <span class="c"># Initialize data line for reading...</span>
 653 <span class="c">#</span>
<a name="_InitializeReadDataLine-"></a> 654 <span class="k">sub </span><span class="m">_InitializeReadDataLine</span> <span class="s">{</span>
 655   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 656 
 657   <span class="i">$This</span>-&gt;{<span class="w">CompoundID</span>} = <span class="k">undef</span><span class="sc">;</span>
 658 
 659   <span class="i">$This</span>-&gt;{<span class="w">DataLine</span>} = <span class="k">undef</span><span class="sc">;</span>
 660   <span class="i">@</span>{<span class="i">$This</span>-&gt;{<span class="w">DataLineWords</span>}} = <span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 661 
 662   <span class="i">$This</span>-&gt;{<span class="w">FingerprintsObject</span>} = <span class="k">undef</span><span class="sc">;</span>
 663   <span class="i">$This</span>-&gt;{<span class="w">FingerprintsString</span>} = <span class="k">undef</span><span class="sc">;</span>
 664 
 665   <span class="k">return</span> <span class="i">$This</span><span class="sc">;</span>
 666 <span class="s">}</span>
 667 
 668 <span class="c"># Validate fingerprints string data line...</span>
 669 <span class="c">#</span>
<a name="_ValidateReadDataLine-"></a> 670 <span class="k">sub </span><span class="m">_ValidateReadDataLine</span> <span class="s">{</span>
 671   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 672 
 673   <span class="c"># Check for missing data...</span>
 674   <span class="k">if</span> <span class="s">(</span><span class="i">$This</span>-&gt;{<span class="w">FingerprintsColNum</span>} &gt; <span class="i">$#</span>{<span class="i">$This</span>-&gt;{<span class="w">DataLineWords</span>}}<span class="s">)</span> <span class="s">{</span>
 675     <span class="c"># Missing data...</span>
 676     <span class="i">$This</span>-&gt;{<span class="w">NumOfLinesWithMissingData</span>} += <span class="n">1</span><span class="sc">;</span>
 677     <span class="k">if</span> <span class="s">(</span><span class="i">$This</span>-&gt;{<span class="w">DetailLevel</span>} &gt;= <span class="n">3</span><span class="s">)</span> <span class="s">{</span>
 678       <span class="w">carp</span> <span class="q">&quot;Warning: ${ClassName}-&gt;_ValidateReadDataLine: Data line number $This-&gt;{LineNum} contains no fingerprints data: $This-&gt;{DataLine}...&quot;</span><span class="sc">;</span>
 679     <span class="s">}</span>
 680     <span class="k">elsif</span> <span class="s">(</span><span class="i">$This</span>-&gt;{<span class="w">DetailLevel</span>} &gt;= <span class="n">2</span><span class="s">)</span> <span class="s">{</span>
 681       <span class="w">carp</span> <span class="q">&quot;Warning: ${ClassName}-&gt;_ValidateReadDataLine: Data line number $This-&gt;{LineNum} contains no fingerprints data...&quot;</span><span class="sc">;</span>
 682     <span class="s">}</span>
 683     <span class="k">return</span> <span class="n">0</span><span class="sc">;</span>
 684   <span class="s">}</span>
 685 
 686   <span class="c"># Check for invalid data...</span>
 687   <span class="k">my</span><span class="s">(</span><span class="i">$InvalidFingerprintsData</span><span class="cm">,</span> <span class="i">$FingerprintsColNum</span><span class="cm">,</span> <span class="i">$FingerprintsType</span><span class="cm">,</span> <span class="i">$FingerprintsDescription</span><span class="s">)</span><span class="sc">;</span>
 688 
 689   <span class="i">$InvalidFingerprintsData</span> = <span class="n">0</span><span class="sc">;</span>
 690   <span class="i">$FingerprintsColNum</span> = <span class="i">$This</span>-&gt;{<span class="w">FingerprintsColNum</span>}<span class="sc">;</span>
 691 
 692   <span class="k">if</span> <span class="s">(</span><span class="i">Fingerprints::FingerprintsStringUtil::AreFingerprintsStringValuesValid</span><span class="s">(</span><span class="i">$This</span>-&gt;{<span class="w">DataLineWords</span>}[<span class="i">$FingerprintsColNum</span>]<span class="s">)</span><span class="s">)</span> <span class="s">{</span>
 693     <span class="s">(</span><span class="i">$FingerprintsType</span><span class="cm">,</span> <span class="i">$FingerprintsDescription</span><span class="s">)</span> = <span class="i">Fingerprints::FingerprintsStringUtil::GetFingerprintsStringTypeAndDescription</span><span class="s">(</span><span class="i">$This</span>-&gt;{<span class="w">DataLineWords</span>}[<span class="i">$FingerprintsColNum</span>]<span class="s">)</span><span class="sc">;</span>
 694     <span class="k">if</span> <span class="s">(</span><span class="i">$This</span>-&gt;{<span class="w">FirstFingerprintsStringType</span>} !~ <span class="q">/^$FingerprintsType$/i</span> || <span class="i">$This</span>-&gt;{<span class="w">FirstFingerprintsStringDescription</span>} !~ <span class="q">/^$FingerprintsDescription$/i</span><span class="s">)</span> <span class="s">{</span>
 695       <span class="i">$InvalidFingerprintsData</span> = <span class="n">1</span><span class="sc">;</span>
 696     <span class="s">}</span>
 697   <span class="s">}</span>
 698   <span class="k">else</span> <span class="s">{</span>
 699     <span class="i">$InvalidFingerprintsData</span> = <span class="n">1</span><span class="sc">;</span>
 700   <span class="s">}</span>
 701 
 702   <span class="k">if</span> <span class="s">(</span><span class="i">$InvalidFingerprintsData</span><span class="s">)</span> <span class="s">{</span>
 703     <span class="i">$This</span>-&gt;{<span class="w">NumOfLinesWithInvalidData</span>} += <span class="n">1</span><span class="sc">;</span>
 704     <span class="k">if</span> <span class="s">(</span><span class="i">$This</span>-&gt;{<span class="w">DetailLevel</span>} &gt;= <span class="n">3</span><span class="s">)</span> <span class="s">{</span>
 705       <span class="w">carp</span> <span class="q">&quot;Warning: ${ClassName}-&gt;_ValidateReadDataLine: Data line number $This-&gt;{LineNum} contains invalid fingerprints data: $This-&gt;{DataLine}...&quot;</span><span class="sc">;</span>
 706     <span class="s">}</span>
 707     <span class="k">elsif</span> <span class="s">(</span><span class="i">$This</span>-&gt;{<span class="w">DetailLevel</span>} &gt;= <span class="n">2</span><span class="s">)</span> <span class="s">{</span>
 708       <span class="w">carp</span> <span class="q">&quot;Warning: ${ClassName}-&gt;_ValidateReadDataLine: Data line number $This-&gt;{LineNum} contains invalid fingerprints data...&quot;</span><span class="sc">;</span>
 709     <span class="s">}</span>
 710     <span class="k">return</span> <span class="n">0</span><span class="sc">;</span>
 711   <span class="s">}</span>
 712 
 713   <span class="k">return</span> <span class="n">1</span><span class="sc">;</span>
 714 <span class="s">}</span>
 715 
 716 <span class="c"># Setup fingerprints compound ID for fingerprints string...</span>
<a name="_GenerateCompoundID-"></a> 717 <span class="k">sub </span><span class="m">_GenerateCompoundID</span> <span class="s">{</span>
 718   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 719   <span class="k">my</span><span class="s">(</span><span class="i">$CompoundID</span><span class="s">)</span><span class="sc">;</span>
 720 
 721   <span class="i">$CompoundID</span> = <span class="q">&#39;&#39;</span><span class="sc">;</span>
 722 
 723   <span class="k">if</span> <span class="s">(</span><span class="i">$This</span>-&gt;{<span class="w">UseSequentialCompoundIDs</span>} || <span class="s">(</span><span class="i">$This</span>-&gt;{<span class="w">CompoundIDColNum</span>} &gt; <span class="i">$#</span>{<span class="i">$This</span>-&gt;{<span class="w">DataLineWords</span>}}<span class="s">)</span><span class="s">)</span> <span class="s">{</span>
 724     <span class="k">my</span><span class="s">(</span><span class="i">$CompoundNum</span><span class="s">)</span><span class="sc">;</span>
 725 
 726     <span class="i">$CompoundNum</span> = <span class="i">$This</span>-&gt;{<span class="w">LineNum</span>} - <span class="n">1</span><span class="sc">;</span>
 727     <span class="i">$CompoundID</span> = <span class="q">&quot;$This-&gt;{CompoundIDPrefix}${CompoundNum}&quot;</span><span class="sc">;</span>
 728   <span class="s">}</span>
 729   <span class="k">else</span> <span class="s">{</span>
 730     <span class="i">$CompoundID</span> = <span class="i">$This</span>-&gt;{<span class="w">DataLineWords</span>}[<span class="i">$This</span>-&gt;{<span class="w">CompoundIDColNum</span>}]<span class="sc">;</span>
 731   <span class="s">}</span>
 732 
 733   <span class="i">$This</span>-&gt;{<span class="w">CompoundID</span>} = <span class="i">$CompoundID</span><span class="sc">;</span>
 734 
 735   <span class="c"># Set fingerprints ID...</span>
 736   <span class="k">if</span> <span class="s">(</span><span class="i">$This</span>-&gt;{<span class="w">FingerprintsObject</span>}<span class="s">)</span> <span class="s">{</span>
 737     <span class="i">$This</span>-&gt;{<span class="w">FingerprintsObject</span>}<span class="i">-&gt;SetID</span><span class="s">(</span><span class="i">$This</span>-&gt;{<span class="w">CompoundID</span>}<span class="s">)</span><span class="sc">;</span>
 738   <span class="s">}</span>
 739 
 740   <span class="k">return</span> <span class="i">$This</span><span class="sc">;</span>
 741 <span class="s">}</span>
 742 
 743 <span class="c"># Process first read...</span>
 744 <span class="c">#</span>
<a name="_ProcessFirstDataLineRead-"></a> 745 <span class="k">sub </span><span class="m">_ProcessFirstDataLineRead</span> <span class="s">{</span>
 746   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 747 
 748   <span class="c"># Skip column label line...</span>
 749   <span class="i">$This</span>-&gt;{<span class="w">LineNum</span>} += <span class="n">1</span><span class="sc">;</span>
 750   <span class="i">TextUtil::GetTextLine</span><span class="s">(</span><span class="i">$This</span>-&gt;{<span class="w">FileHandle</span>}<span class="s">)</span><span class="sc">;</span>
 751 
 752   <span class="i">$This</span>-&gt;{<span class="w">FirstDataLineIO</span>} = <span class="n">0</span><span class="sc">;</span>
 753 
 754   <span class="k">return</span> <span class="i">$This</span><span class="sc">;</span>
 755 <span class="s">}</span>
 756 
 757 <span class="c"># Get ready for reading fingerprints text file...</span>
 758 <span class="c">#</span>
<a name="_PrepareForReadingFingerprintsTextFileData-"></a> 759 <span class="k">sub </span><span class="m">_PrepareForReadingFingerprintsTextFileData</span> <span class="s">{</span>
 760   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 761 
 762   <span class="c"># Retrieve text file columns information....</span>
 763   <span class="i">$This</span><span class="i">-&gt;_RetrieveTextFileColData</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 764 
 765   <span class="c"># Validate columns information...</span>
 766   <span class="i">$This</span><span class="i">-&gt;_ValidateReadCompoundIDCol</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 767   <span class="i">$This</span><span class="i">-&gt;_ValidateReadFingerprintsCol</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 768 
 769   <span class="c"># Validate fingeprints string mode information...</span>
 770   <span class="k">if</span> <span class="s">(</span><span class="i">$This</span>-&gt;{<span class="w">ValidFingerprintsCol</span>}<span class="s">)</span> <span class="s">{</span>
 771     <span class="i">$This</span><span class="i">-&gt;_ValidateReadFingerprintsStringMode</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 772   <span class="s">}</span>
 773 
 774   <span class="c"># Set status of text file data...</span>
 775   <span class="i">$This</span>-&gt;{<span class="w">ValidFileData</span>} = <span class="s">(</span><span class="i">$This</span>-&gt;{<span class="w">ValidCompoundIDCol</span>} &amp;&amp; <span class="i">$This</span>-&gt;{<span class="w">ValidFingerprintsCol</span>} &amp;&amp; <span class="i">$This</span>-&gt;{<span class="w">ValidFingerprintsStringMode</span>}<span class="s">)</span> ? <span class="n">1</span> <span class="co">:</span> <span class="n">0</span><span class="sc">;</span>
 776 
 777   <span class="k">return</span> <span class="i">$This</span><span class="sc">;</span>
 778 <span class="s">}</span>
 779 
 780 <span class="c"># Retrieve information about columns and fingerprints string...</span>
 781 <span class="c">#</span>
<a name="_RetrieveTextFileColData-"></a> 782 <span class="k">sub </span><span class="m">_RetrieveTextFileColData</span> <span class="s">{</span>
 783   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 784   <span class="k">my</span><span class="s">(</span><span class="i">$TextFile</span><span class="cm">,</span> <span class="i">$FileDir</span><span class="cm">,</span> <span class="i">$FileName</span><span class="cm">,</span> <span class="i">$FileExt</span><span class="cm">,</span> <span class="i">$InDelim</span><span class="cm">,</span> <span class="i">$Line</span><span class="cm">,</span> <span class="i">$ColLabel</span><span class="cm">,</span> <span class="i">$ColNum</span><span class="cm">,</span> <span class="i">@ColLabels</span><span class="s">)</span><span class="sc">;</span>
 785 
 786   <span class="i">@</span>{<span class="i">$This</span>-&gt;{<span class="w">DataColLabels</span>}} = <span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 787   <span class="i">%</span>{<span class="i">$This</span>-&gt;{<span class="w">DataColLabelToNumMap</span>}} = <span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 788 
 789   <span class="i">$TextFile</span> = <span class="i">$This</span>-&gt;{<span class="w">Name</span>}<span class="sc">;</span>
 790 
 791   <span class="k">if</span> <span class="s">(</span>!<span class="s">(</span><span class="k">-e</span> <span class="i">$TextFile</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
 792     <span class="w">croak</span> <span class="q">&quot;Error: ${ClassName}-&gt;New: Object can&#39;t be instantiated: File, $TextFile, doesn&#39;t exist...&quot;</span><span class="sc">;</span>
 793   <span class="s">}</span>
 794 
 795   <span class="i">$FileDir</span> = <span class="q">&quot;&quot;</span><span class="sc">;</span> <span class="i">$FileName</span> = <span class="q">&quot;&quot;</span><span class="sc">;</span> <span class="i">$FileExt</span> = <span class="q">&quot;&quot;</span><span class="sc">;</span>
 796   <span class="s">(</span><span class="i">$FileDir</span><span class="cm">,</span> <span class="i">$FileName</span><span class="cm">,</span> <span class="i">$FileExt</span><span class="s">)</span> = <span class="i">FileUtil::ParseFileName</span><span class="s">(</span><span class="i">$TextFile</span><span class="s">)</span><span class="sc">;</span>
 797 
 798   <span class="i">$InDelim</span> = <span class="s">(</span><span class="i">$FileExt</span> =~ <span class="q">/^tsv$/i</span><span class="s">)</span> ? <span class="q">&quot;\t&quot;</span> <span class="co">:</span> <span class="s">(</span><span class="i">$This</span>-&gt;{<span class="w">InDelim</span>} =~ <span class="q">/semicolon/i</span> ? <span class="q">&quot;\;&quot;</span> <span class="co">:</span> <span class="q">&quot;\,&quot;</span><span class="s">)</span><span class="sc">;</span>
 799   <span class="i">$This</span>-&gt;{<span class="w">Delim</span>} = <span class="i">$InDelim</span><span class="sc">;</span>
 800 
 801   <span class="k">if</span> <span class="s">(</span>!<span class="k">open</span> <span class="w">TEXTFILE</span><span class="cm">,</span> <span class="q">&quot;$TextFile&quot;</span><span class="s">)</span> <span class="s">{</span>
 802     <span class="w">croak</span> <span class="q">&quot;Error: ${ClassName}-&gt;New: Object can&#39;t be instantiated: Couldn&#39;t open input text file $TextFile: $! ...&quot;</span><span class="sc">;</span>
 803   <span class="s">}</span>
 804 
 805   <span class="c"># Get column label line...</span>
 806   <span class="i">$Line</span> = <span class="i">TextUtil::GetTextLine</span><span class="s">(</span>\<span class="i">*TEXTFILE</span><span class="s">)</span><span class="sc">;</span>
 807 
 808   <span class="k">close</span> <span class="w">TEXTFILE</span><span class="sc">;</span>
 809 
 810   <span class="i">@ColLabels</span> = <span class="i">TextUtil::SplitWords</span><span class="s">(</span><span class="i">$Line</span><span class="cm">,</span> <span class="i">$InDelim</span><span class="s">)</span><span class="sc">;</span>
 811 
 812   <span class="c"># Set text file columns info....</span>
 813   <span class="k">push</span> <span class="i">@</span>{<span class="i">$This</span>-&gt;{<span class="w">DataColLabels</span>}}<span class="cm">,</span> <span class="i">@ColLabels</span><span class="sc">;</span>
 814 
 815   <span class="k">for</span> <span class="i">$ColNum</span> <span class="s">(</span><span class="n">0</span> .. <span class="i">$#ColLabels</span><span class="s">)</span> <span class="s">{</span>
 816     <span class="i">$ColLabel</span> = <span class="i">$ColLabels</span>[<span class="i">$ColNum</span>]<span class="sc">;</span>
 817     <span class="i">$This</span>-&gt;{<span class="w">DataColLabelToNumMap</span>}{<span class="i">$ColLabel</span>} = <span class="i">$ColNum</span><span class="sc">;</span>
 818   <span class="s">}</span>
 819 
 820   <span class="k">return</span> <span class="i">$This</span><span class="sc">;</span>
 821 <span class="s">}</span>
 822 
 823 <span class="c"># Validate compound ID column information...</span>
 824 <span class="c">#</span>
<a name="_ValidateReadCompoundIDCol-"></a> 825 <span class="k">sub </span><span class="m">_ValidateReadCompoundIDCol</span> <span class="s">{</span>
 826   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 827   <span class="k">my</span><span class="s">(</span><span class="i">$CompoundIDCol</span><span class="cm">,</span> <span class="i">$CompoundIDColNum</span><span class="cm">,</span> <span class="i">$UseSequentialCompoundIDs</span><span class="cm">,</span> <span class="i">$ColFound</span><span class="cm">,</span> <span class="i">$ColLabel</span><span class="cm">,</span> <span class="i">$ColNum</span><span class="s">)</span><span class="sc">;</span>
 828 
 829   <span class="i">$This</span>-&gt;{<span class="w">ValidCompoundIDCol</span>} = <span class="n">0</span><span class="sc">;</span>
 830   <span class="i">$This</span>-&gt;{<span class="w">CompoundIDColNum</span>} = <span class="k">undef</span><span class="sc">;</span>
 831   <span class="i">$This</span>-&gt;{<span class="w">UseSequentialCompoundIDs</span>} = <span class="n">0</span><span class="sc">;</span>
 832 
 833   <span class="i">$CompoundIDCol</span> = <span class="i">$This</span>-&gt;{<span class="w">CompoundIDCol</span>}<span class="sc">;</span>
 834 
 835   <span class="i">$UseSequentialCompoundIDs</span> = <span class="n">0</span><span class="sc">;</span>
 836   <span class="i">$CompoundIDColNum</span> = <span class="q">&#39;&#39;</span><span class="sc">;</span>
 837 
 838   <span class="k">if</span> <span class="s">(</span><span class="i">$CompoundIDCol</span> =~ <span class="q">/^AutoDetect$/i</span><span class="s">)</span> <span class="s">{</span>
 839     <span class="c"># First column containing the word CompoundID in its label or sequential generation...</span>
 840 
 841     <span class="i">$ColFound</span> = <span class="n">0</span><span class="sc">;</span>
 842     <span class="j">COLLABEL:</span> <span class="k">for</span> <span class="i">$ColLabel</span> <span class="s">(</span><span class="i">@</span>{<span class="i">$This</span>-&gt;{<span class="w">DataColLabels</span>}}<span class="s">)</span> <span class="s">{</span>
 843       <span class="k">if</span> <span class="s">(</span><span class="i">$ColLabel</span> =~ <span class="q">/CompoundID/i</span><span class="s">)</span> <span class="s">{</span>
 844         <span class="i">$ColFound</span> = <span class="n">1</span><span class="sc">;</span>
 845         <span class="i">$ColNum</span> = <span class="i">$This</span>-&gt;{<span class="w">DataColLabelToNumMap</span>}{<span class="i">$ColLabel</span>}<span class="sc">;</span>
 846         <span class="k">last</span> <span class="j">COLLABEL</span><span class="sc">;</span>
 847       <span class="s">}</span>
 848     <span class="s">}</span>
 849     <span class="k">if</span> <span class="s">(</span><span class="i">$ColFound</span><span class="s">)</span> <span class="s">{</span>
 850       <span class="i">$CompoundIDColNum</span> = <span class="i">$ColNum</span><span class="sc">;</span>
 851     <span class="s">}</span>
 852     <span class="k">else</span> <span class="s">{</span>
 853       <span class="i">$UseSequentialCompoundIDs</span> = <span class="n">1</span><span class="sc">;</span>
 854     <span class="s">}</span>
 855   <span class="s">}</span>
 856   <span class="k">else</span> <span class="s">{</span>
 857     <span class="k">if</span> <span class="s">(</span><span class="i">$This</span>-&gt;{<span class="w">ColMode</span>} =~ <span class="q">/^ColNum$/i</span><span class="s">)</span> <span class="s">{</span>
 858       <span class="c"># Is it a valid column number?</span>
 859       <span class="k">if</span> <span class="s">(</span><span class="i">$CompoundIDCol</span> &gt; <span class="k">scalar</span> <span class="i">@</span>{<span class="i">$This</span>-&gt;{<span class="w">DataColLabels</span>}}<span class="s">)</span> <span class="s">{</span>
 860         <span class="w">carp</span> <span class="q">&quot;Warning: ${ClassName}-&gt;_ValidateReadCompoundIDCol: Column number, $CompoundIDCol, specified using CompoundIDCol doesn&#39;t exist...&quot;</span><span class="sc">;</span>
 861         <span class="k">return</span> <span class="n">0</span><span class="sc">;</span>
 862       <span class="s">}</span>
 863       <span class="i">$CompoundIDColNum</span> = <span class="i">$CompoundIDCol</span> - <span class="n">1</span><span class="sc">;</span>
 864     <span class="s">}</span>
 865     <span class="k">elsif</span> <span class="s">(</span><span class="i">$This</span>-&gt;{<span class="w">ColMode</span>} =~ <span class="q">/^ColLabel$/i</span><span class="s">)</span> <span class="s">{</span>
 866       <span class="c"># Does this column exists?</span>
 867       <span class="k">if</span> <span class="s">(</span>!<span class="k">exists</span> <span class="i">$This</span>-&gt;{<span class="w">DataColLabelToNumMap</span>}{<span class="i">$CompoundIDCol</span>}<span class="s">)</span> <span class="s">{</span>
 868         <span class="w">carp</span> <span class="q">&quot;Warning: ${ClassName}-&gt;_ValidateReadCompoundIDCol: Column name, $CompoundIDCol, specified using CompoundIDCol doesn&#39;t exist...&quot;</span><span class="sc">;</span>
 869         <span class="k">return</span> <span class="n">0</span><span class="sc">;</span>
 870       <span class="s">}</span>
 871       <span class="i">$CompoundIDColNum</span> = <span class="i">$This</span>-&gt;{<span class="w">DataColLabelToNumMap</span>}{<span class="i">$CompoundIDCol</span>}<span class="sc">;</span>
 872     <span class="s">}</span>
 873   <span class="s">}</span>
 874 
 875   <span class="i">$This</span>-&gt;{<span class="w">ValidCompoundIDCol</span>} = <span class="n">1</span><span class="sc">;</span>
 876   <span class="i">$This</span>-&gt;{<span class="w">CompoundIDColNum</span>} = <span class="i">$CompoundIDColNum</span><span class="sc">;</span>
 877   <span class="i">$This</span>-&gt;{<span class="w">UseSequentialCompoundIDs</span>} = <span class="i">$UseSequentialCompoundIDs</span><span class="sc">;</span>
 878 
 879   <span class="k">return</span> <span class="n">1</span><span class="sc">;</span>
 880 <span class="s">}</span>
 881 
 882 <span class="c"># Validate fingerprints string column information...</span>
 883 <span class="c">#</span>
<a name="_ValidateReadFingerprintsCol-"></a> 884 <span class="k">sub </span><span class="m">_ValidateReadFingerprintsCol</span> <span class="s">{</span>
 885   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 886   <span class="k">my</span><span class="s">(</span><span class="i">$FingerprintsColNum</span><span class="cm">,</span> <span class="i">$FingerprintsCol</span><span class="cm">,</span> <span class="i">$ColFound</span><span class="cm">,</span> <span class="i">$ColLabel</span><span class="cm">,</span> <span class="i">$ColNum</span><span class="s">)</span><span class="sc">;</span>
 887 
 888   <span class="i">$This</span>-&gt;{<span class="w">ValidFingerprintsCol</span>} = <span class="n">0</span><span class="sc">;</span>
 889   <span class="i">$This</span>-&gt;{<span class="w">FingerprintsColNum</span>} = <span class="k">undef</span><span class="sc">;</span>
 890 
 891   <span class="i">$FingerprintsColNum</span> = <span class="k">undef</span><span class="sc">;</span>
 892   <span class="i">$FingerprintsCol</span> = <span class="i">$This</span>-&gt;{<span class="w">FingerprintsCol</span>}<span class="sc">;</span>
 893 
 894   <span class="k">if</span> <span class="s">(</span><span class="i">$FingerprintsCol</span> =~ <span class="q">/^AutoDetect$/i</span><span class="s">)</span> <span class="s">{</span>
 895     <span class="c"># First column containing the word Fingerprints in its label...</span>
 896 
 897     <span class="i">$ColFound</span> = <span class="n">0</span><span class="sc">;</span>
 898     <span class="j">COLLABEL:</span> <span class="k">for</span> <span class="i">$ColLabel</span> <span class="s">(</span><span class="i">@</span>{<span class="i">$This</span>-&gt;{<span class="w">DataColLabels</span>}}<span class="s">)</span> <span class="s">{</span>
 899       <span class="k">if</span> <span class="s">(</span><span class="i">$ColLabel</span> =~ <span class="q">/Fingerprints/i</span><span class="s">)</span> <span class="s">{</span>
 900         <span class="i">$ColFound</span> = <span class="n">1</span><span class="sc">;</span>
 901         <span class="i">$ColNum</span> = <span class="i">$This</span>-&gt;{<span class="w">DataColLabelToNumMap</span>}{<span class="i">$ColLabel</span>}<span class="sc">;</span>
 902         <span class="k">last</span> <span class="j">COLLABEL</span><span class="sc">;</span>
 903       <span class="s">}</span>
 904     <span class="s">}</span>
 905     <span class="k">if</span> <span class="s">(</span>!<span class="i">$ColFound</span><span class="s">)</span> <span class="s">{</span>
 906       <span class="w">carp</span> <span class="q">&quot;Warning: ${ClassName}-&gt;_ValidateReadFingerprintsCol: Column label containing \&quot;Fingerprints\&quot; string in its name doesn&#39;t exist...&quot;</span><span class="sc">;</span>
 907       <span class="k">return</span> <span class="n">0</span><span class="sc">;</span>
 908     <span class="s">}</span>
 909     <span class="i">$FingerprintsColNum</span> = <span class="i">$ColNum</span><span class="sc">;</span>
 910   <span class="s">}</span>
 911   <span class="k">else</span> <span class="s">{</span>
 912     <span class="k">if</span> <span class="s">(</span><span class="i">$This</span>-&gt;{<span class="w">ColMode</span>} =~ <span class="q">/^ColNum$/i</span><span class="s">)</span> <span class="s">{</span>
 913       <span class="c"># Is it a valid column number?</span>
 914       <span class="k">if</span> <span class="s">(</span><span class="i">$FingerprintsCol</span> &gt; <span class="k">scalar</span> <span class="i">@</span>{<span class="i">$This</span>-&gt;{<span class="w">DataColLabels</span>}}<span class="s">)</span> <span class="s">{</span>
 915         <span class="w">carp</span> <span class="q">&quot;Warning: ${ClassName}-&gt;_ValidateReadFingerprintsCol: Column number, $FingerprintsCol, specified using FingerprintsCol doesn&#39;t exist...&quot;</span><span class="sc">;</span>
 916         <span class="k">return</span> <span class="n">0</span><span class="sc">;</span>
 917       <span class="s">}</span>
 918       <span class="i">$FingerprintsColNum</span> = <span class="i">$FingerprintsCol</span> - <span class="n">1</span><span class="sc">;</span>
 919     <span class="s">}</span>
 920     <span class="k">elsif</span> <span class="s">(</span><span class="i">$This</span>-&gt;{<span class="w">ColMode</span>} =~ <span class="q">/^ColLabel$/i</span><span class="s">)</span> <span class="s">{</span>
 921       <span class="c"># Does this column exists?</span>
 922       <span class="k">if</span> <span class="s">(</span>!<span class="k">exists</span> <span class="i">$This</span>-&gt;{<span class="w">DataColLabelToNumMap</span>}{<span class="i">$FingerprintsCol</span>}<span class="s">)</span> <span class="s">{</span>
 923         <span class="w">carp</span> <span class="q">&quot;Warning: ${ClassName}-&gt;_ValidateReadFingerprintsCol: Column label, $FingerprintsCol, specified using FingerprintsCol doesn&#39;t exist...&quot;</span><span class="sc">;</span>
 924         <span class="k">return</span> <span class="n">0</span><span class="sc">;</span>
 925       <span class="s">}</span>
 926       <span class="i">$FingerprintsColNum</span> = <span class="i">$This</span>-&gt;{<span class="w">DataColLabelToNumMap</span>}{<span class="i">$FingerprintsCol</span>}<span class="sc">;</span>
 927     <span class="s">}</span>
 928   <span class="s">}</span>
 929 
 930   <span class="i">$This</span>-&gt;{<span class="w">ValidFingerprintsCol</span>} = <span class="n">1</span><span class="sc">;</span>
 931   <span class="i">$This</span>-&gt;{<span class="w">FingerprintsColNum</span>} = <span class="i">$FingerprintsColNum</span><span class="sc">;</span>
 932 
 933   <span class="k">return</span> <span class="n">1</span><span class="sc">;</span>
 934 <span class="s">}</span>
 935 
 936 <span class="c"># Validate fingerprints string mode information...</span>
 937 <span class="c">#</span>
<a name="_ValidateReadFingerprintsStringMode-"></a> 938 <span class="k">sub </span><span class="m">_ValidateReadFingerprintsStringMode</span> <span class="s">{</span>
 939   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 940   <span class="k">my</span><span class="s">(</span><span class="i">$FingerprintsBitVectorStringMode</span><span class="cm">,</span> <span class="i">$FingerprintsVectorStringMode</span><span class="cm">,</span> <span class="i">$FirstFingerprintsStringType</span><span class="cm">,</span> <span class="i">$FirstFingerprintsStringDescription</span><span class="cm">,</span> <span class="i">$TextFile</span><span class="cm">,</span> <span class="i">$Line</span><span class="cm">,</span> <span class="i">$FingerprintsColNum</span><span class="cm">,</span> <span class="i">$InDelim</span><span class="cm">,</span> <span class="i">$FingerprintsType</span><span class="cm">,</span> <span class="i">$FingerprintsDescription</span><span class="cm">,</span> <span class="i">@LineWords</span><span class="s">)</span><span class="sc">;</span>
 941 
 942   <span class="i">$This</span>-&gt;{<span class="w">ValidFingerprintsStringMode</span>} = <span class="n">0</span><span class="sc">;</span>
 943 
 944   <span class="i">$This</span>-&gt;{<span class="w">FingerprintsBitVectorStringMode</span>} = <span class="n">0</span><span class="sc">;</span>
 945   <span class="i">$This</span>-&gt;{<span class="w">FingerprintsVectorStringMode</span>} = <span class="n">0</span><span class="sc">;</span>
 946 
 947   <span class="i">$This</span>-&gt;{<span class="w">FirstFingerprintsStringType</span>} = <span class="q">&#39;&#39;</span><span class="sc">;</span>
 948   <span class="i">$This</span>-&gt;{<span class="w">FirstFingerprintsStringDescription</span>} = <span class="q">&#39;&#39;</span><span class="sc">;</span>
 949 
 950   <span class="i">$FingerprintsBitVectorStringMode</span> = <span class="n">0</span><span class="sc">;</span>
 951   <span class="i">$FingerprintsVectorStringMode</span> = <span class="n">0</span><span class="sc">;</span>
 952 
 953   <span class="i">$FirstFingerprintsStringType</span> = <span class="q">&#39;&#39;</span><span class="sc">;</span>
 954   <span class="i">$FirstFingerprintsStringDescription</span> = <span class="q">&#39;&#39;</span><span class="sc">;</span>
 955 
 956   <span class="i">$TextFile</span> = <span class="i">$This</span>-&gt;{<span class="w">Name</span>}<span class="sc">;</span>
 957 
 958   <span class="k">if</span> <span class="s">(</span>!<span class="k">open</span> <span class="w">TEXTFILE</span><span class="cm">,</span> <span class="q">&quot;$TextFile&quot;</span><span class="s">)</span> <span class="s">{</span>
 959     <span class="w">croak</span> <span class="q">&quot;Error: ${ClassName}-&gt;New: Object can&#39;t be instantiated: Couldn&#39;t open input text file $TextFile: $! ...&quot;</span><span class="sc">;</span>
 960   <span class="s">}</span>
 961 
 962   <span class="c"># Skip column label line...</span>
 963   <span class="i">$Line</span> = <span class="i">TextUtil::GetTextLine</span><span class="s">(</span>\<span class="i">*TEXTFILE</span><span class="s">)</span><span class="sc">;</span>
 964 
 965   <span class="c"># First first fingerprints data line...</span>
 966   <span class="i">$Line</span> = <span class="i">TextUtil::GetTextLine</span><span class="s">(</span>\<span class="i">*TEXTFILE</span><span class="s">)</span><span class="sc">;</span>
 967 
 968   <span class="k">close</span> <span class="w">TEXTFILE</span><span class="sc">;</span>
 969 
 970   <span class="c"># Get first fingerprints type and description...</span>
 971   <span class="i">$InDelim</span> = <span class="i">$This</span>-&gt;{<span class="w">Delim</span>}<span class="sc">;</span>
 972   <span class="i">@LineWords</span> = <span class="i">TextUtil::SplitWords</span><span class="s">(</span><span class="i">$Line</span><span class="cm">,</span> <span class="i">$InDelim</span><span class="s">)</span><span class="sc">;</span>
 973 
 974   <span class="i">$FingerprintsColNum</span> = <span class="i">$This</span>-&gt;{<span class="w">FingerprintsColNum</span>}<span class="sc">;</span>
 975 
 976   <span class="s">(</span><span class="i">$FingerprintsType</span><span class="cm">,</span> <span class="i">$FingerprintsDescription</span><span class="s">)</span> = <span class="i">Fingerprints::FingerprintsStringUtil::GetFingerprintsStringTypeAndDescription</span><span class="s">(</span><span class="i">$LineWords</span>[<span class="i">$FingerprintsColNum</span>]<span class="s">)</span><span class="sc">;</span>
 977 
 978   <span class="k">if</span> <span class="s">(</span><span class="i">$This</span>-&gt;{<span class="w">FingerprintsStringMode</span>} =~ <span class="q">/^FingerprintsBitVectorString$/i</span><span class="s">)</span> <span class="s">{</span>
 979     <span class="k">if</span> <span class="s">(</span><span class="i">$FingerprintsType</span> !~ <span class="q">/^FingerprintsBitVector$/i</span><span class="s">)</span> <span class="s">{</span>
 980       <span class="w">carp</span> <span class="q">&quot;Warning: ${ClassName}-&gt;_ValidateReadFingerprintsStringMode: First fingerprint string data type, $FingerprintsType, doesn&#39;t match value, FingerprintsBitVectorString, specified using \&quot;FingerprintsStringMode\&quot;...&quot;</span><span class="sc">;</span>
 981       <span class="k">return</span> <span class="n">0</span><span class="sc">;</span>
 982     <span class="s">}</span>
 983     <span class="i">$FingerprintsBitVectorStringMode</span> = <span class="n">1</span><span class="sc">;</span>
 984     <span class="i">$FirstFingerprintsStringType</span> = <span class="q">&#39;FingerprintsBitVector&#39;</span><span class="sc">;</span>
 985     <span class="i">$FirstFingerprintsStringDescription</span> = <span class="i">$FingerprintsDescription</span><span class="sc">;</span>
 986   <span class="s">}</span>
 987   <span class="k">elsif</span> <span class="s">(</span><span class="i">$This</span>-&gt;{<span class="w">FingerprintsStringMode</span>} =~ <span class="q">/^FingerprintsVectorString$/i</span><span class="s">)</span> <span class="s">{</span>
 988     <span class="k">if</span> <span class="s">(</span><span class="i">$FingerprintsType</span> !~ <span class="q">/^FingerprintsVector$/i</span><span class="s">)</span> <span class="s">{</span>
 989       <span class="w">carp</span> <span class="q">&quot;Warning: ${ClassName}-&gt;_ValidateReadFingerprintsStringMode: First fingerprint string data type, $FingerprintsType, doesn&#39;t match value, FingerprintsVectorString, specified using \&quot;FingerprintsStringMode\&quot;...&quot;</span><span class="sc">;</span>
 990       <span class="k">return</span> <span class="n">0</span><span class="sc">;</span>
 991     <span class="s">}</span>
 992     <span class="i">$FingerprintsVectorStringMode</span> = <span class="n">1</span><span class="sc">;</span>
 993     <span class="i">$FirstFingerprintsStringType</span> = <span class="q">&#39;FingerprintsVector&#39;</span><span class="sc">;</span>
 994     <span class="i">$FirstFingerprintsStringDescription</span> = <span class="i">$FingerprintsDescription</span><span class="sc">;</span>
 995   <span class="s">}</span>
 996   <span class="k">else</span> <span class="s">{</span>
 997     <span class="c"># AutoDetect mode...</span>
 998     <span class="k">if</span> <span class="s">(</span><span class="i">$FingerprintsType</span> =~ <span class="q">/^FingerprintsBitVector$/i</span><span class="s">)</span> <span class="s">{</span>
 999       <span class="i">$FingerprintsBitVectorStringMode</span> = <span class="n">1</span><span class="sc">;</span>
1000     <span class="s">}</span>
1001     <span class="k">elsif</span> <span class="s">(</span><span class="i">$FingerprintsType</span> =~ <span class="q">/^FingerprintsVector$/i</span><span class="s">)</span> <span class="s">{</span>
1002       <span class="i">$FingerprintsVectorStringMode</span> = <span class="n">1</span><span class="sc">;</span>
1003     <span class="s">}</span>
1004     <span class="k">else</span> <span class="s">{</span>
1005       <span class="w">carp</span> <span class="q">&quot;Warning: ${ClassName}-&gt;_ValidateReadFingerprintsStringMode: First fingerprint string data type, $FingerprintsType, identified during, AutoDetect, value of \&quot;FingerprintsStringMode\&quot; is not valid; Supported fingerprints types: FingerprintBitVector or FingerprintsVector...&quot;</span><span class="sc">;</span>
1006       <span class="k">return</span> <span class="n">0</span><span class="sc">;</span>
1007     <span class="s">}</span>
1008     <span class="i">$FirstFingerprintsStringType</span> = <span class="i">$FingerprintsType</span><span class="sc">;</span>
1009     <span class="i">$FirstFingerprintsStringDescription</span> = <span class="i">$FingerprintsDescription</span><span class="sc">;</span>
1010   <span class="s">}</span>
1011 
1012   <span class="i">$This</span>-&gt;{<span class="w">ValidFingerprintsStringMode</span>} = <span class="n">1</span><span class="sc">;</span>
1013 
1014   <span class="i">$This</span>-&gt;{<span class="w">FingerprintsBitVectorStringMode</span>} = <span class="i">$FingerprintsBitVectorStringMode</span><span class="sc">;</span>
1015   <span class="i">$This</span>-&gt;{<span class="w">FingerprintsVectorStringMode</span>} = <span class="i">$FingerprintsVectorStringMode</span><span class="sc">;</span>
1016 
1017   <span class="i">$This</span>-&gt;{<span class="w">FirstFingerprintsStringType</span>} = <span class="i">$FirstFingerprintsStringType</span><span class="sc">;</span>
1018   <span class="i">$This</span>-&gt;{<span class="w">FirstFingerprintsStringDescription</span>} = <span class="i">$FirstFingerprintsStringDescription</span><span class="sc">;</span>
1019 
1020   <span class="k">return</span> <span class="n">1</span><span class="sc">;</span>
1021 <span class="s">}</span>
1022 
1023 <span class="c"># Write fingerprints string generated from specified fingerprints, fingerprints-bit vector, or</span>
1024 <span class="c"># fingerprints vector object and other data to text file...</span>
1025 <span class="c">#</span>
<a name="WriteFingerprints-"></a>1026 <span class="k">sub </span><span class="m">WriteFingerprints</span> <span class="s">{</span>
1027   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$FingerprintsObject</span><span class="cm">,</span> <span class="i">@DataColValues</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
1028 
1029   <span class="c"># Initialize data for current line...</span>
1030   <span class="i">$This</span><span class="i">-&gt;_InitializeWriteDataLine</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
1031 
1032   <span class="c"># Set fingerprints object...</span>
1033   <span class="i">$This</span>-&gt;{<span class="w">FingerprintsObject</span>} = <span class="i">$FingerprintsObject</span><span class="sc">;</span>
1034 
1035   <span class="c"># Generate fingerprints string...</span>
1036   <span class="i">$This</span><span class="i">-&gt;_GenerateFingerprintsString</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
1037 
1038   <span class="c"># Set data line words...</span>
1039   <span class="i">$This</span><span class="i">-&gt;SetDataLineWords</span><span class="s">(</span><span class="i">@DataColValues</span><span class="s">)</span><span class="sc">;</span>
1040   <span class="k">push</span> <span class="i">@</span>{<span class="i">$This</span>-&gt;{<span class="w">DataLineWords</span>}}<span class="cm">,</span> <span class="i">$This</span>-&gt;{<span class="w">FingerprintsString</span>}<span class="sc">;</span>
1041 
1042   <span class="c"># Write data line..</span>
1043   <span class="i">$This</span><span class="i">-&gt;_WriteDataLine</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
1044 
1045   <span class="k">return</span> <span class="i">$This</span><span class="sc">;</span>
1046 <span class="s">}</span>
1047 
1048 <span class="c"># Write fingerprints string and other data to text file...</span>
1049 <span class="c">#</span>
1050 <span class="c"># Note:</span>
1051 <span class="c">#   o FingerprintsStringMode, BitStringFormat, BitsOrder, VectorStringFormat values</span>
1052 <span class="c">#     are ignored during writing of fingerprints and it&#39;s written to the file as it is.</span>
1053 <span class="c">#</span>
1054 <span class="c">#</span>
<a name="WriteFingerprintsString-"></a>1055 <span class="k">sub </span><span class="m">WriteFingerprintsString</span> <span class="s">{</span>
1056   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$FingerprintsString</span><span class="cm">,</span> <span class="i">@DataColValues</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
1057 
1058   <span class="c"># Initialize data for current line...</span>
1059   <span class="i">$This</span><span class="i">-&gt;_InitializeWriteDataLine</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
1060 
1061   <span class="c"># Set fingerprints string...</span>
1062   <span class="i">$This</span>-&gt;{<span class="w">FingerprintsString</span>} = <span class="i">$FingerprintsString</span><span class="sc">;</span>
1063 
1064   <span class="c"># Generate fingerprints object...</span>
1065   <span class="i">$This</span><span class="i">-&gt;_GenerateFingerprintsObject</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
1066 
1067   <span class="c"># Set data line words...</span>
1068   <span class="i">$This</span><span class="i">-&gt;SetDataLineWords</span><span class="s">(</span><span class="i">@DataColValues</span><span class="s">)</span><span class="sc">;</span>
1069   <span class="k">push</span> <span class="i">@</span>{<span class="i">$This</span>-&gt;{<span class="w">DataLineWords</span>}}<span class="cm">,</span> <span class="i">$FingerprintsString</span><span class="sc">;</span>
1070 
1071   <span class="c"># Write data line..</span>
1072   <span class="i">$This</span><span class="i">-&gt;_WriteDataLine</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
1073 
1074   <span class="k">return</span> <span class="i">$This</span><span class="sc">;</span>
1075 <span class="s">}</span>
1076 
1077 <span class="c"># Initialize data line for reading...</span>
1078 <span class="c">#</span>
<a name="_InitializeWriteDataLine-"></a>1079 <span class="k">sub </span><span class="m">_InitializeWriteDataLine</span> <span class="s">{</span>
1080   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
1081 
1082   <span class="i">$This</span>-&gt;{<span class="w">DataLine</span>} = <span class="k">undef</span><span class="sc">;</span>
1083   <span class="i">@</span>{<span class="i">$This</span>-&gt;{<span class="w">DataLineWords</span>}} = <span class="s">(</span><span class="s">)</span><span class="sc">;</span>
1084 
1085   <span class="i">$This</span>-&gt;{<span class="w">FingerprintsObject</span>} = <span class="k">undef</span><span class="sc">;</span>
1086   <span class="i">$This</span>-&gt;{<span class="w">FingerprintsString</span>} = <span class="k">undef</span><span class="sc">;</span>
1087 
1088   <span class="k">return</span> <span class="i">$This</span><span class="sc">;</span>
1089 <span class="s">}</span>
1090 
1091 <span class="c"># Write fingerprints data line line...</span>
1092 <span class="c">#</span>
<a name="_WriteDataLine-"></a>1093 <span class="k">sub </span><span class="m">_WriteDataLine</span> <span class="s">{</span>
1094   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
1095   <span class="k">my</span><span class="s">(</span><span class="i">$FileHandle</span><span class="cm">,</span> <span class="i">$Line</span><span class="s">)</span><span class="sc">;</span>
1096 
1097   <span class="k">if</span> <span class="s">(</span><span class="i">$This</span>-&gt;{<span class="w">FirstDataLineIO</span>}<span class="s">)</span> <span class="s">{</span>
1098     <span class="i">$This</span><span class="i">-&gt;_ProcessFirstDataLineWrite</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
1099   <span class="s">}</span>
1100 
1101   <span class="c"># Write out line words...</span>
1102   <span class="i">$Line</span> = <span class="i">TextUtil::JoinWords</span><span class="s">(</span>\<span class="i">@</span>{<span class="i">$This</span>-&gt;{<span class="w">DataLineWords</span>}}<span class="cm">,</span> <span class="i">$This</span>-&gt;{<span class="w">Delim</span>}<span class="cm">,</span> <span class="i">$This</span>-&gt;{<span class="w">OutQuote</span>}<span class="s">)</span><span class="sc">;</span>
1103 
1104   <span class="i">$This</span>-&gt;{<span class="w">LineNum</span>} += <span class="n">1</span><span class="sc">;</span>
1105   <span class="i">$FileHandle</span> = <span class="i">$This</span>-&gt;{<span class="w">FileHandle</span>}<span class="sc">;</span>
1106   <span class="k">print</span> <span class="i">$FileHandle</span> <span class="q">&quot;$Line\n&quot;</span><span class="sc">;</span>
1107 
1108   <span class="i">$This</span>-&gt;{<span class="w">DataLine</span>} = <span class="i">$Line</span><span class="sc">;</span>
1109 
1110   <span class="k">return</span> <span class="i">$This</span><span class="sc">;</span>
1111 <span class="s">}</span>
1112 
1113 <span class="c"># Process first write...</span>
1114 <span class="c">#</span>
<a name="_ProcessFirstDataLineWrite-"></a>1115 <span class="k">sub </span><span class="m">_ProcessFirstDataLineWrite</span> <span class="s">{</span>
1116   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
1117   <span class="k">my</span><span class="s">(</span><span class="i">$Line</span><span class="cm">,</span> <span class="i">$FileHandle</span><span class="s">)</span><span class="sc">;</span>
1118 
1119   <span class="i">$This</span>-&gt;{<span class="w">FirstDataLineIO</span>} = <span class="n">0</span><span class="sc">;</span>
1120 
1121   <span class="k">if</span> <span class="s">(</span><span class="i">$This</span><span class="i">-&gt;GetMode</span><span class="s">(</span><span class="s">)</span> =~ <span class="q">/^Write$/i</span><span class="s">)</span> <span class="s">{</span>
1122     <span class="c"># Write out column label line...</span>
1123     <span class="i">$Line</span> = <span class="i">TextUtil::JoinWords</span><span class="s">(</span>\<span class="i">@</span>{<span class="i">$This</span>-&gt;{<span class="w">DataColLabels</span>}}<span class="cm">,</span> <span class="i">$This</span>-&gt;{<span class="w">Delim</span>}<span class="cm">,</span> <span class="i">$This</span>-&gt;{<span class="w">OutQuote</span>}<span class="s">)</span><span class="sc">;</span>
1124 
1125     <span class="i">$This</span>-&gt;{<span class="w">LineNum</span>} += <span class="n">1</span><span class="sc">;</span>
1126     <span class="i">$FileHandle</span> = <span class="i">$This</span>-&gt;{<span class="w">FileHandle</span>}<span class="sc">;</span>
1127     <span class="k">print</span> <span class="i">$FileHandle</span> <span class="q">&quot;$Line\n&quot;</span><span class="sc">;</span>
1128   <span class="s">}</span>
1129 
1130   <span class="k">return</span> <span class="i">$This</span><span class="sc">;</span>
1131 <span class="s">}</span>
1132 
1133 <span class="c"># Get ready for writing fingerprints text file...</span>
1134 <span class="c">#</span>
<a name="_PrepareForWritingFingerprintsTextFileData-"></a>1135 <span class="k">sub </span><span class="m">_PrepareForWritingFingerprintsTextFileData</span> <span class="s">{</span>
1136   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
1137   <span class="k">my</span><span class="s">(</span><span class="i">$TextFile</span><span class="cm">,</span> <span class="i">$FileDir</span><span class="cm">,</span> <span class="i">$FileName</span><span class="cm">,</span> <span class="i">$FileExt</span><span class="cm">,</span> <span class="i">$OutDelim</span><span class="s">)</span><span class="sc">;</span>
1138 
1139   <span class="i">$TextFile</span> = <span class="i">$This</span>-&gt;{<span class="w">Name</span>}<span class="sc">;</span>
1140   <span class="k">if</span> <span class="s">(</span>!<span class="i">$This</span>-&gt;{<span class="w">Overwrite</span>}<span class="s">)</span> <span class="s">{</span>
1141     <span class="k">if</span> <span class="s">(</span><span class="k">-e</span> <span class="i">$TextFile</span><span class="s">)</span> <span class="s">{</span>
1142       <span class="w">croak</span> <span class="q">&quot;Error: ${ClassName}-&gt;New: Object can&#39;t be instantiated: File, $TextFile, already exist. Use overwrite option...&quot;</span><span class="sc">;</span>
1143     <span class="s">}</span>
1144   <span class="s">}</span>
1145 
1146   <span class="c"># Set up delimiter for writing file...</span>
1147 
1148   <span class="i">$FileDir</span> = <span class="q">&quot;&quot;</span><span class="sc">;</span> <span class="i">$FileName</span> = <span class="q">&quot;&quot;</span><span class="sc">;</span> <span class="i">$FileExt</span> = <span class="q">&quot;&quot;</span><span class="sc">;</span>
1149   <span class="s">(</span><span class="i">$FileDir</span><span class="cm">,</span> <span class="i">$FileName</span><span class="cm">,</span> <span class="i">$FileExt</span><span class="s">)</span> = <span class="i">FileUtil::ParseFileName</span><span class="s">(</span><span class="i">$TextFile</span><span class="s">)</span><span class="sc">;</span>
1150 
1151   <span class="i">$OutDelim</span> = <span class="s">(</span><span class="i">$FileExt</span> =~ <span class="q">/^tsv$/i</span><span class="s">)</span> ? <span class="q">&quot;\t&quot;</span> <span class="co">:</span> <span class="s">(</span><span class="i">$This</span>-&gt;{<span class="w">OutDelim</span>} =~ <span class="q">/semicolon/i</span> ? <span class="q">&quot;\;&quot;</span> <span class="co">:</span> <span class="q">&quot;\,&quot;</span><span class="s">)</span><span class="sc">;</span>
1152   <span class="i">$This</span>-&gt;{<span class="w">Delim</span>} = <span class="i">$OutDelim</span><span class="sc">;</span>
1153 
1154   <span class="c"># Setup FingerprintsStringMode status...</span>
1155 
1156   <span class="i">$This</span>-&gt;{<span class="w">FingerprintsBitVectorStringMode</span>} = <span class="n">0</span><span class="sc">;</span>
1157   <span class="i">$This</span>-&gt;{<span class="w">FingerprintsVectorStringMode</span>} = <span class="n">0</span><span class="sc">;</span>
1158   <span class="i">$This</span>-&gt;{<span class="w">ValidFingerprintsStringMode</span>} = <span class="n">0</span><span class="sc">;</span>
1159 
1160   <span class="k">if</span> <span class="s">(</span><span class="i">$This</span>-&gt;{<span class="w">FingerprintsStringMode</span>} =~ <span class="q">/^FingerprintsBitVectorString$/i</span><span class="s">)</span> <span class="s">{</span>
1161     <span class="i">$This</span>-&gt;{<span class="w">FingerprintsBitVectorStringMode</span>} = <span class="n">1</span><span class="sc">;</span>
1162   <span class="s">}</span>
1163   <span class="k">elsif</span> <span class="s">(</span><span class="i">$This</span>-&gt;{<span class="w">FingerprintsStringMode</span>} =~ <span class="q">/^FingerprintsVectorString$/i</span><span class="s">)</span> <span class="s">{</span>
1164     <span class="i">$This</span>-&gt;{<span class="w">FingerprintsVectorStringMode</span>} = <span class="n">1</span><span class="sc">;</span>
1165   <span class="s">}</span>
1166 
1167   <span class="i">$This</span>-&gt;{<span class="w">ValidFingerprintsStringMode</span>} = <span class="s">(</span><span class="i">$This</span>-&gt;{<span class="w">FingerprintsBitVectorStringMode</span>} || <span class="i">$This</span>-&gt;{<span class="w">FingerprintsVectorStringMode</span>}<span class="s">)</span> ? <span class="n">1</span> <span class="co">:</span> <span class="n">0</span><span class="sc">;</span>
1168 
1169   <span class="k">if</span> <span class="s">(</span><span class="i">$This</span>-&gt;{<span class="w">FingerprintsBitVectorStringMode</span>}<span class="s">)</span> <span class="s">{</span>
1170     <span class="i">$This</span><span class="i">-&gt;_SetDefaultBitStringFormat</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
1171     <span class="i">$This</span><span class="i">-&gt;_SetDefaultBitsOrder</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
1172   <span class="s">}</span>
1173   <span class="k">elsif</span> <span class="s">(</span><span class="i">$This</span>-&gt;{<span class="w">FingerprintsVectorStringMode</span>}<span class="s">)</span> <span class="s">{</span>
1174     <span class="i">$This</span><span class="i">-&gt;_SetDefaultVectorStringFormat</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
1175   <span class="s">}</span>
1176 
1177   <span class="k">return</span> <span class="i">$This</span><span class="sc">;</span>
1178 <span class="s">}</span>
1179 
1180 <span class="c"># Set default value for bit string format...</span>
1181 <span class="c">#</span>
<a name="_SetDefaultBitStringFormat-"></a>1182 <span class="k">sub </span><span class="m">_SetDefaultBitStringFormat</span> <span class="s">{</span>
1183   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
1184 
1185   <span class="k">if</span> <span class="s">(</span>!<span class="i">$This</span>-&gt;{<span class="w">BitStringFormat</span>}<span class="s">)</span> <span class="s">{</span>
1186     <span class="i">$This</span>-&gt;{<span class="w">BitStringFormat</span>} = <span class="i">Fingerprints::FingerprintsStringUtil::GetDefaultBitStringFormat</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
1187   <span class="s">}</span>
1188 
1189   <span class="k">return</span> <span class="i">$This</span><span class="sc">;</span>
1190 <span class="s">}</span>
1191 
1192 <span class="c"># Set default value for bit string format...</span>
1193 <span class="c">#</span>
<a name="_SetDefaultBitsOrder-"></a>1194 <span class="k">sub </span><span class="m">_SetDefaultBitsOrder</span> <span class="s">{</span>
1195   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
1196 
1197   <span class="k">if</span> <span class="s">(</span>!<span class="i">$This</span>-&gt;{<span class="w">BitsOrder</span>}<span class="s">)</span> <span class="s">{</span>
1198     <span class="i">$This</span>-&gt;{<span class="w">BitsOrder</span>} = <span class="i">Fingerprints::FingerprintsStringUtil::GetDefaultBitsOrder</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
1199   <span class="s">}</span>
1200 
1201   <span class="k">return</span> <span class="i">$This</span><span class="sc">;</span>
1202 <span class="s">}</span>
1203 
1204 <span class="c"># Set default value for vector string format...</span>
1205 <span class="c">#</span>
<a name="_SetDefaultVectorStringFormat-"></a>1206 <span class="k">sub </span><span class="m">_SetDefaultVectorStringFormat</span> <span class="s">{</span>
1207   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
1208 
1209   <span class="k">if</span> <span class="s">(</span>!<span class="i">$This</span>-&gt;{<span class="w">VectorStringFormat</span>} &amp;&amp; <span class="i">$This</span>-&gt;{<span class="w">FingerprintsObject</span>}<span class="s">)</span> <span class="s">{</span>
1210     <span class="i">$This</span>-&gt;{<span class="w">VectorStringFormat</span>} = <span class="i">Fingerprints::FingerprintsStringUtil::GetDefaultVectorStringFormat</span><span class="s">(</span><span class="i">$This</span>-&gt;{<span class="w">FingerprintsObject</span>}<span class="s">)</span><span class="sc">;</span>
1211   <span class="s">}</span>
1212 
1213   <span class="k">return</span> <span class="i">$This</span><span class="sc">;</span>
1214 <span class="s">}</span>
1215 
1216 <span class="c"># Generate fingerprints object using current fingerprints string...</span>
1217 <span class="c">#</span>
<a name="_GenerateFingerprintsObject-"></a>1218 <span class="k">sub </span><span class="m">_GenerateFingerprintsObject</span> <span class="s">{</span>
1219   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
1220 
1221   <span class="i">$This</span>-&gt;{<span class="w">FingerprintsObject</span>} = <span class="k">undef</span><span class="sc">;</span>
1222 
1223   <span class="k">if</span> <span class="s">(</span>!<span class="i">$This</span>-&gt;{<span class="w">FingerprintsString</span>}<span class="s">)</span> <span class="s">{</span>
1224     <span class="k">return</span> <span class="i">$This</span><span class="sc">;</span>
1225   <span class="s">}</span>
1226 
1227   <span class="k">if</span> <span class="s">(</span><span class="i">$This</span>-&gt;{<span class="w">FingerprintsBitVectorStringMode</span>}<span class="s">)</span> <span class="s">{</span>
1228     <span class="i">$This</span>-&gt;{<span class="w">FingerprintsObject</span>} = <span class="i">Fingerprints::FingerprintsStringUtil::ParseFingerprintsBitVectorString</span><span class="s">(</span><span class="i">$This</span>-&gt;{<span class="w">FingerprintsString</span>}<span class="s">)</span><span class="sc">;</span>
1229   <span class="s">}</span>
1230   <span class="k">elsif</span> <span class="s">(</span><span class="i">$This</span>-&gt;{<span class="w">FingerprintsVectorStringMode</span>}<span class="s">)</span> <span class="s">{</span>
1231     <span class="i">$This</span>-&gt;{<span class="w">FingerprintsObject</span>} = <span class="i">Fingerprints::FingerprintsStringUtil::ParseFingerprintsVectorString</span><span class="s">(</span><span class="i">$This</span>-&gt;{<span class="w">FingerprintsString</span>}<span class="s">)</span><span class="sc">;</span>
1232   <span class="s">}</span>
1233   <span class="k">else</span> <span class="s">{</span>
1234     <span class="k">return</span> <span class="k">undef</span><span class="sc">;</span>
1235   <span class="s">}</span>
1236 
1237   <span class="k">return</span> <span class="i">$This</span><span class="sc">;</span>
1238 <span class="s">}</span>
1239 
1240 <span class="c"># Generate fingerprints string using current fingerprints object...</span>
1241 <span class="c">#</span>
<a name="_GenerateFingerprintsString-"></a>1242 <span class="k">sub </span><span class="m">_GenerateFingerprintsString</span> <span class="s">{</span>
1243   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
1244 
1245   <span class="i">$This</span>-&gt;{<span class="w">FingerprintsString</span>} = <span class="q">&#39;&#39;</span><span class="sc">;</span>
1246 
1247   <span class="k">if</span> <span class="s">(</span>!<span class="i">$This</span>-&gt;{<span class="w">FingerprintsObject</span>}<span class="s">)</span> <span class="s">{</span>
1248     <span class="k">return</span> <span class="i">$This</span><span class="sc">;</span>
1249   <span class="s">}</span>
1250 
1251   <span class="k">if</span> <span class="s">(</span><span class="i">$This</span>-&gt;{<span class="w">FingerprintsBitVectorStringMode</span>}<span class="s">)</span> <span class="s">{</span>
1252     <span class="i">$This</span>-&gt;{<span class="w">FingerprintsString</span>} = <span class="i">Fingerprints::FingerprintsStringUtil::GenerateFingerprintsString</span><span class="s">(</span><span class="i">$This</span>-&gt;{<span class="w">FingerprintsObject</span>}<span class="cm">,</span> <span class="i">$This</span>-&gt;{<span class="w">BitStringFormat</span>}<span class="cm">,</span> <span class="i">$This</span>-&gt;{<span class="w">BitsOrder</span>}<span class="s">)</span><span class="sc">;</span>
1253   <span class="s">}</span>
1254   <span class="k">elsif</span> <span class="s">(</span><span class="i">$This</span>-&gt;{<span class="w">FingerprintsVectorStringMode</span>}<span class="s">)</span> <span class="s">{</span>
1255     <span class="i">$This</span>-&gt;{<span class="w">FingerprintsString</span>} = <span class="i">Fingerprints::FingerprintsStringUtil::GenerateFingerprintsString</span><span class="s">(</span><span class="i">$This</span>-&gt;{<span class="w">FingerprintsObject</span>}<span class="cm">,</span> <span class="i">$This</span>-&gt;{<span class="w">VectorStringFormat</span>}<span class="s">)</span><span class="sc">;</span>
1256   <span class="s">}</span>
1257 
1258   <span class="k">return</span> <span class="i">$This</span><span class="sc">;</span>
1259 <span class="s">}</span>
1260 
1261 <span class="c"># Is it a fingerprints file?</span>
<a name="IsFingerprintsTextFile-"></a>1262 <span class="k">sub </span><span class="m">IsFingerprintsTextFile ($;$)</span> <span class="s">{</span>
1263   <span class="k">my</span><span class="s">(</span><span class="i">$FirstParameter</span><span class="cm">,</span> <span class="i">$SecondParameter</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
1264   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$FileName</span><span class="cm">,</span> <span class="i">$Status</span><span class="s">)</span><span class="sc">;</span>
1265 
1266   <span class="k">if</span> <span class="s">(</span><span class="s">(</span><span class="i">@_</span> == <span class="n">2</span><span class="s">)</span> &amp;&amp; <span class="s">(</span><span class="i">_IsFingerprintsTextFileIO</span><span class="s">(</span><span class="i">$FirstParameter</span><span class="s">)</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
1267     <span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$FileName</span><span class="s">)</span> = <span class="s">(</span><span class="i">$FirstParameter</span><span class="cm">,</span> <span class="i">$SecondParameter</span><span class="s">)</span><span class="sc">;</span>
1268   <span class="s">}</span>
1269   <span class="k">else</span> <span class="s">{</span>
1270     <span class="i">$FileName</span> = <span class="i">$FirstParameter</span><span class="sc">;</span>
1271   <span class="s">}</span>
1272 
1273   <span class="c"># Check file extension...</span>
1274   <span class="i">$Status</span> = <span class="i">FileUtil::CheckFileType</span><span class="s">(</span><span class="i">$FileName</span><span class="cm">,</span> <span class="q">&quot;csv tsv&quot;</span><span class="s">)</span><span class="sc">;</span>
1275 
1276   <span class="k">return</span> <span class="i">$Status</span><span class="sc">;</span>
1277 <span class="s">}</span>
1278 
1279 <span class="c"># Is it a FingerprintsTextFileIO object?</span>
<a name="_IsFingerprintsTextFileIO-"></a>1280 <span class="k">sub </span><span class="m">_IsFingerprintsTextFileIO</span> <span class="s">{</span>
1281   <span class="k">my</span><span class="s">(</span><span class="i">$Object</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
1282 
1283   <span class="k">return</span> <span class="s">(</span><span class="i">Scalar::Util::blessed</span><span class="s">(</span><span class="i">$Object</span><span class="s">)</span> &amp;&amp; <span class="i">$Object</span><span class="i">-&gt;isa</span><span class="s">(</span><span class="i">$ClassName</span><span class="s">)</span><span class="s">)</span> ? <span class="n">1</span> <span class="co">:</span> <span class="n">0</span><span class="sc">;</span>
1284 <span class="s">}</span>
1285 
<a name="EOF-"></a></pre>
<p>&nbsp;</p>
<br />
<center>
<img src="../../../images/h2o2.png">
</center>
</body>
</html>
